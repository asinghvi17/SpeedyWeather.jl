<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>LowerTriangularMatrices · SpeedyWeather.jl</title><meta name="title" content="LowerTriangularMatrices · SpeedyWeather.jl"/><meta property="og:title" content="LowerTriangularMatrices · SpeedyWeather.jl"/><meta property="twitter:title" content="LowerTriangularMatrices · SpeedyWeather.jl"/><meta name="description" content="Documentation for SpeedyWeather.jl."/><meta property="og:description" content="Documentation for SpeedyWeather.jl."/><meta property="twitter:description" content="Documentation for SpeedyWeather.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SpeedyWeather.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Dynamics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../barotropic/">Barotropic model</a></li><li><a class="tocitem" href="../shallowwater/">Shallow water model</a></li><li><a class="tocitem" href="../primitiveequation/">Primitive equation model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Physics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../large_scale_condensation/">Large-scale condensation</a></li><li><a class="tocitem" href="../convection/">Convection</a></li><li><a class="tocitem" href="../radiation/">Radiation</a></li><li><a class="tocitem" href="../vertical_diffusion/">Vertical diffusion</a></li><li><a class="tocitem" href="../surface_fluxes/">Surface fluxes</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Discretization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../spectral_transform/">Spherical Harmonic Transform</a></li><li><a class="tocitem" href="../grids/">Grids</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Running SpeedyWeather</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../how_to_run_speedy/">How to run SpeedyWeather</a></li><li><a class="tocitem" href="../examples_2D/">Examples 2D</a></li><li><a class="tocitem" href="../examples_3D/">Examples 3D</a></li><li><a class="tocitem" href="../analysis/">Analysis</a></li><li><a class="tocitem" href="../structure/">Tree structure</a></li><li><a class="tocitem" href="../particles/">Particle advection</a></li><li><a class="tocitem" href="../output/">NetCDF output</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Extending SpeedyWeather</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../forcing_drag/">Forcing and drag</a></li><li><a class="tocitem" href="../parameterizations/">Parameterizations</a></li><li><a class="tocitem" href="../orography/">Orography</a></li><li><a class="tocitem" href="../land_sea_mask/">Land-Sea Mask</a></li><li><a class="tocitem" href="../ocean/">Ocean</a></li><li><a class="tocitem" href="../callbacks/">Callbacks</a></li></ul></li><li><a class="tocitem" href="../ringgrids/">RingGrids</a></li><li class="is-active"><a class="tocitem" href>LowerTriangularMatrices</a><ul class="internal"><li><a class="tocitem" href="#Creation-of-LowerTriangularArray"><span>Creation of <code>LowerTriangularArray</code></span></a></li><li><a class="tocitem" href="#Indexing-LowerTriangularArray"><span>Indexing <code>LowerTriangularArray</code></span></a></li><li><a class="tocitem" href="#Linear-algebra-with-LowerTriangularArray"><span>Linear algebra with <code>LowerTriangularArray</code></span></a></li><li><a class="tocitem" href="#GPU"><span>GPU</span></a></li><li><a class="tocitem" href="#Function-and-type-index"><span>Function and type index</span></a></li></ul></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">SpeedyTransforms</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../speedytransforms/">Spectral transforms</a></li><li><a class="tocitem" href="../gradients/">Gradient operators</a></li></ul></li><li><a class="tocitem" href="../functions/">Function and type index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>LowerTriangularMatrices</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>LowerTriangularMatrices</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SpeedyWeather/SpeedyWeather.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/main/docs/src/lowertriangularmatrices.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="lowertriangularmatrices"><a class="docs-heading-anchor" href="#lowertriangularmatrices">LowerTriangularMatrices</a><a id="lowertriangularmatrices-1"></a><a class="docs-heading-anchor-permalink" href="#lowertriangularmatrices" title="Permalink"></a></h1><p>LowerTriangularMatrices is a submodule that has been developed for SpeedyWeather.jl which is technically independent (SpeedyWeather.jl however imports it and so does SpeedyTransforms) and can also be used without running simulations. It is just not put into its own respective repository.</p><p>This module defines <code>LowerTriangularArray</code>, a lower triangular matrix format, which in contrast to <a href="https://docs.julialang.org/en/v1/stdlib/LinearAlgebra/#LinearAlgebra.LowerTriangular"><code>LinearAlgebra.LowerTriangular</code></a> does not store the entries above the diagonal. SpeedyWeather.jl uses <code>LowerTriangularArray</code> which is defined as a subtype of <code>AbstractArray</code> to store the spherical harmonic coefficients (see <a href="../spectral_transform/#Spectral-packing">Spectral packing</a>). For 2D <code>LowerTriangularArray</code> the alias <code>LowerTriangularMatrix</code> exists. Higher dimensional <code>LowerTriangularArray</code> are &#39;batches&#39; of 2D <code>LowerTriangularMatrix</code>. So, for example a <span>$(10\times 10\times 10)$</span> <code>LowerTriangularArray</code> holds 10 <code>LowerTriangularMatrix</code> of size <span>$(10\times 10)$</span> in one array.  </p><h2 id="Creation-of-LowerTriangularArray"><a class="docs-heading-anchor" href="#Creation-of-LowerTriangularArray">Creation of <code>LowerTriangularArray</code></a><a id="Creation-of-LowerTriangularArray-1"></a><a class="docs-heading-anchor-permalink" href="#Creation-of-LowerTriangularArray" title="Permalink"></a></h2><p>A <code>LowerTriangularMatrix</code> and <code>LowerTriangularArray</code> can be created using <code>zeros</code>, <code>ones</code>, <code>rand</code>, or <code>randn</code></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using SpeedyWeather.LowerTriangularMatrices</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; L = rand(LowerTriangularMatrix{Float32}, 5, 5)</code><code class="nohighlight hljs ansi" style="display:block;">5×5 LowerTriangularMatrix{Float32}:
 0.423142  0.0        0.0       0.0       0.0
 0.389086  0.495327   0.0       0.0       0.0
 0.994392  0.030652   0.245397  0.0       0.0
 0.717197  0.999294   0.504755  0.917796  0.0
 0.365965  0.0937336  0.724677  0.716237  0.663378</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; L2 = rand(LowerTriangularArray{Float32}, 5, 5, 5)</code><code class="nohighlight hljs ansi" style="display:block;">5×5×5 LowerTriangularArray{Float32, 3, Matrix{Float32}}:
[:, :, 1] =
 0.0472335  0.101352   0.309324  0.968899   0.447149
 0.227914   0.0973525  0.903759  0.447149   0.990633
 0.139678   0.860029   0.968899  0.990633   0.245778
 0.905911   0.309324   0.447149  0.245778   0.0589102
 0.101352   0.903759   0.990633  0.0589102  0.831864

[:, :, 2] =
 0.0867074  0.564661   0.0971966  0.756692  0.255779
 0.213472   0.956077   0.646554   0.255779  0.465704
 0.839569   0.962592   0.756692   0.465704  0.328085
 0.628453   0.0971966  0.255779   0.328085  0.103728
 0.564661   0.646554   0.465704   0.103728  0.90788

[:, :, 3] =
 0.221556  0.102533  0.798007   0.295849   0.0103116
 0.519086  0.179649  0.759431   0.0103116  0.429947
 0.724207  0.822632  0.295849   0.429947   0.191275
 0.649333  0.798007  0.0103116  0.191275   0.475723
 0.102533  0.759431  0.429947   0.475723   0.336271

[:, :, 4] =
 0.801088  0.765786  0.830818   0.24636    0.0641584
 0.380556  0.297728  0.594914   0.0641584  0.529437
 0.856998  0.395727  0.24636    0.529437   0.885138
 0.126806  0.830818  0.0641584  0.885138   0.238182
 0.765786  0.594914  0.529437   0.238182   0.824624

[:, :, 5] =
 0.170309   0.858178  0.233712  0.19626   0.827124
 0.153397   0.845821  0.790097  0.827124  0.189601
 0.0657275  0.795717  0.19626   0.189601  0.906911
 0.481056   0.233712  0.827124  0.906911  0.509845
 0.858178   0.790097  0.189601  0.509845  0.281728</code></pre><p>or the <code>undef</code> initializor <code>LowerTriangularMatrix{Float32}(undef, 3, 3)</code>. The element type is arbitrary though, you can use any type <code>T</code> too.</p><p>Alternatively, it can be created through conversion from <code>Array</code>, which drops the upper triangle entries and sets them to zero</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; M = rand(Float16, 3, 3)</code><code class="nohighlight hljs ansi" style="display:block;">3×3 Matrix{Float16}:
 0.7407   0.9727   0.597
 0.848    0.08545  0.9185
 0.06494  0.2041   0.3813</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; L = LowerTriangularMatrix(M)</code><code class="nohighlight hljs ansi" style="display:block;">3×3 LowerTriangularMatrix{Float16}:
 0.7407   0.0      0.0
 0.848    0.08545  0.0
 0.06494  0.2041   0.3813</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; M2 = rand(Float16, 3, 3, 5)</code><code class="nohighlight hljs ansi" style="display:block;">3×3×5 Array{Float16, 3}:
[:, :, 1] =
 0.03174  0.545   0.7783
 0.294    0.3638  0.3242
 0.4019   0.9478  0.0464

[:, :, 2] =
 0.227   0.9717  0.9116
 0.7153  0.5625  0.5176
 0.397   0.7305  0.3555

[:, :, 3] =
 0.2588  0.559   0.571
 0.2412  0.3804  0.957
 0.7837  0.3774  0.251

[:, :, 4] =
 0.484   0.9585  0.4448
 0.2363  0.9717  0.396
 0.6226  0.986   0.2241

[:, :, 5] =
 0.2227  0.2266   0.84
 0.1079  0.04834  0.6494
 0.288   0.5405   0.6904</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; L2 = LowerTriangularArray(M)</code><code class="nohighlight hljs ansi" style="display:block;">3×3 LowerTriangularMatrix{Float16}:
 0.7407   0.0      0.0
 0.848    0.08545  0.0
 0.06494  0.2041   0.3813</code></pre><h2 id="Indexing-LowerTriangularArray"><a class="docs-heading-anchor" href="#Indexing-LowerTriangularArray">Indexing <code>LowerTriangularArray</code></a><a id="Indexing-LowerTriangularArray-1"></a><a class="docs-heading-anchor-permalink" href="#Indexing-LowerTriangularArray" title="Permalink"></a></h2><p><code>LowerTriangularArray</code> supports two types of indexing: 1) by denoting two indices, column and row <code>[l, m, ..]</code> or 2) by denoting a single index <code>[lm, ..]</code>. The double index works as expected</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; L</code><code class="nohighlight hljs ansi" style="display:block;">3×3 LowerTriangularMatrix{Float16}:
 0.7407   0.0      0.0
 0.848    0.08545  0.0
 0.06494  0.2041   0.3813</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; L[2, 2]</code><code class="nohighlight hljs ansi" style="display:block;">Float16(0.08545)</code></pre><p>But the single index skips the zero entries in the upper triangle, i.e.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; L[4]</code><code class="nohighlight hljs ansi" style="display:block;">Float16(0.08545)</code></pre><p>which, important, is different from single indices of an <code>AbstractMatrix</code></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; Matrix(L)[4]</code><code class="nohighlight hljs ansi" style="display:block;">Float16(0.0)</code></pre><p>In performance-critical code a single index should be used, as this directly maps to the index of the underlying data vector. The double index is somewhat slower as it first has to be converted to the corresponding single index.</p><p>Consequently, many loops in SpeedyWeather.jl are build with the following structure</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; n, m = size(L)</code><code class="nohighlight hljs ansi" style="display:block;">(3, 3)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ij = 0</code><code class="nohighlight hljs ansi" style="display:block;">0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; for j in 1:m, i in j:n
           ij += 1
           L[ij] = i+j
       end</code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><p>which loops over all lower triangle entries of <code>L::LowerTriangularArray</code> and the single index <code>ij</code> is simply counted up. However, one could also use <code>[i, j]</code> as indices in the loop body or to perform any calculation (<code>i+j</code> here). An iterator over all entries in the lower triangle can be created by</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; for ij in eachindex(L)
           # do something
       end</code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><p>The <code>setindex!</code> functionality of matrixes will throw a <code>BoundsError</code> when trying to write into the upper triangle of a <code>LowerTriangularArray</code>, for example</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; L[2, 1] = 0    # valid index</code><code class="nohighlight hljs ansi" style="display:block;">0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; L[1, 2] = 0    # invalid index in the upper triangle</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: BoundsError: attempt to access 3×3 LowerTriangularMatrix{Float16} at index [1, 2]</code></pre><p>Higher dimensional <code>LowerTriangularArray</code> can be indexed with multidimensional array indices  like most other arrays types. Both the single index and the double index for the lower  triangle work as shown here</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; L = rand(LowerTriangularMatrix{Float32}, 3, 3, 5)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: MethodError: no method matching Vector{Float32}(::Matrix{Float32})

Closest candidates are:
  Array{T, N}(::AbstractArray{S, N}) where {T, N, S}
<span class="sgr90">   @</span> <span class="sgr90">Base</span> <span class="sgr90"><span class="sgr4">array.jl:673</span></span>
  Vector{T}(<span class="sgr91">::UndefInitializer</span>, <span class="sgr91">::Tuple{Int64}</span>) where T
<span class="sgr90">   @</span> <span class="sgr90">Core</span> <span class="sgr90"><span class="sgr4">boot.jl:486</span></span>
  Vector{T}(<span class="sgr91">::UndefInitializer</span>, <span class="sgr91">::Int64</span>) where T
<span class="sgr90">   @</span> <span class="sgr90">Core</span> <span class="sgr90"><span class="sgr4">boot.jl:477</span></span>
  ...</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; L[2, 1] # second lower triangle element of the first lower triangle matrix</code><code class="nohighlight hljs ansi" style="display:block;">Float16(0.0)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; L[2, 1, 1] # (2,1) element of the first lower triangle matrix</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: BoundsError: attempt to access 3×3 LowerTriangularMatrix{Float16} at index [2, 1, 1]</code></pre><p>The <code>setindex!</code> functionality follows accordingly. </p><h2 id="Linear-algebra-with-LowerTriangularArray"><a class="docs-heading-anchor" href="#Linear-algebra-with-LowerTriangularArray">Linear algebra with <code>LowerTriangularArray</code></a><a id="Linear-algebra-with-LowerTriangularArray-1"></a><a class="docs-heading-anchor-permalink" href="#Linear-algebra-with-LowerTriangularArray" title="Permalink"></a></h2><p>The <a href="#lowertriangularmatrices">LowerTriangularMatrices</a> module&#39;s main purpose is not linear algebra, and it&#39;s implementation may not be efficient, however, many operations work as expected</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; L = rand(LowerTriangularMatrix{Float32}, 3, 3)</code><code class="nohighlight hljs ansi" style="display:block;">3×3 LowerTriangularMatrix{Float32}:
 0.352691  0.0        0.0
 0.223019  0.965815   0.0
 0.528193  0.0519145  0.277405</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; L + L</code><code class="nohighlight hljs ansi" style="display:block;">3×3 LowerTriangularMatrix{Float32}:
 0.705383  0.0       0.0
 0.446038  1.93163   0.0
 1.05639   0.103829  0.554811</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; L * L</code><code class="nohighlight hljs ansi" style="display:block;">3×3 Matrix{Float32}:
 0.752325  0.746566  0.635978
 0.321473  1.05329   0.279936
 0.344391  0.343529  0.589786</code></pre><p>Note, however, that the latter includes a conversion to <code>Matrix</code>, which is true for many operations, including <code>inv</code> or <code>\</code>. Hence when trying to do more sophisticated linear algebra with <code>LowerTriangularMatrix</code> we quickly leave lower triangular-land and go back to normal matrix-land.</p><h2 id="GPU"><a class="docs-heading-anchor" href="#GPU">GPU</a><a id="GPU-1"></a><a class="docs-heading-anchor-permalink" href="#GPU" title="Permalink"></a></h2><p><code>LowerTriangularArray{T,N,ArrayType}</code> wraps around an array of type <code>ArrayType</code>. If this array is a GPU array (e.g. <code>CuArray</code>), all operations are performed on GPU as well. The implementation was written so that scalar indexing is avoided in almost all cases, so that GPU operation should be performant. To use <code>LowerTriangularArray</code> on GPU you can e.g. just <code>adapt</code> an exisiting <code>LowerTriangularArray</code>.</p><pre><code class="language-julia hljs">using Adapt
L = rand(LowerTriangularArray{Float32}, 5, 5, 5)
L_gpu = adapt(CuArray, L)</code></pre><h2 id="Function-and-type-index"><a class="docs-heading-anchor" href="#Function-and-type-index">Function and type index</a><a id="Function-and-type-index-1"></a><a class="docs-heading-anchor-permalink" href="#Function-and-type-index" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LowerTriangularMatrices.LowerTriangularArray" href="#SpeedyWeather.LowerTriangularMatrices.LowerTriangularArray"><code>SpeedyWeather.LowerTriangularMatrices.LowerTriangularArray</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A lower triangular array implementation that only stores the non-zero entries explicitly. <code>L&lt;:AbstractMatrix</code> although in general we have <code>L[i] != Matrix(L)[i]</code>, the former skips zero entries, tha latter includes them.</p><p>Supports n-dimensional lower triangular arrays, so that for all trailing dimensions <code>L[:, :, ..]</code> is a matrix in lower triangular form, e.g. a (5x5x3)-LowerTriangularArray would hold 3 lower triangular matrices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d72040e621a85fb4da6ee062eaf6edef4cd98190/src/LowerTriangularMatrices/lower_triangular_matrix.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LowerTriangularMatrices.LowerTriangularArray-Union{Tuple{ArrayType}, Tuple{N}, Tuple{T}} where {T, N, ArrayType&lt;:AbstractArray{T, N}}" href="#SpeedyWeather.LowerTriangularMatrices.LowerTriangularArray-Union{Tuple{ArrayType}, Tuple{N}, Tuple{T}} where {T, N, ArrayType&lt;:AbstractArray{T, N}}"><code>SpeedyWeather.LowerTriangularMatrices.LowerTriangularArray</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">LowerTriangularArray(
    M::AbstractArray{T, N}
) -&gt; LowerTriangularArray
</code></pre><p>Create a LowerTriangularArray <code>L</code> from Array <code>M</code> by copying over the non-zero elements in <code>M</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d72040e621a85fb4da6ee062eaf6edef4cd98190/src/LowerTriangularMatrices/lower_triangular_matrix.jl#L252">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LowerTriangularMatrices.LowerTriangularMatrix" href="#SpeedyWeather.LowerTriangularMatrices.LowerTriangularMatrix"><code>SpeedyWeather.LowerTriangularMatrices.LowerTriangularMatrix</code></a> — <span class="docstring-category">Type</span></header><section><div><p>2-dimensional <code>LowerTriangularArray</code> of type <code>T</code><code>with its non-zero entries unravelled into a</code>Vector{T}`</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d72040e621a85fb4da6ee062eaf6edef4cd98190/src/LowerTriangularMatrices/lower_triangular_matrix.jl#L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LowerTriangularMatrices.LowerTriangularMatrix-Union{Tuple{Matrix{T}}, Tuple{T}} where T" href="#SpeedyWeather.LowerTriangularMatrices.LowerTriangularMatrix-Union{Tuple{Matrix{T}}, Tuple{T}} where T"><code>SpeedyWeather.LowerTriangularMatrices.LowerTriangularMatrix</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">LowerTriangularMatrix(M::Array{T, 2}) -&gt; Any
</code></pre><p>Create a LowerTriangularArray <code>L</code> from Matrix <code>M</code> by copying over the non-zero elements in <code>M</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d72040e621a85fb4da6ee062eaf6edef4cd98190/src/LowerTriangularMatrices/lower_triangular_matrix.jl#L221-L224">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.fill!-Tuple{LowerTriangularArray, Any}" href="#Base.fill!-Tuple{LowerTriangularArray, Any}"><code>Base.fill!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fill!(L::LowerTriangularArray, x) -&gt; LowerTriangularArray
</code></pre><p>Fills the elements of <code>L</code> with <code>x</code>. Faster than fill!(::AbstractArray, x) as only the non-zero elements in <code>L</code> are assigned with x.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d72040e621a85fb4da6ee062eaf6edef4cd98190/src/LowerTriangularMatrices/lower_triangular_matrix.jl#L465">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.length-Tuple{LowerTriangularArray}" href="#Base.length-Tuple{LowerTriangularArray}"><code>Base.length</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">length(L::LowerTriangularArray) -&gt; Any
</code></pre><p>Length of a <code>LowerTriangularArray</code> defined as number of non-zero elements.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d72040e621a85fb4da6ee062eaf6edef4cd98190/src/LowerTriangularMatrices/lower_triangular_matrix.jl#L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.size-Tuple{LowerTriangularArray}" href="#Base.size-Tuple{LowerTriangularArray}"><code>Base.size</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">size(
    L::LowerTriangularArray
) -&gt; Tuple{Int64, Int64, Vararg{Any}}
</code></pre><p>Size of a <code>LowerTriangularArray</code> defined as matrix size including zero upper triangle.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d72040e621a85fb4da6ee062eaf6edef4cd98190/src/LowerTriangularMatrices/lower_triangular_matrix.jl#L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LowerTriangularMatrices.add!-Tuple{LowerTriangularArray, LowerTriangularArray, LowerTriangularArray}" href="#SpeedyWeather.LowerTriangularMatrices.add!-Tuple{LowerTriangularArray, LowerTriangularArray, LowerTriangularArray}"><code>SpeedyWeather.LowerTriangularMatrices.add!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add!(
    L::LowerTriangularArray,
    L1::LowerTriangularArray,
    L2::LowerTriangularArray
) -&gt; LowerTriangularArray
</code></pre><p>Adds <code>L1</code> and <code>L2</code> to <code>L</code>, so that <code>L .+= L1 .+ L2</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d72040e621a85fb4da6ee062eaf6edef4cd98190/src/LowerTriangularMatrices/lower_triangular_matrix.jl#L450">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LowerTriangularMatrices.add!-Tuple{LowerTriangularArray, LowerTriangularArray}" href="#SpeedyWeather.LowerTriangularMatrices.add!-Tuple{LowerTriangularArray, LowerTriangularArray}"><code>SpeedyWeather.LowerTriangularMatrices.add!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add!(
    L::LowerTriangularArray,
    L1::LowerTriangularArray
) -&gt; LowerTriangularArray
</code></pre><p>Adds <code>L1</code> to <code>L</code>, so that <code>L .+= L1</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d72040e621a85fb4da6ee062eaf6edef4cd98190/src/LowerTriangularMatrices/lower_triangular_matrix.jl#L441">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LowerTriangularMatrices.eachharmonic-Tuple{LowerTriangularArray, Vararg{LowerTriangularArray}}" href="#SpeedyWeather.LowerTriangularMatrices.eachharmonic-Tuple{LowerTriangularArray, Vararg{LowerTriangularArray}}"><code>SpeedyWeather.LowerTriangularMatrices.eachharmonic</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">eachharmonic(
    L1::LowerTriangularArray,
    Ls::LowerTriangularArray...
) -&gt; Any
</code></pre><p>creates <code>unit_range::UnitRange</code> to loop over all non-zeros in the LowerTriangularMatrices provided as arguments. Checks bounds first. All LowerTriangularMatrix&#39;s need to be of the same size. Like <code>eachindex</code> but skips the upper triangle with zeros in <code>L</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d72040e621a85fb4da6ee062eaf6edef4cd98190/src/LowerTriangularMatrices/lower_triangular_matrix.jl#L209">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LowerTriangularMatrices.eachharmonic-Tuple{LowerTriangularArray}" href="#SpeedyWeather.LowerTriangularMatrices.eachharmonic-Tuple{LowerTriangularArray}"><code>SpeedyWeather.LowerTriangularMatrices.eachharmonic</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">eachharmonic(L::LowerTriangularArray) -&gt; Any
</code></pre><p>creates <code>unit_range::UnitRange</code> to loop over all non-zeros/spherical harmonics numbers in a LowerTriangularArray <code>L</code>. Like <code>eachindex</code> but skips the upper triangle with zeros in <code>L</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d72040e621a85fb4da6ee062eaf6edef4cd98190/src/LowerTriangularMatrices/lower_triangular_matrix.jl#L203">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LowerTriangularMatrices.ij2k-Tuple{Integer, Integer, Integer}" href="#SpeedyWeather.LowerTriangularMatrices.ij2k-Tuple{Integer, Integer, Integer}"><code>SpeedyWeather.LowerTriangularMatrices.ij2k</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ij2k(i::Integer, j::Integer, m::Integer) -&gt; Any
</code></pre><p>Converts the index pair <code>i, j</code> of an <code>m</code>x<code>n</code> LowerTriangularMatrix <code>L</code> to a single index <code>k</code> that indexes the same element in the corresponding vector that stores only the lower triangle (the non-zero entries) of <code>L</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d72040e621a85fb4da6ee062eaf6edef4cd98190/src/LowerTriangularMatrices/lower_triangular_matrix.jl#L103">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LowerTriangularMatrices.k2ij-Tuple{Integer, Integer}" href="#SpeedyWeather.LowerTriangularMatrices.k2ij-Tuple{Integer, Integer}"><code>SpeedyWeather.LowerTriangularMatrices.k2ij</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">k2ij(k::Integer, m::Integer) -&gt; Tuple{Any, Any}
</code></pre><p>Converts the linear index <code>k</code> in the lower triangle into a pair <code>(i, j)</code> of indices  of the matrix in column-major form. (Formula taken from  Angeletti et al, 2019, https://hal.science/hal-02047514/document)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d72040e621a85fb4da6ee062eaf6edef4cd98190/src/LowerTriangularMatrices/lower_triangular_matrix.jl#L112">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ringgrids/">« RingGrids</a><a class="docs-footer-nextpage" href="../speedytransforms/">Spectral transforms »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Tuesday 7 May 2024 08:04">Tuesday 7 May 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
