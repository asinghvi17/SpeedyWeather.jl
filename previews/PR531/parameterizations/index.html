<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Parameterizations · SpeedyWeather.jl</title><meta name="title" content="Parameterizations · SpeedyWeather.jl"/><meta property="og:title" content="Parameterizations · SpeedyWeather.jl"/><meta property="twitter:title" content="Parameterizations · SpeedyWeather.jl"/><meta name="description" content="Documentation for SpeedyWeather.jl."/><meta property="og:description" content="Documentation for SpeedyWeather.jl."/><meta property="twitter:description" content="Documentation for SpeedyWeather.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SpeedyWeather.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Dynamics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../barotropic/">Barotropic model</a></li><li><a class="tocitem" href="../shallowwater/">Shallow water model</a></li><li><a class="tocitem" href="../primitiveequation/">Primitive equation model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Physics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../large_scale_condensation/">Large-scale condensation</a></li><li><a class="tocitem" href="../convection/">Convection</a></li><li><a class="tocitem" href="../radiation/">Radiation</a></li><li><a class="tocitem" href="../vertical_diffusion/">Vertical diffusion</a></li><li><a class="tocitem" href="../surface_fluxes/">Surface fluxes</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Discretization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../spectral_transform/">Spherical Harmonic Transform</a></li><li><a class="tocitem" href="../grids/">Grids</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Running SpeedyWeather</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../how_to_run_speedy/">How to run SpeedyWeather</a></li><li><a class="tocitem" href="../examples_2D/">Examples 2D</a></li><li><a class="tocitem" href="../examples_3D/">Examples 3D</a></li><li><a class="tocitem" href="../analysis/">Analysis</a></li><li><a class="tocitem" href="../structure/">Tree structure</a></li><li><a class="tocitem" href="../particles/">Particle advection</a></li><li><a class="tocitem" href="../output/">NetCDF output</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox" checked/><label class="tocitem" for="menuitem-7"><span class="docs-label">Extending SpeedyWeather</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../forcing_drag/">Forcing and drag</a></li><li class="is-active"><a class="tocitem" href>Parameterizations</a><ul class="internal"><li><a class="tocitem" href="#Use-ColumnVariables-work-arrays"><span>Use <code>ColumnVariables</code> work arrays</span></a></li><li><a class="tocitem" href="#Accumulate-do-not-overwrite"><span>Accumulate do not overwrite</span></a></li><li><a class="tocitem" href="#Pass-on-to-model-construction"><span>Pass on to model construction</span></a></li><li><a class="tocitem" href="#Custom-boundary-layer-drag"><span>Custom boundary layer drag</span></a></li><li><a class="tocitem" href="#Custom-temperature-relaxation"><span>Custom temperature relaxation</span></a></li><li><a class="tocitem" href="#Custom-vertical-diffusion"><span>Custom vertical diffusion</span></a></li><li><a class="tocitem" href="#Custom-convection"><span>Custom convection</span></a></li><li><a class="tocitem" href="#Custom-large-scale-condensation"><span>Custom large-scale condensation</span></a></li><li><a class="tocitem" href="#Custom-radiation"><span>Custom radiation</span></a></li><li><a class="tocitem" href="#Custom-surface-fluxes"><span>Custom surface fluxes</span></a></li></ul></li><li><a class="tocitem" href="../orography/">Orography</a></li><li><a class="tocitem" href="../land_sea_mask/">Land-Sea Mask</a></li><li><a class="tocitem" href="../ocean/">Ocean</a></li><li><a class="tocitem" href="../callbacks/">Callbacks</a></li></ul></li><li><a class="tocitem" href="../ringgrids/">RingGrids</a></li><li><a class="tocitem" href="../lowertriangularmatrices/">LowerTriangularMatrices</a></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">SpeedyTransforms</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../speedytransforms/">Spectral transforms</a></li><li><a class="tocitem" href="../gradients/">Gradient operators</a></li></ul></li><li><a class="tocitem" href="../functions/">Function and type index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Extending SpeedyWeather</a></li><li class="is-active"><a href>Parameterizations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Parameterizations</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SpeedyWeather/SpeedyWeather.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/main/docs/src/parameterizations.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Parameterizations"><a class="docs-heading-anchor" href="#Parameterizations">Parameterizations</a><a id="Parameterizations-1"></a><a class="docs-heading-anchor-permalink" href="#Parameterizations" title="Permalink"></a></h1><p>The following is an overview of how our parameterizations from a software engineering perspective are internally defined and how a new parameterization can be accordingly implemented. For the mathematical formulation and the physics they represent see</p><ul><li><a href="../vertical_diffusion/#Vertical-diffusion">Vertical diffusion</a></li><li><a href="../convection/#Convection">Convection</a></li><li><a href="../large_scale_condensation/#Large-scale-condensation">Large-scale condensation</a></li><li><a href="../radiation/#Radiation">Radiation</a></li><li><a href="../surface_fluxes/#Surface-fluxes">Surface fluxes</a> </li></ul><p>We generally recommend reading <a href="../forcing_drag/#Extending-SpeedyWeather">Extending SpeedyWeather</a> first, which explains the logic of how to extend many of the components in SpeedyWeather. The same logic applies here and we will not iterate on many of the details, but want to highlight which abstract supertype new parameterizations have to subtype respectively and which functions and signatures they have to extend.</p><p>In general, every parameterization &quot;class&quot; (e.g. convection) is just a <em>conceptual</em> class for clarity. You can define a custom convection parameterization that acts as a longwave radiation and vice versa. This also means that if you want to implement a parameterization that does not fit into any of the &quot;classes&quot; described here you can still implement it under any name and any class. From a software engineering perspective they are all the same except that they are executed in the order as outlined in <a href="#Pass-on-to-model-construction">Pass on to model construction</a>. That&#39;s also why below we write for every parameterization &quot;expected to write into <code>some.array_name</code>&quot; as this would correspond conceptually to this class, but no hard requirement exists that a parameterization actually does that.</p><p>We start by highlighting some general do&#39;s and don&#39;ts for parameterization before listing specifics for individual parameterizations.</p><h2 id="Use-ColumnVariables-work-arrays"><a class="docs-heading-anchor" href="#Use-ColumnVariables-work-arrays">Use <code>ColumnVariables</code> work arrays</a><a id="Use-ColumnVariables-work-arrays-1"></a><a class="docs-heading-anchor-permalink" href="#Use-ColumnVariables-work-arrays" title="Permalink"></a></h2><p>When defining a new (mutable) parameterization with (mutable) fields do make sure that is constant during the model integration. While you can and are encouraged to use the <code>initialize!</code> function to precompute arrays (e.g. something that depends on latitude using <code>model.geometry.latd</code>) these should not be used as work arrays on every time step of the model integration. The reason is that the parameterization are executed in a parallel loop over all grid points and a mutating parameterization object would create a race condition with undefined behaviour.</p><p>Instead, <code>column::ColumnVariables</code> has several work arrays that you can reuse <code>column.a</code> and <code>.b</code>, <code>.c</code>, <code>.d</code>. Depending on the number of threads there will be several <code>column</code> objects to avoid the race condition if several threads would compute the parameterizations for several columns in parallel. An example is <a href="../convection/#BettsMiller">the Simplified Betts-Miller</a> convection scheme which needs to compute reference profiles which should not live inside the <code>model.convection</code> object (as there&#39;s always only one of those). Instead this parameterization does the following inside <code>convection!(column::ColumnVariables, ...)</code></p><pre><code class="language-julia hljs"># use work arrays for temp_ref_profile, humid_ref_profile
temp_ref_profile = column.a
humid_ref_profile = column.b</code></pre><p>These work arrays have an unknown state so you should overwrite every entry and you also should not use them to retain information after that parameterization has been executed.</p><h2 id="Accumulate-do-not-overwrite"><a class="docs-heading-anchor" href="#Accumulate-do-not-overwrite">Accumulate do not overwrite</a><a id="Accumulate-do-not-overwrite-1"></a><a class="docs-heading-anchor-permalink" href="#Accumulate-do-not-overwrite" title="Permalink"></a></h2><p>Every parameterization either computes tendencies directly or indirectly via fluxes (upward or downward, see <a href="../surface_fluxes/#Fluxes-to-tendencies">Fluxes to tendencies</a>). Both of these are arrays in which <em>every</em> parameterization writes into, meaning they should be <em>accumulated not overwritten</em>. Otherwise any parameterization that executed beforehand is effectively disabled. Hence, do</p><pre><code class="language-julia hljs">column.temp_tend[k] += something_you_calculated</code></pre><p>not <code>column.temp_tend[k] = something_you_calculated</code> which would overwrite any previous tendency. The tendencies are reset to zero for every grid point at the beginning of the evaluation of the parameterization for that grid point, meaning you can do <code>tend += a</code> even for the first parameterization that writes into a given tendency as this translates to <code>tend = 0 + a</code>.</p><h2 id="Pass-on-to-model-construction"><a class="docs-heading-anchor" href="#Pass-on-to-model-construction">Pass on to model construction</a><a id="Pass-on-to-model-construction-1"></a><a class="docs-heading-anchor-permalink" href="#Pass-on-to-model-construction" title="Permalink"></a></h2><p>After defining a (custom) parameterization it is recommended to also define a generator function that takes in the <code>SpectralGrid</code> object (see <a href="../how_to_run_speedy/#How-to-run-SpeedyWeather.jl">How to run SpeedyWeather.jl</a>) as first (positional) argument, all other arguments can then be passed on as keyword arguments with defaults defined. Creating the default convection parameterization for example would be</p><pre><code class="language-julia hljs">using SpeedyWeather
spectral_grid = SpectralGrid(trunc=31, nlev=8)
convection = SimplifiedBettsMiller(spectral_grid, time_scale=Hour(4))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SimplifiedBettsMiller{Float32} &lt;: SpeedyWeather.AbstractConvection
├ nlev::Int64 = 8
├ time_scale::Second = 14400 seconds
└ relative_humidity::Float32 = 0.7</code></pre><p>Further keyword arguments can be added or omitted all together (using the default setup), only the <code>spectral_grid</code> is required. We have chosen here the name of that parameterization to be <code>convection</code> but you could choose any other name too. However, with this choice one can conveniently pass on via matching the <code>convection</code> field inside <code>PrimitiveWetModel</code>, see <a href="https://docs.julialang.org/en/v1/manual/functions/#Keyword-Arguments">Keyword Arguments</a>.</p><pre><code class="language-julia hljs">model = PrimitiveWetModel(;spectral_grid, convection)</code></pre><p>otherwise we would need to write</p><pre><code class="language-julia hljs">my_convection = SimplifiedBettsMiller(spectral_grid)
model = PrimitiveWetModel(;spectral_grid, convection=my_convection)</code></pre><p>The following is an overview of what the parameterization fields inside the model are called. See also <a href="../structure/#Tree-structure">Tree structure</a>, and therein <a href="../structure/#PrimitiveDryModel">PrimitiveDryModel</a> and <a href="../structure/#PrimitiveWetModel">PrimitiveWetModel</a></p><ul><li><code>model.boundary_layer_drag</code></li><li><code>model.temperature_relaxation</code></li><li><code>model.vertical_diffusion</code></li><li><code>model.convection</code></li><li><code>model.large_scale_condensation</code> (<code>PrimitiveWetModel</code> only)</li><li><code>model.shortwave_radiation</code></li><li><code>model.longwave_radiation</code></li><li><code>model.surface_thermodynamics</code></li><li><code>model.surface_wind</code></li><li><code>model.surface_heat_flux</code></li><li><code>model.surface_evaporation</code> (<code>PrimitiveWetModel</code> only)</li></ul><p>Note that the parameterizations are executed in the order of the list above. That way, for example, radiation can depend on calculations in large-scale condensation but not vice versa (only at the next time step).</p><h2 id="Custom-boundary-layer-drag"><a class="docs-heading-anchor" href="#Custom-boundary-layer-drag">Custom boundary layer drag</a><a id="Custom-boundary-layer-drag-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-boundary-layer-drag" title="Permalink"></a></h2><p>A boundary layer drag can serve two purposes: (1) Actually define a tendency to the momentum equations that acts as a drag term, or (2) calculate the drag coefficient <span>$C$</span> in <code>column.boundary_layer_drag</code> that is used in the <a href="../surface_fluxes/#Surface-fluxes">Surface fluxes</a>.</p><ul><li>subtype <code>CustomDrag &lt;: AbstractBoundaryLayer</code></li><li>define <code>initialize!(::CustomDrag, ::PrimitiveEquation)</code></li><li>define <code>boundary_layer_drag!(::ColumnVariables, ::CustomDrag, ::PrimitiveEquation)</code></li><li>expected to accumulate (<code>+=</code>) into <code>column.u_tend</code> and <code>column.v_tend</code></li><li>or calculate <code>column.boundary_layer_drag</code> to be used in surface fluxes</li></ul><h2 id="Custom-temperature-relaxation"><a class="docs-heading-anchor" href="#Custom-temperature-relaxation">Custom temperature relaxation</a><a id="Custom-temperature-relaxation-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-temperature-relaxation" title="Permalink"></a></h2><p>By default, there is no temperature relaxation in the primitive equation models (i.e. <code>temperature_relaxation = NoTemperatureRelaxation()</code>). This parameterization exists for the <a href="../examples_3D/#Held-Suarez-forcing">Held-Suarez forcing</a>.</p><ul><li>subtype <code>CustomTemperatureRelaxation &lt;: AbstractTemperatureRelaxation</code></li><li>define <code>initialize!(::CustomTemperatureRelaxation, ::PrimitiveEquation)</code></li><li>define <code>temperature_relaxation!(::ColumnVariables, ::CustomTemperatureRelaxation, ::PrimitiveEquation)</code></li><li>expected to accumulate (<code>+=</code>) into <code>column.temp_tend</code></li></ul><h2 id="Custom-vertical-diffusion"><a class="docs-heading-anchor" href="#Custom-vertical-diffusion">Custom vertical diffusion</a><a id="Custom-vertical-diffusion-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-vertical-diffusion" title="Permalink"></a></h2><p>While vertical diffusion may be applied to temperature (usually via some form of static energy to account for adiabatic diffusion), humidity and/or momentum, they are grouped together. You can define a vertical diffusion for only one or several of these variables where you then can internally call functions like <code>diffuse_temperature!(...)</code> for each variable. For vertical diffusion</p><ul><li>subtype <code>CustomVerticalDiffusion &lt;: AbstractVerticalDiffusion</code></li><li>define <code>initialize!(::CustomVerticalDiffusion, ::PrimitiveEquation)</code></li><li>define <code>vertical_diffusion!(::ColumnVariables, ::CustomVerticalDiffusion, ::PrimitiveEquation)</code></li><li>expected to accumulate (<code>+=</code>) into <code>column.temp_tend</code>, and similarly for <code>humid</code>, <code>u</code>, and/or <code>v</code></li><li>or using fluxes like <code>column.flux_temp_upward</code></li></ul><h2 id="Custom-convection"><a class="docs-heading-anchor" href="#Custom-convection">Custom convection</a><a id="Custom-convection-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-convection" title="Permalink"></a></h2><ul><li>subtype <code>CustomConvection &lt;: AbstractConvection</code></li><li>define <code>initialize!(::CustomConvection, ::PrimitiveEquation)</code></li><li>define <code>convection!(::ColumnVariables, ::CustomConvection, ::PrimitiveEquation)</code></li><li>expected to accumulate (<code>+=</code>) into <code>column.temp_tend</code> and <code>column.humid_tend</code></li><li>or using fluxes, <code>.flux_temp_upward</code> or similarly for <code>humid</code> or <code>downward</code></li></ul><p>Note that we define convection here for a model of type <code>PrimitiveEquation</code>, i.e. both dry and moist convection. If your <code>CustomConvection</code> only makes sense for one of them use <code>::PrimitiveDry</code> or <code>::PrimitiveWet</code> instead.</p><h2 id="Custom-large-scale-condensation"><a class="docs-heading-anchor" href="#Custom-large-scale-condensation">Custom large-scale condensation</a><a id="Custom-large-scale-condensation-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-large-scale-condensation" title="Permalink"></a></h2><ul><li>subtype <code>CustomCondensation &lt;: AbstractCondensation</code></li><li>define <code>initialize!(::CustomCondensation, ::PrimitiveWet)</code></li><li>define <code>condensation!(::ColumnVariables, ::CustomCondensation, ::PrimitiveWet)</code></li><li>expected to accumulate (<code>+=</code>) into <code>column.humid_tend</code> and <code>column.temp_tend</code></li><li>or using fluxes, <code>.flux_humid_downward</code> or similarly for <code>temp</code> or <code>upward</code></li></ul><h2 id="Custom-radiation"><a class="docs-heading-anchor" href="#Custom-radiation">Custom radiation</a><a id="Custom-radiation-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-radiation" title="Permalink"></a></h2><p><code>AbstractRadiation</code> has two subtypes, <code>AbstractShortwave</code> and <code>AbstractLongwave</code> representing two (from a software engineering perspective) independent parameterizations that are called one after another (short then long). For shortwave</p><ul><li>subtype <code>CustomShortwave &lt;: AbstractShortwave</code></li><li>define <code>initialize!(::CustomShortwave, ::PrimitiveEquation)</code></li><li>define <code>shortwave_radiation!(::ColumnVariables, ::CustomShortwave, ::PrimitiveEquation)</code></li><li>expected to accumulate (<code>+=</code>) into <code>column.flux_temp_upward</code>, <code>.flux_temp_downward</code></li><li>or directly into the tendency <code>.temp_tend</code></li></ul><p>For longwave this is similar but using <code>&lt;: AbstractLongwave</code> and <code>longwave_radiation!</code>.</p><h2 id="Custom-surface-fluxes"><a class="docs-heading-anchor" href="#Custom-surface-fluxes">Custom surface fluxes</a><a id="Custom-surface-fluxes-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-surface-fluxes" title="Permalink"></a></h2><p><a href="../surface_fluxes/#Surface-fluxes">Surface fluxes</a> are the most complicated to customize as they depend on the <a href="../ocean/#Ocean">Ocean</a> and Land model, <a href="../land_sea_mask/#The-land-sea-mask">The land-sea mask</a>, and by default the <a href="../surface_fluxes/#Bulk-Richardson-based-drag-coefficient">Bulk Richardson-based drag coefficient</a>, see <a href="#Custom-boundary-layer-drag">Custom boundary layer drag</a>. The computation of the surface fluxes is split into four (five if you include the boundary layer drag coefficient in <a href="#Custom-boundary-layer-drag">Custom boundary layer drag</a>) components that are called one after another</p><ol><li>Surface thermodynamics to calculate the surface values of lowermost layer variables</li></ol><ul><li>subtype <code>CustomSurfaceThermodynamics &lt;: AbstractSurfaceThermodynamics</code></li><li>define <code>initialize!(::CustomSurfaceThermodynamics, ::PrimitiveEquation)</code></li><li>define <code>surface_thermodynamics!(::ColumnVariables, ::CustomSurfaceThermodynamics, ::PrimitiveEquation)</code></li><li>expected to set <code>column.surface_temp</code>, <code>.surface_humid</code>, <code>.surface_air_density</code></li></ul><ol><li>Surface wind to calculate wind stress (momentum flux) as well as surface wind used</li></ol><ul><li>subtype <code>CustomSurfaceWind &lt;: AbstractSurfaceWind</code></li><li>define <code>initialize!(::CustomSurfaceWind, ::PrimitiveEquation)</code></li><li>define <code>surface_wind_stress!(::ColumnVariables, ::CustomSurfaceWind, ::PrimitiveEquation)</code></li><li>expected to set <code>column.surface_wind_speed</code> for other fluxes</li><li>and accumulate (<code>+=</code>) into <code>column.flux_u_upward</code> and <code>.flux_v_upward</code></li></ul><ol><li>Surface (sensible) heat flux</li></ol><ul><li>subtype <code>CustomSurfaceHeatFlux &lt;: AbstractSurfaceHeatFlux</code></li><li>define <code>initialize!(::CustomSurfaceHeatFlux, ::PrimitiveEquation)</code></li><li>define <code>surface_heat_flux!(::ColumnVariables, ::CustomSurfaceHeatFlux, ::PrimitiveEquation)</code></li><li>expected to accumulate (<code>+=</code>) into <code>column.flux_temp_upward</code></li></ul><ol><li>Surface evaporation</li></ol><ul><li>subtype <code>CustomSurfaceEvaporation &lt;: AbstractSurfaceEvaporation</code></li><li>define <code>initialize!(::CustomSurfaceEvaporation, ::PrimitiveEquation)</code></li><li>define <code>surface_evaporation!(::ColumnVariables, ::CustomSurfaceEvaporation, ::PrimitiveEquation)</code></li><li>expected to accumulate (<code>+=</code>) into <code>column.flux_humid_upward</code></li></ul><p>You can customize individual components and leave the other ones as default or by setting them to <code>NoSurfaceWind</code>, <code>NoSurfaceHeatFlux</code>, <code>NoSurfaceEvaporation</code>, but note that without the surface wind the heat and evaporative fluxes are also effectively disabled as they scale with the <code>column.surface_wind_speed</code> set by default with the <code>surface_wind_stress!</code> in (2.) above.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../forcing_drag/">« Forcing and drag</a><a class="docs-footer-nextpage" href="../orography/">Orography »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Tuesday 7 May 2024 08:04">Tuesday 7 May 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
