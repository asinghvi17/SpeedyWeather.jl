<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Function and type index · SpeedyWeather.jl</title><meta name="title" content="Function and type index · SpeedyWeather.jl"/><meta property="og:title" content="Function and type index · SpeedyWeather.jl"/><meta property="twitter:title" content="Function and type index · SpeedyWeather.jl"/><meta name="description" content="Documentation for SpeedyWeather.jl."/><meta property="og:description" content="Documentation for SpeedyWeather.jl."/><meta property="twitter:description" content="Documentation for SpeedyWeather.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SpeedyWeather.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Dynamics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../barotropic/">Barotropic model</a></li><li><a class="tocitem" href="../shallowwater/">Shallow water model</a></li><li><a class="tocitem" href="../primitiveequation/">Primitive equation model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Physics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../large_scale_condensation/">Large-scale condensation</a></li><li><a class="tocitem" href="../convection/">Convection</a></li><li><a class="tocitem" href="../radiation/">Radiation</a></li><li><a class="tocitem" href="../vertical_diffusion/">Vertical diffusion</a></li><li><a class="tocitem" href="../surface_fluxes/">Surface fluxes</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Discretization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../spectral_transform/">Spherical Harmonic Transform</a></li><li><a class="tocitem" href="../grids/">Grids</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Running SpeedyWeather</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../how_to_run_speedy/">How to run SpeedyWeather</a></li><li><a class="tocitem" href="../setups/">Model setups</a></li><li><a class="tocitem" href="../structure/">Tree structure</a></li><li><a class="tocitem" href="../particles/">Particle advection</a></li><li><a class="tocitem" href="../output/">NetCDF output</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Extending SpeedyWeather</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../forcing_drag/">Forcing and drag</a></li><li><a class="tocitem" href="../parameterizations/">Parameterizations</a></li><li><a class="tocitem" href="../orography/">Orography</a></li><li><a class="tocitem" href="../land_sea_mask/">Land-Sea Mask</a></li><li><a class="tocitem" href="../callbacks/">Callbacks</a></li></ul></li><li><a class="tocitem" href="../ringgrids/">RingGrids</a></li><li><a class="tocitem" href="../lowertriangularmatrices/">LowerTriangularMatrices</a></li><li><a class="tocitem" href="../speedytransforms/">SpeedyTransforms</a></li><li class="is-active"><a class="tocitem" href>Function and type index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Function and type index</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Function and type index</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SpeedyWeather/SpeedyWeather.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/main/docs/src/functions.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Function-and-type-index"><a class="docs-heading-anchor" href="#Function-and-type-index">Function and type index</a><a id="Function-and-type-index-1"></a><a class="docs-heading-anchor-permalink" href="#Function-and-type-index" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Core.Type-Tuple{SpectralGrid}" href="#Core.Type-Tuple{SpectralGrid}"><code>Core.Type</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Generator function pulling the resolution information from <code>spectral_grid</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/land_sea_mask.jl#L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.AbstractDevice" href="#SpeedyWeather.AbstractDevice"><code>SpeedyWeather.AbstractDevice</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">abstract type AbstractDevice</code></pre><p>Supertype of all devices SpeedyWeather.jl can ran on</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/gpu.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.AbstractLandSeaMask" href="#SpeedyWeather.AbstractLandSeaMask"><code>SpeedyWeather.AbstractLandSeaMask</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Abstract type for land-sea masks. Custom land-sea masks have to be defined as</p><pre><code class="nohighlight hljs">CustomMask{NF&lt;:AbstractFloat, Grid&lt;:AbstractGrid{NF}} &lt;: AbstractLandSeaMask{NF, Grid}</code></pre><p>and need to have at least a field called <code>land_sea_mask::Grid</code> that uses a <code>Grid</code> as defined by the spectral grid object, so of correct size and with the number format <code>NF</code>. All <code>AbstractLandSeaMask</code> have a convenient generator function to be used like <code>mask = CustomMask(spectral_grid, option=argument)</code>, but you may add your own or customize by defining <code>CustomMask(args...)</code> which should return an instance of type <code>CustomMask{NF, Grid}</code> with parameters matching the spectral grid. Then the initialize function has to be extended for that new mask</p><pre><code class="nohighlight hljs">initialize!(mask::CustomMask, model::PrimitiveEquation)</code></pre><p>which generally is used to tweak the mask.land<em>sea</em>mask grid as you like, using any other options you have included in <code>CustomMask</code> as fields or anything else (preferrably read-only, because this is only to initialize the land-sea mask, nothing else) from <code>model</code>. You can for example read something from file, set some values manually, or use coordinates from <code>model.geometry</code>.</p><p>The land-sea mask grid is expected to have values between [0, 1] as we use a fractional mask, allowing for grid points being, e.g. quarter land and three quarters sea for 0.25 with 0 (=sea) and 1 (=land). The surface fluxes will weight proportionally the fluxes e.g. from sea and land surface temperatures. Note however, that the land-sea mask can declare grid points being (at least partially) ocean even though the sea surface temperatures aren&#39;t defined (=NaN) in that grid point. In that case, not flux is applied.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/land_sea_mask.jl#L1-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.AquaPlanetMask" href="#SpeedyWeather.AquaPlanetMask"><code>SpeedyWeather.AquaPlanetMask</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Land-sea mask with zero = sea everywhere.</p><ul><li><code>land_sea_mask::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code>: Land-sea mask [1] on grid-point space. Land=1, sea=0, land-area fraction in between.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/land_sea_mask.jl#L92-L94">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.BarotropicModel" href="#SpeedyWeather.BarotropicModel"><code>SpeedyWeather.BarotropicModel</code></a> — <span class="docstring-category">Type</span></header><section><div><p>The BarotropicModel contains all model components needed for the simulation of the barotropic vorticity equations. To be constructed like</p><pre><code class="nohighlight hljs">model = BarotropicModel(; spectral_grid, kwargs...)</code></pre><p>with <code>spectral_grid::SpectralGrid</code> used to initalize all non-default components passed on as keyword arguments, e.g. <code>planet=Earth(spectral_grid)</code>. Fields, representing model components, are</p><ul><li><p><code>spectral_grid::SpectralGrid</code></p></li><li><p><code>geometry::SpeedyWeather.AbstractGeometry</code></p></li><li><p><code>planet::SpeedyWeather.AbstractPlanet</code></p></li><li><p><code>atmosphere::SpeedyWeather.AbstractAtmosphere</code></p></li><li><p><code>coriolis::SpeedyWeather.AbstractCoriolis</code></p></li><li><p><code>forcing::SpeedyWeather.AbstractForcing</code></p></li><li><p><code>drag::SpeedyWeather.AbstractDrag</code></p></li><li><p><code>particle_advection::SpeedyWeather.AbstractParticleAdvection</code></p></li><li><p><code>initial_conditions::SpeedyWeather.AbstractInitialConditions</code></p></li><li><p><code>device_setup::SpeedyWeather.DeviceSetup</code></p></li><li><p><code>time_stepping::SpeedyWeather.AbstractTimeStepper</code></p></li><li><p><code>spectral_transform::SpectralTransform</code></p></li><li><p><code>implicit::SpeedyWeather.AbstractImplicit</code></p></li><li><p><code>horizontal_diffusion::SpeedyWeather.AbstractHorizontalDiffusion</code></p></li><li><p><code>output::SpeedyWeather.AbstractOutputWriter</code></p></li><li><p><code>callbacks::Dict{Symbol, SpeedyWeather.AbstractCallback}</code></p></li><li><p><code>feedback::SpeedyWeather.AbstractFeedback</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/models/barotropic.jl#L3-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.BulkRichardsonDrag" href="#SpeedyWeather.BulkRichardsonDrag"><code>SpeedyWeather.BulkRichardsonDrag</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Boundary layer drag coefficient from the bulk Richardson number, following Frierson, 2006, Journal of the Atmospheric Sciences.</p><ul><li><p><code>κ::Any</code>: von Kármán constant [1]</p></li><li><p><code>z₀::Any</code>: roughness length [m]</p></li><li><p><code>Ri_c::Any</code>: Critical Richardson number for stable mixing cutoff [1]</p></li><li><p><code>drag_max::Base.RefValue</code>: Maximum drag coefficient, κ²/log(zₐ/z₀) for zₐ from reference temperature</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/boundary_layer.jl#L94-L97">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.CPUDevice" href="#SpeedyWeather.CPUDevice"><code>SpeedyWeather.CPUDevice</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">CPUDevice &lt;: AbstractDevice</code></pre><p>Indicates that SpeedyWeather.jl runs on a single CPU </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/gpu.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ClausiusClapeyron" href="#SpeedyWeather.ClausiusClapeyron"><code>SpeedyWeather.ClausiusClapeyron</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Parameters for computing saturation vapour pressure of water using the Clausis-Clapeyron equation,</p><pre><code class="nohighlight hljs">e(T) = e₀ * exp( -Lᵥ/Rᵥ * (1/T - 1/T₀)),</code></pre><p>where T is in Kelvin, Lᵥ the the latent heat of condensation and Rᵥ the gas constant of water vapour</p><ul><li><p><code>e₀::AbstractFloat</code>: Saturation water vapour pressure at 0°C [Pa]</p></li><li><p><code>T₀::AbstractFloat</code>: 0°C in Kelvin</p></li><li><p><code>Lᵥ::AbstractFloat</code>: Latent heat of condensation/vaporization of water [J/kg]</p></li><li><p><code>cₚ::AbstractFloat</code>: Specific heat at constant pressure [J/K/kg]</p></li><li><p><code>R_vapour::AbstractFloat</code>: Gas constant of water vapour [J/kg/K]</p></li><li><p><code>R_dry::AbstractFloat</code>: Gas constant of dry air [J/kg/K]</p></li><li><p><code>Lᵥ_Rᵥ::AbstractFloat</code>: Latent heat of condensation divided by gas constant of water vapour [K]</p></li><li><p><code>T₀⁻¹::AbstractFloat</code>: Inverse of T₀, one over 0°C in Kelvin</p></li><li><p><code>mol_ratio::AbstractFloat</code>: Ratio of molecular masses [1] of water vapour over dry air (=R<em>dry/R</em>vapour).</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/thermodynamics.jl#L5-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ClausiusClapeyron-Tuple{NF} where NF" href="#SpeedyWeather.ClausiusClapeyron-Tuple{NF} where NF"><code>SpeedyWeather.ClausiusClapeyron</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Functor: Saturation water vapour pressure as a function of temperature using the Clausius-Clapeyron equation,</p><pre><code class="nohighlight hljs">e(T) = e₀ * exp( -Lᵥ/Rᵥ * (1/T - 1/T₀)),</code></pre><p>where T is in Kelvin, Lᵥ the the latent heat of vaporization and Rᵥ the gas constant of water vapour, T₀ is 0˚C in Kelvin.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/thermodynamics.jl#L47">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Clock" href="#SpeedyWeather.Clock"><code>SpeedyWeather.Clock</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Clock struct keeps track of the model time, how many days to integrate for and how many time steps this takes</p><ul><li><p><code>time::DateTime</code>: current model time</p></li><li><p><code>start::DateTime</code>: start time of simulation</p></li><li><p><code>period::Second</code>: period to integrate for, set in set_period!(::Clock, ::Dates.Period)</p></li><li><p><code>timestep_counter::Int64</code>: Counting all time steps during simulation</p></li><li><p><code>n_timesteps::Int64</code>: number of time steps to integrate for, set in initialize!(::Clock, ::AbstractTimeStepper)</p></li><li><p><code>Δt::Dates.Millisecond</code>: Time step</p></li></ul><p>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/clock.jl#L4-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Clock-Tuple{SpeedyWeather.AbstractTimeStepper}" href="#SpeedyWeather.Clock-Tuple{SpeedyWeather.AbstractTimeStepper}"><code>SpeedyWeather.Clock</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Clock(
    time_stepping::SpeedyWeather.AbstractTimeStepper;
    kwargs...
) -&gt; Clock
</code></pre><p>Create and initialize a clock from <code>time_stepping</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/clock.jl#L67">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ColumnVariables" href="#SpeedyWeather.ColumnVariables"><code>SpeedyWeather.ColumnVariables</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Mutable struct that contains all prognostic (copies thereof) and diagnostic variables in a single column needed to evaluate the physical parametrizations. For now the struct is mutable as we will reuse the struct to iterate over horizontal grid points. Every column vector has <code>nlev</code> entries, from [1] at the top to [end] at the lowermost model level at the planetary boundary layer.</p><ul><li><p><code>nlev::Int64</code></p></li><li><p><code>ij::Int64</code></p></li><li><p><code>jring::Int64</code></p></li><li><p><code>lond::AbstractFloat</code></p></li><li><p><code>latd::AbstractFloat</code></p></li><li><p><code>land_fraction::AbstractFloat</code></p></li><li><p><code>orography::AbstractFloat</code></p></li><li><p><code>u::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>v::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>temp::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>humid::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>ln_pres::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>pres::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>u_tend::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>v_tend::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>temp_tend::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>humid_tend::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>flux_u_upward::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>flux_u_downward::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>flux_v_upward::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>flux_v_downward::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>flux_temp_upward::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>flux_temp_downward::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>flux_humid_upward::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>flux_humid_downward::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>boundary_layer_depth::Int64</code></p></li><li><p><code>boundary_layer_drag::AbstractFloat</code></p></li><li><p><code>surface_geopotential::AbstractFloat</code></p></li><li><p><code>surface_u::AbstractFloat</code></p></li><li><p><code>surface_v::AbstractFloat</code></p></li><li><p><code>surface_temp::AbstractFloat</code></p></li><li><p><code>surface_humid::AbstractFloat</code></p></li><li><p><code>surface_wind_speed::AbstractFloat</code></p></li><li><p><code>skin_temperature_sea::AbstractFloat</code></p></li><li><p><code>skin_temperature_land::AbstractFloat</code></p></li><li><p><code>soil_moisture_availability::AbstractFloat</code></p></li><li><p><code>surface_air_density::AbstractFloat</code></p></li><li><p><code>sat_humid::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>dry_static_energy::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>temp_virt::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>bulk_richardson::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>geopot::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>cloud_top::Int64</code></p></li><li><p><code>precip_convection::AbstractFloat</code></p></li><li><p><code>precip_large_scale::AbstractFloat</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/define_column.jl#L4-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.DeviceSetup" href="#SpeedyWeather.DeviceSetup"><code>SpeedyWeather.DeviceSetup</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DeviceSetup{S&lt;:AbstractDevice}</code></pre><p>Holds information about the device the model is running on and workgroup size. </p><ul><li><code>device::AbstractDevice</code>: Device the model is running on </li><li><code>device_KA::KernelAbstractions.Device</code>: Device for use with KernelAbstractions</li><li><code>n</code>: workgroup size  </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/gpu.jl#L44-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.DiagnosticVariables" href="#SpeedyWeather.DiagnosticVariables"><code>SpeedyWeather.DiagnosticVariables</code></a> — <span class="docstring-category">Type</span></header><section><div><p>All diagnostic variables.</p><ul><li><p><code>layers::Array{DiagnosticVariablesLayer{NF, Grid}, 1} where {NF&lt;:AbstractFloat, Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}}</code></p></li><li><p><code>surface::SpeedyWeather.SurfaceVariables</code></p></li><li><p><code>columns::Array{ColumnVariables{NF}, 1} where NF&lt;:AbstractFloat</code></p></li><li><p><code>particles::SpeedyWeather.ParticleVariables</code></p></li><li><p><code>nlat_half::Int64</code></p></li><li><p><code>nlev::Int64</code></p></li><li><p><code>npoints::Int64</code></p></li><li><p><code>scale::Base.RefValue{NF} where NF&lt;:AbstractFloat</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/diagnostic_variables.jl#L184-L186">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.DiagnosticVariablesLayer" href="#SpeedyWeather.DiagnosticVariablesLayer"><code>SpeedyWeather.DiagnosticVariablesLayer</code></a> — <span class="docstring-category">Type</span></header><section><div><p>All diagnostic variables for a given layer: tendencies, prognostic varibles on the grid, and intermediate dynamics variables.</p><ul><li><p><code>npoints::Int64</code></p></li><li><p><code>k::Int64</code></p></li><li><p><code>tendencies::SpeedyWeather.Tendencies</code></p></li><li><p><code>grid_variables::SpeedyWeather.GridVariables</code></p></li><li><p><code>dynamics_variables::SpeedyWeather.DynamicsVariables</code></p></li><li><p><code>temp_average::Base.RefValue{NF} where NF&lt;:AbstractFloat</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/diagnostic_variables.jl#L92-L95">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.DryBettsMiller" href="#SpeedyWeather.DryBettsMiller"><code>SpeedyWeather.DryBettsMiller</code></a> — <span class="docstring-category">Type</span></header><section><div><p>The simplified Betts-Miller convection scheme from Frierson, 2007, https://doi.org/10.1175/JAS3935.1 but with humidity set to zero. Fields and options are</p><ul><li><p><code>nlev::Int64</code>: number of vertical layers/levels</p></li><li><p><code>time_scale::Second</code>: [OPTION] Relaxation time for profile adjustment</p></li><li><p><code>temp_ref_profile::Vector</code>: temperature [K] reference profile to adjust to</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/convection.jl#L248-L252">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.DynamicsVariables" href="#SpeedyWeather.DynamicsVariables"><code>SpeedyWeather.DynamicsVariables</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Intermediate quantities for the dynamics of a given layer.</p><ul><li><p><code>nlat_half::Int64</code></p></li><li><p><code>trunc::Int64</code></p></li><li><p><code>a::LowerTriangularMatrix{Complex{NF}} where NF&lt;:AbstractFloat</code></p></li><li><p><code>b::LowerTriangularMatrix{Complex{NF}} where NF&lt;:AbstractFloat</code></p></li><li><p><code>a_grid::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>b_grid::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>uv∇lnp::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>uv∇lnp_sum_above::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>div_sum_above::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>temp_virt::LowerTriangularMatrix{Complex{NF}} where NF&lt;:AbstractFloat</code></p></li><li><p><code>geopot::LowerTriangularMatrix{Complex{NF}} where NF&lt;:AbstractFloat</code></p></li><li><p><code>σ_tend::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/diagnostic_variables.jl#L51-L53">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Earth" href="#SpeedyWeather.Earth"><code>SpeedyWeather.Earth</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Create a struct <code>Earth&lt;:AbstractPlanet</code>, with the following physical/orbital characteristics. Note that <code>radius</code> is not part of it as this should be chosen in <code>SpectralGrid</code>. Keyword arguments are</p><ul><li><p><code>rotation::AbstractFloat</code>: angular frequency of Earth&#39;s rotation [rad/s]</p></li><li><p><code>gravity::AbstractFloat</code>: gravitational acceleration [m/s^2]</p></li><li><p><code>daily_cycle::Bool</code>: switch on/off daily cycle</p></li><li><p><code>length_of_day::Second</code>: Seconds in a daily rotation</p></li><li><p><code>seasonal_cycle::Bool</code>: switch on/off seasonal cycle</p></li><li><p><code>length_of_year::Second</code>: Seconds in an orbit around the sun</p></li><li><p><code>equinox::DateTime</code>: time of spring equinox (year irrelevant)</p></li><li><p><code>axial_tilt::AbstractFloat</code>: angle [˚] rotation axis tilt wrt to orbit</p></li><li><p><code>solar_constant::AbstractFloat</code>: Total solar irradiance at the distance of 1 AU [W/m²]</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/planet.jl#L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.EarthAtmosphere" href="#SpeedyWeather.EarthAtmosphere"><code>SpeedyWeather.EarthAtmosphere</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Create a struct <code>EarthAtmosphere &lt;: AbstractAtmosphere</code>, with the following physical/chemical characteristics. Keyword arguments are</p><ul><li><p><code>mol_mass_dry_air::AbstractFloat</code>: molar mass of dry air [g/mol]</p></li><li><p><code>mol_mass_vapour::AbstractFloat</code>: molar mass of water vapour [g/mol]</p></li><li><p><code>heat_capacity::AbstractFloat</code>: specific heat at constant pressure cₚ [J/K/kg]</p></li><li><p><code>R_gas::AbstractFloat</code>: universal gas constant [J/K/mol]</p></li><li><p><code>R_dry::AbstractFloat</code>: specific gas constant for dry air [J/kg/K]</p></li><li><p><code>R_vapour::AbstractFloat</code>: specific gas constant for water vapour [J/kg/K]</p></li><li><p><code>mol_ratio::AbstractFloat</code>: Ratio of gas constants: dry air / water vapour, often called ε [1]</p></li><li><p><code>μ_virt_temp::AbstractFloat</code>: Virtual temperature Tᵥ calculation, Tᵥ = T(1 + μ*q), humidity q, absolute tempereature T</p></li><li><p><code>κ::AbstractFloat</code>: = R_dry/cₚ, gas const for air over heat capacity</p></li><li><p><code>water_density::AbstractFloat</code>: water density [kg/m³]</p></li><li><p><code>latent_heat_condensation::AbstractFloat</code>: latent heat of condensation [J/kg] for consistency with specific humidity [kg/kg]</p></li><li><p><code>latent_heat_sublimation::AbstractFloat</code>: latent heat of sublimation [J/kg]</p></li><li><p><code>stefan_boltzmann::AbstractFloat</code>: stefan-Boltzmann constant [W/m²/K⁴]</p></li><li><p><code>pres_ref::AbstractFloat</code>: surface reference pressure [Pa]</p></li><li><p><code>temp_ref::AbstractFloat</code>: surface reference temperature [K]</p></li><li><p><code>moist_lapse_rate::AbstractFloat</code>: reference moist-adiabatic temperature lapse rate [K/m]</p></li><li><p><code>dry_lapse_rate::AbstractFloat</code>: reference dry-adiabatic temperature lapse rate [K/m]</p></li><li><p><code>layer_thickness::AbstractFloat</code>: layer thickness for the shallow water model [m]</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/atmosphere.jl#L4">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.EarthOrography" href="#SpeedyWeather.EarthOrography"><code>SpeedyWeather.EarthOrography</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Earth&#39;s orography read from file, with smoothing.</p><ul><li><p><code>path::String</code>: path to the folder containing the orography file, pkg path default</p></li><li><p><code>file::String</code>: filename of orography</p></li><li><p><code>file_Grid::Type{&lt;:SpeedyWeather.RingGrids.AbstractGrid}</code>: Grid the orography file comes on</p></li><li><p><code>scale::Float64</code>: scale orography by a factor</p></li><li><p><code>smoothing::Bool</code>: smooth the orography field?</p></li><li><p><code>smoothing_power::Float64</code>: power of Laplacian for smoothing</p></li><li><p><code>smoothing_strength::Float64</code>: highest degree l is multiplied by</p></li><li><p><code>smoothing_truncation::Int64</code>: resolution of orography in spectral trunc</p></li><li><p><code>orography::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>geopot_surf::LowerTriangularMatrix{Complex{NF}} where NF&lt;:AbstractFloat</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/orography.jl#L99-L101">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.EarthOrography-Tuple{SpectralGrid}" href="#SpeedyWeather.EarthOrography-Tuple{SpectralGrid}"><code>SpeedyWeather.EarthOrography</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">EarthOrography(
    spectral_grid::SpectralGrid;
    kwargs...
) -&gt; EarthOrography
</code></pre><p>Generator function pulling the resolution information from <code>spectral_grid</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/orography.jl#L136">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Feedback" href="#SpeedyWeather.Feedback"><code>SpeedyWeather.Feedback</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Feedback() -&gt; Feedback
Feedback(verbose::Bool) -&gt; Feedback
Feedback(verbose::Bool, debug::Bool) -&gt; Feedback
</code></pre><p>Generator function for a Feedback struct.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/feedback.jl#L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Feedback" href="#SpeedyWeather.Feedback"><code>SpeedyWeather.Feedback</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Feedback struct that contains options and object for command-line feedback like the progress meter.</p><ul><li><p><code>verbose::Bool</code>: print feedback to REPL?</p></li><li><p><code>debug::Bool</code>: check for NaRs in the prognostic variables</p></li><li><p><code>output::Bool</code>: write a progress.txt file? State synced with OutputWriter.output</p></li><li><p><code>id::Union{Int64, String}</code>: identification of run, taken from ::OutputWriter</p></li><li><p><code>run_path::String</code>: path to run folder, taken from ::OutputWriter</p></li><li><p><code>progress_meter::ProgressMeter.Progress</code>: struct containing everything progress related</p></li><li><p><code>progress_txt::Union{Nothing, IOStream}</code>: txt is a Nothing in case of no output</p></li><li><p><code>nars_detected::Bool</code>: did Infs/NaNs occur in the simulation?</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/feedback.jl#L3-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.GPUDevice" href="#SpeedyWeather.GPUDevice"><code>SpeedyWeather.GPUDevice</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">GPUDevice &lt;: AbstractDevice</code></pre><p>Indicates that SpeedyWeather.jl runs on a single GPU</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/gpu.jl#L15-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Geometry" href="#SpeedyWeather.Geometry"><code>SpeedyWeather.Geometry</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Construct Geometry struct containing parameters and arrays describing an iso-latitude grid &lt;:AbstractGrid and the vertical levels. Pass on <code>SpectralGrid</code> to calculate the following fields</p><ul><li><p><code>spectral_grid::SpectralGrid</code>: SpectralGrid that defines spectral and grid resolution</p></li><li><p><code>Grid::Type{&lt;:SpeedyWeather.RingGrids.AbstractGrid}</code>: grid of the dynamical core</p></li><li><p><code>nlat_half::Int64</code>: resolution parameter nlat_half of Grid, # of latitudes on one hemisphere (incl Equator)</p></li><li><p><code>nlon_max::Int64</code>: maximum number of longitudes (at/around Equator)</p></li><li><p><code>nlon::Int64</code>: =nlon_max, same (used for compatibility), TODO: still needed?</p></li><li><p><code>nlat::Int64</code>: number of latitude rings</p></li><li><p><code>nlev::Int64</code>: number of vertical levels</p></li><li><p><code>npoints::Int64</code>: total number of grid points</p></li><li><p><code>radius::AbstractFloat</code>: Planet&#39;s radius [m]</p></li><li><p><code>colat::Vector{Float64}</code>: array of colatitudes in radians (0...π)</p></li><li><p><code>lat::Vector{NF} where NF&lt;:AbstractFloat</code>: array of latitudes in radians (π...-π)</p></li><li><p><code>latd::Vector{Float64}</code>: array of latitudes in degrees (90˚...-90˚)</p></li><li><p><code>lond::Vector{Float64}</code>: array of longitudes in degrees (0...360˚), empty for non-full grids</p></li><li><p><code>londs::Vector{NF} where NF&lt;:AbstractFloat</code>: longitude (0˚...360˚) for each grid point in ring order</p></li><li><p><code>latds::Vector{NF} where NF&lt;:AbstractFloat</code>: latitude (-90˚...˚90) for each grid point in ring order</p></li><li><p><code>lons::Vector{NF} where NF&lt;:AbstractFloat</code>: longitude (0...2π) for each grid point in ring order</p></li><li><p><code>lats::Vector{NF} where NF&lt;:AbstractFloat</code>: latitude (-π/2...π/2) for each grid point in ring order</p></li><li><p><code>sinlat::Vector{NF} where NF&lt;:AbstractFloat</code>: sin of latitudes</p></li><li><p><code>coslat::Vector{NF} where NF&lt;:AbstractFloat</code>: cos of latitudes</p></li><li><p><code>coslat⁻¹::Vector{NF} where NF&lt;:AbstractFloat</code>: = 1/cos(lat)</p></li><li><p><code>coslat²::Vector{NF} where NF&lt;:AbstractFloat</code>: = cos²(lat)</p></li><li><p><code>coslat⁻²::Vector{NF} where NF&lt;:AbstractFloat</code>: # = 1/cos²(lat)</p></li><li><p><code>σ_levels_half::Vector{NF} where NF&lt;:AbstractFloat</code>: σ at half levels, σ_k+1/2</p></li><li><p><code>σ_levels_full::Vector{NF} where NF&lt;:AbstractFloat</code>: σ at full levels, σₖ</p></li><li><p><code>σ_levels_thick::Vector{NF} where NF&lt;:AbstractFloat</code>: σ level thicknesses, σₖ₊₁ - σₖ</p></li><li><p><code>ln_σ_levels_full::Vector{NF} where NF&lt;:AbstractFloat</code>: log of σ at full levels, include surface (σ=1) as last element</p></li><li><p><code>full_to_half_interpolation::Vector{NF} where NF&lt;:AbstractFloat</code>: Full to half levels interpolation</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/geometry.jl#L4">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Geometry-Tuple{SpectralGrid}" href="#SpeedyWeather.Geometry-Tuple{SpectralGrid}"><code>SpeedyWeather.Geometry</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Geometry(spectral_grid::SpectralGrid) -&gt; Geometry
</code></pre><p>Generator function for <code>Geometry</code> struct based on <code>spectral_grid</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/geometry.jl#L99">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.GlobalSurfaceTemperatureCallback" href="#SpeedyWeather.GlobalSurfaceTemperatureCallback"><code>SpeedyWeather.GlobalSurfaceTemperatureCallback</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Callback that records the global mean surface temperature on every time step</p><ul><li><p><code>timestep_counter::Int64</code></p></li><li><p><code>temp::Vector</code></p></li></ul><p>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/callbacks.jl#L90-L92">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.GridVariable3D" href="#SpeedyWeather.GridVariable3D"><code>SpeedyWeather.GridVariable3D</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A horizontal grid::AbstractGrid with a third dimension (time or vertical). As the grid is a AbstractVector (with a single index only) a GridVariable3D is a subtype of AbstractMatrix (and not AbstractArray{T,3}) with the horizontal dimension unravelled into its first dimension. To be generated and indexed like</p><pre><code class="nohighlight hljs">nlat_half = 24      # resolution parameter of the horizontal grid
nlayer = 8          # number of vertical layers (or timesteps)
G = zeros(GridVariable3D, OctahedralGaussianGrid{Float32}, nlat_half, nlayer)
G[50, 3]            # the 50th grid point on the 3rd layer</code></pre><p>Fields are</p><ul><li><p><code>data::Vector{Grid} where {NF, Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}}</code></p></li><li><p><code>npoints2D::Int64</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/variables_3D_4D.jl#L4-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.GridVariable4D" href="#SpeedyWeather.GridVariable4D"><code>SpeedyWeather.GridVariable4D</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A horizontal grid::AbstractGrid with a third and forth dimension (vertical and time). As the grid is a AbstractVector (with a single index only) a GridVariable3D is a subtype of AbstractArray{T, 3} (and not 4) with the horizontal dimension unravelled into its first dimension. To be generated and indexed like</p><pre><code class="nohighlight hljs">nlat_half = 24      # resolution parameter of the horizontal grid
nlayer = 8          # number of vertical layers
ntimesteps = 2      # number of time steps
G = zeros(GridVariable4D, OctahedralGaussianGrid{Float32}, nlat_half, nlayer, ntimesteps)
G[50, 3, 1]         # the 50th grid point on the 3rd layer and the 1st timestep</code></pre><p>Fields are</p><ul><li><p><code>data::Matrix{Grid} where {NF, Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}}</code></p></li><li><p><code>npoints2D::Int64</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/variables_3D_4D.jl#L43-L56">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.GridVariables" href="#SpeedyWeather.GridVariables"><code>SpeedyWeather.GridVariables</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Transformed prognostic variables (plus a few others) into grid-point space.</p><ul><li><p><code>nlat_half::Int64</code></p></li><li><p><code>vor_grid::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>div_grid::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>temp_grid::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>temp_grid_prev::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>temp_virt_grid::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>humid_grid::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>u_grid::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>v_grid::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>u_grid_prev::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>v_grid_prev::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li></ul><p>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/diagnostic_variables.jl#L28-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.HeldSuarez" href="#SpeedyWeather.HeldSuarez"><code>SpeedyWeather.HeldSuarez</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Struct that defines the temperature relaxation from Held and Suarez, 1996 BAMS</p><ul><li><p><code>nlat::Int64</code>: number of latitude rings</p></li><li><p><code>nlev::Int64</code>: number of vertical levels</p></li><li><p><code>σb::AbstractFloat</code>: sigma coordinate below which faster surface relaxation is applied</p></li><li><p><code>relax_time_slow::Second</code>: time scale for slow global relaxation</p></li><li><p><code>relax_time_fast::Second</code>: time scale for faster tropical surface relaxation</p></li><li><p><code>Tmin::AbstractFloat</code>: minimum equilibrium temperature [K]</p></li><li><p><code>Tmax::AbstractFloat</code>: maximum equilibrium temperature [K]</p></li><li><p><code>ΔTy::AbstractFloat</code>: meridional temperature gradient [K]</p></li><li><p><code>Δθz::AbstractFloat</code>: vertical temperature gradient [K]</p></li><li><p><code>κ::Base.RefValue{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>p₀::Base.RefValue{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>temp_relax_freq::Matrix{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>temp_equil_a::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>temp_equil_b::Vector{NF} where NF&lt;:AbstractFloat</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/temperature_relaxation.jl#L16-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.HeldSuarez-Tuple{SpectralGrid}" href="#SpeedyWeather.HeldSuarez-Tuple{SpectralGrid}"><code>SpeedyWeather.HeldSuarez</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">HeldSuarez(SG::SpectralGrid; kwargs...) -&gt; HeldSuarez
</code></pre><p>create a HeldSuarez temperature relaxation with arrays allocated given <code>spectral_grid</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/temperature_relaxation.jl#L58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.HumidityDiffusion" href="#SpeedyWeather.HumidityDiffusion"><code>SpeedyWeather.HumidityDiffusion</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Diffusion of dry static energy: A relaxation towards a reference gradient of static energy wrt to geopotential, see Fortran SPEEDY documentation.</p><ul><li><p><code>time_scale::Second</code>: time scale for strength</p></li><li><p><code>humidity_gradient::AbstractFloat</code>: [1] ∂RH/∂σ, vertical gradient of relative humidity RH wrt sigma coordinate σ</p></li><li><p><code>Fstar::Base.RefValue{NF} where NF&lt;:AbstractFloat</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/vertical_diffusion.jl#L85-L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.HyperDiffusion" href="#SpeedyWeather.HyperDiffusion"><code>SpeedyWeather.HyperDiffusion</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Struct for horizontal hyper diffusion of vor, div, temp; implicitly in spectral space with a <code>power</code> of the Laplacian (default=4) and the strength controlled by <code>time_scale</code>. Options exist to scale the diffusion by resolution, and adaptive depending on the current vorticity maximum to increase diffusion in active layers. Furthermore the power can be decreased above the <code>tapering_σ</code> to <code>power_stratosphere</code> (default 2). For Barotropic, ShallowWater, the default non-adaptive constant-time scale hyper diffusion is used. Options are</p><ul><li><p><code>trunc::Int64</code>: spectral resolution</p></li><li><p><code>nlev::Int64</code>: number of vertical levels</p></li><li><p><code>power::Float64</code>: power of Laplacian</p></li><li><p><code>time_scale::Second</code>: diffusion time scale</p></li><li><p><code>resolution_scaling::Float64</code>: stronger diffusion with resolution? 0: constant with trunc, 1: (inverse) linear with trunc, etc</p></li><li><p><code>power_stratosphere::Float64</code>: different power for tropopause/stratosphere</p></li><li><p><code>tapering_σ::Float64</code>: linearly scale towards power_stratosphere above this σ</p></li><li><p><code>adaptive::Bool</code>: adaptive = higher diffusion for layers with higher vorticity levels.</p></li><li><p><code>vor_max::Float64</code>: above this (absolute) vorticity level [1/s], diffusion is increased</p></li><li><p><code>adaptive_strength::Float64</code>: increase strength above <code>vor_max</code> by this factor times <code>max(abs(vor))/vor_max</code></p></li><li><p><code>∇²ⁿ_2D::Vector</code></p></li><li><p><code>∇²ⁿ_2D_implicit::Vector</code></p></li><li><p><code>∇²ⁿ::Array{Vector{NF}, 1} where NF</code></p></li><li><p><code>∇²ⁿ_implicit::Array{Vector{NF}, 1} where NF</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/horizontal_diffusion.jl#L5-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.HyperDiffusion-Tuple{SpectralGrid}" href="#SpeedyWeather.HyperDiffusion-Tuple{SpectralGrid}"><code>SpeedyWeather.HyperDiffusion</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">HyperDiffusion(
    spectral_grid::SpectralGrid;
    kwargs...
) -&gt; HyperDiffusion{&lt;:AbstractFloat}
</code></pre><p>Generator function based on the resolutin in <code>spectral_grid</code>. Passes on keyword arguments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/horizontal_diffusion.jl#L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ImplicitCondensation" href="#SpeedyWeather.ImplicitCondensation"><code>SpeedyWeather.ImplicitCondensation</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Large scale condensation as with implicit precipitation.</p><ul><li><p><code>max_heating::AbstractFloat</code>: Flux limiter for latent heat release [K] per timestep</p></li><li><p><code>time_scale::AbstractFloat</code>: Time scale in multiples of time step Δt</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/large_scale_condensation.jl#L10-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ImplicitPrimitiveEquation" href="#SpeedyWeather.ImplicitPrimitiveEquation"><code>SpeedyWeather.ImplicitPrimitiveEquation</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Struct that holds various precomputed arrays for the semi-implicit correction to prevent gravity waves from amplifying in the primitive equation model.</p><ul><li><p><code>trunc::Int64</code>: spectral resolution</p></li><li><p><code>nlev::Int64</code>: number of vertical levels</p></li><li><p><code>α::Float64</code>: time-step coefficient: 0=explicit, 0.5=centred implicit, 1=backward implicit</p></li><li><p><code>temp_profile::Vector{NF} where NF&lt;:AbstractFloat</code>: vertical temperature profile, obtained from diagn</p></li><li><p><code>ξ::Base.RefValue{NF} where NF&lt;:AbstractFloat</code>: time step 2α*Δt packed in RefValue for mutability</p></li><li><p><code>R::Matrix{NF} where NF&lt;:AbstractFloat</code>: divergence: operator for the geopotential calculation</p></li><li><p><code>U::Vector{NF} where NF&lt;:AbstractFloat</code>: divergence: the -RdTₖ∇² term excl the eigenvalues from ∇² for divergence</p></li><li><p><code>L::Matrix{NF} where NF&lt;:AbstractFloat</code>: temperature: operator for the TₖD + κTₖDlnps/Dt term</p></li><li><p><code>W::Vector{NF} where NF&lt;:AbstractFloat</code>: pressure: vertical averaging of the -D̄ term in the log surface pres equation</p></li><li><p><code>L0::Vector{NF} where NF&lt;:AbstractFloat</code>: components to construct L, 1/ 2Δσ</p></li><li><p><code>L1::Matrix{NF} where NF&lt;:AbstractFloat</code>: vert advection term in the temperature equation (below+above)</p></li><li><p><code>L2::Vector{NF} where NF&lt;:AbstractFloat</code>: factor in front of the div<em>sum</em>above term</p></li><li><p><code>L3::Matrix{NF} where NF&lt;:AbstractFloat</code>: <em>sum</em>above operator itself</p></li><li><p><code>L4::Vector{NF} where NF&lt;:AbstractFloat</code>: factor in front of div term in Dlnps/Dt</p></li><li><p><code>S::Matrix{NF} where NF&lt;:AbstractFloat</code>: for every l the matrix to be inverted</p></li><li><p><code>S⁻¹::Array{NF, 3} where NF&lt;:AbstractFloat</code>: combined inverted operator: S = 1 - ξ²(RL + UW)</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/implicit.jl#L130-L133">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ImplicitPrimitiveEquation-Tuple{SpectralGrid, Vararg{Any}}" href="#SpeedyWeather.ImplicitPrimitiveEquation-Tuple{SpectralGrid, Vararg{Any}}"><code>SpeedyWeather.ImplicitPrimitiveEquation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ImplicitPrimitiveEquation(
    spectral_grid::SpectralGrid,
    kwargs...
) -&gt; ImplicitPrimitiveEquation
</code></pre><p>Generator using the resolution from SpectralGrid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/implicit.jl#L188">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ImplicitShallowWater" href="#SpeedyWeather.ImplicitShallowWater"><code>SpeedyWeather.ImplicitShallowWater</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Struct that holds various precomputed arrays for the semi-implicit correction to prevent gravity waves from amplifying in the shallow water model.</p><ul><li><p><code>trunc::Int64</code></p></li><li><p><code>α::Float64</code>: coefficient for semi-implicit computations to filter gravity waves</p></li><li><p><code>H::Base.RefValue{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>ξH::Base.RefValue{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>g∇²::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>ξg∇²::Vector{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>S⁻¹::Vector{NF} where NF&lt;:AbstractFloat</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/implicit.jl#L13-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ImplicitShallowWater-Tuple{SpectralGrid}" href="#SpeedyWeather.ImplicitShallowWater-Tuple{SpectralGrid}"><code>SpeedyWeather.ImplicitShallowWater</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ImplicitShallowWater(
    spectral_grid::SpectralGrid;
    kwargs...
) -&gt; ImplicitShallowWater
</code></pre><p>Generator using the resolution from <code>spectral_grid</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/implicit.jl#L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.JablonowskiRelaxation" href="#SpeedyWeather.JablonowskiRelaxation"><code>SpeedyWeather.JablonowskiRelaxation</code></a> — <span class="docstring-category">Type</span></header><section><div><p>HeldSuarez-like temperature relaxation, but towards the Jablonowski temperature profile with increasing temperatures in the stratosphere.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/temperature_relaxation.jl#L132">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.JablonowskiRelaxation-Tuple{SpectralGrid}" href="#SpeedyWeather.JablonowskiRelaxation-Tuple{SpectralGrid}"><code>SpeedyWeather.JablonowskiRelaxation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">JablonowskiRelaxation(
    SG::SpectralGrid;
    kwargs...
) -&gt; JablonowskiRelaxation
</code></pre><p>create a JablonowskiRelaxation temperature relaxation with arrays allocated given <code>spectral_grid</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/temperature_relaxation.jl#L171">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.JablonowskiTemperature" href="#SpeedyWeather.JablonowskiTemperature"><code>SpeedyWeather.JablonowskiTemperature</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Create a struct that contains all parameters for the Jablonowski and Williamson, 2006 intitial conditions for the primitive equation model. Default values as in Jablonowski.</p><ul><li><p><code>η₀::Float64</code>: conversion from σ to Jablonowski&#39;s ηᵥ-coordinates</p></li><li><p><code>σ_tropopause::Float64</code>: Sigma coordinates of the tropopause [1]</p></li><li><p><code>u₀::Float64</code>: max amplitude of zonal wind [m/s]</p></li><li><p><code>ΔT::Float64</code>: temperature difference used for stratospheric lapse rate [K], Jablonowski uses ΔT = 4.8e5 [K]</p></li><li><p><code>Tmin::Float64</code>: minimum temperature [K] of profile</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/initial_conditions.jl#L288">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.JetStreamForcing" href="#SpeedyWeather.JetStreamForcing"><code>SpeedyWeather.JetStreamForcing</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Forcing term for the Barotropic or ShallowWaterModel with an idealised jet stream similar to the initial conditions from Galewsky, 2004, but mirrored for both hemispheres.</p><ul><li><p><code>nlat::Int64</code>: Number of latitude rings</p></li><li><p><code>latitude::Any</code>: jet latitude [˚N]</p></li><li><p><code>width::Any</code>: jet width [˚], default ≈ 19.29˚</p></li><li><p><code>speed::Any</code>: jet speed scale [m/s]</p></li><li><p><code>time_scale::Second</code>: time scale [days]</p></li><li><p><code>amplitude::Vector</code>: precomputed amplitude vector [m/s²]</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/forcing.jl#L20-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Keepbits" href="#SpeedyWeather.Keepbits"><code>SpeedyWeather.Keepbits</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Number of mantissa bits to keep for each prognostic variable when compressed for netCDF and .jld2 data output.</p><ul><li><p><code>u::Int64</code></p></li><li><p><code>v::Int64</code></p></li><li><p><code>vor::Int64</code></p></li><li><p><code>div::Int64</code></p></li><li><p><code>temp::Int64</code></p></li><li><p><code>pres::Int64</code></p></li><li><p><code>humid::Int64</code></p></li><li><p><code>precip_cond::Int64</code></p></li><li><p><code>precip_conv::Int64</code></p></li><li><p><code>cloud::Int64</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/output.jl#L3-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LandSeaMask" href="#SpeedyWeather.LandSeaMask"><code>SpeedyWeather.LandSeaMask</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Land-sea mask, fractional, read from file.</p><ul><li><p><code>path::String</code>: path to the folder containing the land-sea mask file, pkg path default</p></li><li><p><code>file::String</code>: filename of land sea mask</p></li><li><p><code>file_Grid::Type{&lt;:SpeedyWeather.RingGrids.AbstractGrid}</code>: Grid the land-sea mask file comes on</p></li><li><p><code>land_sea_mask::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code>: Land-sea mask [1] on grid-point space. Land=1, sea=0, land-area fraction in between.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/land_sea_mask.jl#L38-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Leapfrog" href="#SpeedyWeather.Leapfrog"><code>SpeedyWeather.Leapfrog</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Leapfrog time stepping defined by the following fields</p><ul><li><p><code>trunc::Int64</code>: spectral resolution (max degree of spherical harmonics)</p></li><li><p><code>Δt_at_T31::Second</code>: time step in minutes for T31, scale linearly to <code>trunc</code></p></li><li><p><code>radius::AbstractFloat</code>: radius of sphere [m], used for scaling</p></li><li><p><code>adjust_with_output::Bool</code>: adjust Δt<em>at</em>T31 with the output<em>dt to reach output</em>dt exactly in integer time steps</p></li><li><p><code>robert_filter::AbstractFloat</code>: Robert (1966) time filter coefficeint to suppress comput. mode</p></li><li><p><code>williams_filter::AbstractFloat</code>: Williams time filter (Amezcua 2011) coefficient for 3rd order acc</p></li><li><p><code>Δt_millisec::Dates.Millisecond</code>: time step Δt [ms] at specified resolution</p></li><li><p><code>Δt_sec::AbstractFloat</code>: time step Δt [s] at specified resolution</p></li><li><p><code>Δt::AbstractFloat</code>: time step Δt [s/m] at specified resolution, scaled by 1/radius</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/time_integration.jl#L3-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Leapfrog-Tuple{SpectralGrid}" href="#SpeedyWeather.Leapfrog-Tuple{SpectralGrid}"><code>SpeedyWeather.Leapfrog</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Leapfrog(spectral_grid::SpectralGrid; kwargs...) -&gt; Leapfrog
</code></pre><p>Generator function for a Leapfrog struct using <code>spectral_grid</code> for the resolution information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/time_integration.jl#L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LinearDrag" href="#SpeedyWeather.LinearDrag"><code>SpeedyWeather.LinearDrag</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Linear boundary layer drag following Held and Suarez, 1996 BAMS</p><ul><li><p><code>nlev::Int64</code></p></li><li><p><code>σb::AbstractFloat</code></p></li><li><p><code>time_scale::Second</code></p></li><li><p><code>drag_coefs::Vector{NF} where NF&lt;:AbstractFloat</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/boundary_layer.jl#L18-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.LinearDrag-Tuple{SpectralGrid}" href="#SpeedyWeather.LinearDrag-Tuple{SpectralGrid}"><code>SpeedyWeather.LinearDrag</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">LinearDrag(SG::SpectralGrid; kwargs...) -&gt; LinearDrag
</code></pre><p>Generator function using <code>nlev</code> from <code>SG::SpectralGrid</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/boundary_layer.jl#L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.NoCallback" href="#SpeedyWeather.NoCallback"><code>SpeedyWeather.NoCallback</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Dummy callback that doesn&#39;t do anything.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/callbacks.jl#L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.NoOrography" href="#SpeedyWeather.NoOrography"><code>SpeedyWeather.NoOrography</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Orography with zero height in <code>orography</code> and zero surface geopotential <code>geopot_surf</code>.</p><ul><li><p><code>orography::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code>: height [m] on grid-point space.</p></li><li><p><code>geopot_surf::LowerTriangularMatrix{Complex{NF}} where NF&lt;:AbstractFloat</code>: surface geopotential, height*gravity [m²/s²]</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/orography.jl#L4-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.NoOrography-Tuple{SpectralGrid}" href="#SpeedyWeather.NoOrography-Tuple{SpectralGrid}"><code>SpeedyWeather.NoOrography</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">NoOrography(spectral_grid::SpectralGrid) -&gt; NoOrography
</code></pre><p>Generator function pulling the resolution information from <code>spectral_grid</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/orography.jl#L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.OutputWriter" href="#SpeedyWeather.OutputWriter"><code>SpeedyWeather.OutputWriter</code></a> — <span class="docstring-category">Type</span></header><section><div><p>NetCDF output writer. Contains all output options and auxiliary fields for output interpolation. To be initialised with <code>OutputWriter(::SpectralGrid, ::Type{&lt;:ModelSetup}, kwargs...)</code> to pass on the resolution information and the model type which chooses which variables to output. Options include</p><ul><li><p><code>spectral_grid::SpectralGrid</code></p></li><li><p><code>output::Bool</code></p></li><li><p><code>path::String</code>: [OPTION] path to output folder, run_???? will be created within</p></li><li><p><code>id::String</code>: [OPTION] run identification number/string</p></li><li><p><code>run_path::String</code></p></li><li><p><code>filename::String</code>: [OPTION] name of the output netcdf file</p></li><li><p><code>write_restart::Bool</code>: [OPTION] also write restart file if output==true?</p></li><li><p><code>pkg_version::VersionNumber</code></p></li><li><p><code>startdate::DateTime</code></p></li><li><p><code>output_dt::Second</code>: [OPTION] output frequency, time step</p></li><li><p><code>output_vars::Vector{Symbol}</code>: [OPTION] which variables to output, u, v, vor, div, pres, temp, humid</p></li><li><p><code>missing_value::Union{Float32, Float64}</code>: [OPTION] missing value to be used in netcdf output</p></li><li><p><code>compression_level::Int64</code>: [OPTION] lossless compression level; 1=low but fast, 9=high but slow</p></li><li><p><code>shuffle::Bool</code>: [OPTION] shuffle/bittranspose filter for compression</p></li><li><p><code>keepbits::SpeedyWeather.Keepbits</code>: [OPTION] mantissa bits to keep for every variable</p></li><li><p><code>output_every_n_steps::Int64</code></p></li><li><p><code>timestep_counter::Int64</code></p></li><li><p><code>output_counter::Int64</code></p></li><li><p><code>netcdf_file::Union{Nothing, NCDatasets.NCDataset}</code></p></li><li><p><code>input_Grid::Type{&lt;:SpeedyWeather.RingGrids.AbstractGrid}</code></p></li><li><p><code>as_matrix::Bool</code>: [OPTION] sort grid points into a matrix (interpolation-free), for OctahedralClenshawGrid, OctaHEALPixGrid only</p></li><li><p><code>quadrant_rotation::NTuple{4, Int64}</code></p></li><li><p><code>matrix_quadrant::NTuple{4, Tuple{Int64, Int64}}</code></p></li><li><p><code>output_Grid::Type{&lt;:SpeedyWeather.RingGrids.AbstractFullGrid}</code>: [OPTION] the grid used for output, full grids only</p></li><li><p><code>nlat_half::Int64</code>: [OPTION] the resolution of the output grid, default: same nlat_half as in the dynamical core</p></li><li><p><code>nlon::Int64</code></p></li><li><p><code>nlat::Int64</code></p></li><li><p><code>npoints::Int64</code></p></li><li><p><code>nlev::Int64</code></p></li><li><p><code>interpolator::SpeedyWeather.RingGrids.AbstractInterpolator</code></p></li><li><p><code>u::Matrix{NF} where NF&lt;:Union{Float32, Float64}</code></p></li><li><p><code>v::Matrix{NF} where NF&lt;:Union{Float32, Float64}</code></p></li><li><p><code>vor::Matrix{NF} where NF&lt;:Union{Float32, Float64}</code></p></li><li><p><code>div::Matrix{NF} where NF&lt;:Union{Float32, Float64}</code></p></li><li><p><code>temp::Matrix{NF} where NF&lt;:Union{Float32, Float64}</code></p></li><li><p><code>pres::Matrix{NF} where NF&lt;:Union{Float32, Float64}</code></p></li><li><p><code>humid::Matrix{NF} where NF&lt;:Union{Float32, Float64}</code></p></li><li><p><code>precip_cond::Matrix{NF} where NF&lt;:Union{Float32, Float64}</code></p></li><li><p><code>precip_conv::Matrix{NF} where NF&lt;:Union{Float32, Float64}</code></p></li><li><p><code>cloud::Matrix{NF} where NF&lt;:Union{Float32, Float64}</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/output.jl#L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Particle" href="#SpeedyWeather.Particle"><code>SpeedyWeather.Particle</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Particle with location lon (longitude), lat (latitude) and σ (vertical coordinate). Longitude is assumed to be in [0,360˚E), latitude in [-90˚,90˚N] and σ in [0,1] but not strictly enforced at creation, see <code>mod(::Particle)</code> and <code>ismod(::Particle)</code>. A particle is either active or inactive, determined by the Boolean in it&#39;s 2nd type parameter. By default, a particle is active, of number format DEFAULT_NF and at 0˚N, 0˚E, σ=0.</p><ul><li><p><code>lon::AbstractFloat</code>: longitude in [0,360˚]</p></li><li><p><code>lat::AbstractFloat</code>: latitude [-90˚,90˚]</p></li><li><p><code>σ::AbstractFloat</code>: vertical sigma coordinate [0 (top) to 1 (surface)]</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/particles.jl#L5-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ParticleTracker" href="#SpeedyWeather.ParticleTracker"><code>SpeedyWeather.ParticleTracker</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A ParticleTracker is implemented as a callback to output the trajectories of particles from particle advection. To be added like</p><pre><code class="nohighlight hljs">add!(model.callbacks, ParticleTracker(spectral_grid; kwargs...))</code></pre><p>Output done via netCDF. Fields and options are</p><ul><li><p><code>schedule::Schedule</code>: [OPTION] when to schedule particle tracking</p></li><li><p><code>file_name::String</code>: [OPTION] File name for netCDF file</p></li><li><p><code>compression_level::Int64</code>: [OPTION] lossless compression level; 1=low but fast, 9=high but slow</p></li><li><p><code>shuffle::Bool</code>: [OPTION] shuffle/bittranspose filter for compression</p></li><li><p><code>keepbits::Int64</code>: [OPTION] mantissa bits to keep, (14, 15, 16) means at least (2km, 1km, 500m) accurate locations</p></li><li><p><code>n_particles::Int64</code>: Number of particles to track</p></li><li><p><code>netcdf_file::Union{Nothing, NCDatasets.NCDataset}</code>: The netcdf file to be written into, will be created at initialization</p></li><li><p><code>lon::Vector</code></p></li><li><p><code>lat::Vector</code></p></li><li><p><code>σ::Vector</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/particle_tracker.jl#L3-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.PrimitiveDryModel" href="#SpeedyWeather.PrimitiveDryModel"><code>SpeedyWeather.PrimitiveDryModel</code></a> — <span class="docstring-category">Type</span></header><section><div><p>The PrimitiveDryModel struct holds all other structs that contain precalculated constants, whether scalars or arrays that do not change throughout model integration.</p><ul><li><p><code>spectral_grid::SpectralGrid</code></p></li><li><p><code>geometry::SpeedyWeather.AbstractGeometry</code></p></li><li><p><code>dynamics::Bool</code></p></li><li><p><code>planet::SpeedyWeather.AbstractPlanet</code></p></li><li><p><code>atmosphere::SpeedyWeather.AbstractAtmosphere</code></p></li><li><p><code>coriolis::SpeedyWeather.AbstractCoriolis</code></p></li><li><p><code>geopotential::SpeedyWeather.AbstractGeopotential</code></p></li><li><p><code>adiabatic_conversion::SpeedyWeather.AbstractAdiabaticConversion</code></p></li><li><p><code>particle_advection::SpeedyWeather.AbstractParticleAdvection</code></p></li><li><p><code>initial_conditions::SpeedyWeather.AbstractInitialConditions</code></p></li><li><p><code>orography::SpeedyWeather.AbstractOrography</code></p></li><li><p><code>land_sea_mask::SpeedyWeather.AbstractLandSeaMask</code></p></li><li><p><code>ocean::SpeedyWeather.AbstractOcean</code></p></li><li><p><code>land::SpeedyWeather.AbstractLand</code></p></li><li><p><code>solar_zenith::SpeedyWeather.AbstractZenith</code></p></li><li><p><code>physics::Bool</code></p></li><li><p><code>boundary_layer_drag::SpeedyWeather.AbstractBoundaryLayer</code></p></li><li><p><code>temperature_relaxation::SpeedyWeather.AbstractTemperatureRelaxation</code></p></li><li><p><code>static_energy_diffusion::SpeedyWeather.AbstractVerticalDiffusion</code></p></li><li><p><code>surface_thermodynamics::SpeedyWeather.AbstractSurfaceThermodynamics</code></p></li><li><p><code>surface_wind::SpeedyWeather.AbstractSurfaceWind</code></p></li><li><p><code>surface_heat_flux::SpeedyWeather.AbstractSurfaceHeat</code></p></li><li><p><code>convection::SpeedyWeather.AbstractConvection</code></p></li><li><p><code>shortwave_radiation::SpeedyWeather.AbstractShortwave</code></p></li><li><p><code>longwave_radiation::SpeedyWeather.AbstractLongwave</code></p></li><li><p><code>device_setup::SpeedyWeather.DeviceSetup</code></p></li><li><p><code>time_stepping::SpeedyWeather.AbstractTimeStepper</code></p></li><li><p><code>spectral_transform::SpectralTransform</code></p></li><li><p><code>implicit::SpeedyWeather.AbstractImplicit</code></p></li><li><p><code>horizontal_diffusion::SpeedyWeather.AbstractHorizontalDiffusion</code></p></li><li><p><code>vertical_advection::SpeedyWeather.AbstractVerticalAdvection</code></p></li><li><p><code>output::SpeedyWeather.AbstractOutputWriter</code></p></li><li><p><code>callbacks::Dict{Symbol, SpeedyWeather.AbstractCallback}</code></p></li><li><p><code>feedback::SpeedyWeather.AbstractFeedback</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/models/primitive_dry.jl#L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.PrimitiveWetModel" href="#SpeedyWeather.PrimitiveWetModel"><code>SpeedyWeather.PrimitiveWetModel</code></a> — <span class="docstring-category">Type</span></header><section><div><p>The PrimitiveDryModel struct holds all other structs that contain precalculated constants, whether scalars or arrays that do not change throughout model integration.</p><ul><li><p><code>spectral_grid::SpectralGrid</code></p></li><li><p><code>geometry::SpeedyWeather.AbstractGeometry</code></p></li><li><p><code>dynamics::Bool</code></p></li><li><p><code>planet::SpeedyWeather.AbstractPlanet</code></p></li><li><p><code>atmosphere::SpeedyWeather.AbstractAtmosphere</code></p></li><li><p><code>coriolis::SpeedyWeather.AbstractCoriolis</code></p></li><li><p><code>geopotential::SpeedyWeather.AbstractGeopotential</code></p></li><li><p><code>adiabatic_conversion::SpeedyWeather.AbstractAdiabaticConversion</code></p></li><li><p><code>particle_advection::SpeedyWeather.AbstractParticleAdvection</code></p></li><li><p><code>initial_conditions::SpeedyWeather.AbstractInitialConditions</code></p></li><li><p><code>orography::SpeedyWeather.AbstractOrography</code></p></li><li><p><code>land_sea_mask::SpeedyWeather.AbstractLandSeaMask</code></p></li><li><p><code>ocean::SpeedyWeather.AbstractOcean</code></p></li><li><p><code>land::SpeedyWeather.AbstractLand</code></p></li><li><p><code>solar_zenith::SpeedyWeather.AbstractZenith</code></p></li><li><p><code>soil::SpeedyWeather.AbstractSoil</code></p></li><li><p><code>vegetation::SpeedyWeather.AbstractVegetation</code></p></li><li><p><code>physics::Bool</code></p></li><li><p><code>clausius_clapeyron::SpeedyWeather.AbstractClausiusClapeyron</code></p></li><li><p><code>boundary_layer_drag::SpeedyWeather.AbstractBoundaryLayer</code></p></li><li><p><code>temperature_relaxation::SpeedyWeather.AbstractTemperatureRelaxation</code></p></li><li><p><code>static_energy_diffusion::SpeedyWeather.AbstractVerticalDiffusion</code></p></li><li><p><code>humidity_diffusion::SpeedyWeather.AbstractVerticalDiffusion</code></p></li><li><p><code>surface_thermodynamics::SpeedyWeather.AbstractSurfaceThermodynamics</code></p></li><li><p><code>surface_wind::SpeedyWeather.AbstractSurfaceWind</code></p></li><li><p><code>surface_heat_flux::SpeedyWeather.AbstractSurfaceHeat</code></p></li><li><p><code>evaporation::SpeedyWeather.AbstractEvaporation</code></p></li><li><p><code>large_scale_condensation::SpeedyWeather.AbstractCondensation</code></p></li><li><p><code>convection::SpeedyWeather.AbstractConvection</code></p></li><li><p><code>shortwave_radiation::SpeedyWeather.AbstractShortwave</code></p></li><li><p><code>longwave_radiation::SpeedyWeather.AbstractLongwave</code></p></li><li><p><code>device_setup::SpeedyWeather.DeviceSetup</code></p></li><li><p><code>time_stepping::SpeedyWeather.AbstractTimeStepper</code></p></li><li><p><code>spectral_transform::SpectralTransform</code></p></li><li><p><code>implicit::SpeedyWeather.AbstractImplicit</code></p></li><li><p><code>horizontal_diffusion::SpeedyWeather.AbstractHorizontalDiffusion</code></p></li><li><p><code>vertical_advection::SpeedyWeather.AbstractVerticalAdvection</code></p></li><li><p><code>hole_filling::SpeedyWeather.AbstractHoleFilling</code></p></li><li><p><code>output::SpeedyWeather.AbstractOutputWriter</code></p></li><li><p><code>callbacks::Dict{Symbol, SpeedyWeather.AbstractCallback}</code></p></li><li><p><code>feedback::SpeedyWeather.AbstractFeedback</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/models/primitive_wet.jl#L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.PrognosticLayerTimesteps" href="#SpeedyWeather.PrognosticLayerTimesteps"><code>SpeedyWeather.PrognosticLayerTimesteps</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Collect the n time steps of PrognosticVariablesLayer of an n-step time integration (leapfrog=2) into a single struct.</p><ul><li><code>timesteps::Array{PrognosticVariablesLayer{NF}, 1} where NF&lt;:AbstractFloat</code></li></ul><p>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/prognostic_variables.jl#L35-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.PrognosticSurfaceTimesteps" href="#SpeedyWeather.PrognosticSurfaceTimesteps"><code>SpeedyWeather.PrognosticSurfaceTimesteps</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Collect the n time steps of PrognosticVariablesSurface of an n-step time integration (leapfrog=2) into a single struct.</p><ul><li><code>timesteps::Array{SpeedyWeather.PrognosticVariablesSurface{NF}, 1} where NF&lt;:AbstractFloat</code></li></ul><p>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/prognostic_variables.jl#L111-L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.PrognosticVariablesLayer" href="#SpeedyWeather.PrognosticVariablesLayer"><code>SpeedyWeather.PrognosticVariablesLayer</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A layer of the prognostic variables in spectral space.</p><ul><li><p><code>trunc::Int64</code>: Spectral resolution as max degree of spherical harmonics</p></li><li><p><code>vor::LowerTriangularMatrix{Complex{NF}} where NF&lt;:AbstractFloat</code>: Vorticity of horizontal wind field [1/s]</p></li><li><p><code>div::LowerTriangularMatrix{Complex{NF}} where NF&lt;:AbstractFloat</code>: Divergence of horizontal wind field [1/s]</p></li><li><p><code>temp::LowerTriangularMatrix{Complex{NF}} where NF&lt;:AbstractFloat</code>: Absolute temperature [K]</p></li><li><p><code>humid::LowerTriangularMatrix{Complex{NF}} where NF&lt;:AbstractFloat</code>: Specific humidity [kg/kg]</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/prognostic_variables.jl#L6-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.PrognosticVariablesSurface" href="#SpeedyWeather.PrognosticVariablesSurface"><code>SpeedyWeather.PrognosticVariablesSurface</code></a> — <span class="docstring-category">Type</span></header><section><div><p>The spectral and gridded prognostic variables at the surface.</p><ul><li><p><code>trunc::Int64</code>: Spectral resolution as max degree of spherical harmonics</p></li><li><p><code>pres::LowerTriangularMatrix{Complex{NF}} where NF&lt;:AbstractFloat</code>: log of surface pressure [log(Pa)] for PrimitiveEquation, interface displacement [m] for ShallowWaterModel</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/prognostic_variables.jl#L47-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.RandomWaves" href="#SpeedyWeather.RandomWaves"><code>SpeedyWeather.RandomWaves</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Parameters for random initial conditions for the interface displacement η in the shallow water equations.</p><ul><li><p><code>A::Float64</code></p></li><li><p><code>lmin::Int64</code></p></li><li><p><code>lmax::Int64</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/initial_conditions.jl#L530-L533">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Schedule" href="#SpeedyWeather.Schedule"><code>SpeedyWeather.Schedule</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A schedule for callbacks, to execute them periodically after a given period has passed (first timestep excluded) or on/after specific times (initial time excluded). For two consecutive time steps i, i+1, an event is scheduled at i+1 when it occurs in (i,i+1]. Similarly, a periodic schedule of period p will be executed at start+p, but p is rounded to match the multiple of the model timestep. Periodic schedules and event schedules can be combined, executing at both. A Schedule is supposed to be added into callbacks as fields</p><pre><code class="nohighlight hljs">Base.@kwdef struct MyCallback
    schedule::Schedule = Schedule(every=Day(1))
    other_fields
end</code></pre><p>see also initialize!(::Schedule,::Clock) and isscheduled(::Schedule,::Clock). Fields</p><ul><li><p><code>every::Second</code>: [OPTION] Execute every time period, first timestep excluded. Default=never.</p></li><li><p><code>times::Vector{DateTime}</code>: [OPTION] Events scheduled at times</p></li><li><p><code>schedule::BitVector</code>: Actual schedule, true=execute this timestep, false=don&#39;t</p></li><li><p><code>steps::Int64</code>: Number of scheduled executions</p></li><li><p><code>counter::Int64</code>: Count up the number of executions</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/schedule.jl#L5-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Schedule-Tuple{Vararg{DateTime}}" href="#SpeedyWeather.Schedule-Tuple{Vararg{DateTime}}"><code>SpeedyWeather.Schedule</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Schedule(times::DateTime...) -&gt; Schedule
</code></pre><p>A Schedule based on DateTime arguments, For two consecutive time steps i, i+1, an event is scheduled at i+1 when it occurs in (i,i+1].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/schedule.jl#L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ShallowWaterModel" href="#SpeedyWeather.ShallowWaterModel"><code>SpeedyWeather.ShallowWaterModel</code></a> — <span class="docstring-category">Type</span></header><section><div><p>The ShallowWaterModel contains all model components needed for the simulation of the shallow water equations. To be constructed like</p><pre><code class="nohighlight hljs">model = ShallowWaterModel(; spectral_grid, kwargs...)</code></pre><p>with <code>spectral_grid::SpectralGrid</code> used to initalize all non-default components passed on as keyword arguments, e.g. <code>planet=Earth(spectral_grid)</code>. Fields, representing model components, are</p><ul><li><p><code>spectral_grid::SpectralGrid</code></p></li><li><p><code>device_setup::SpeedyWeather.DeviceSetup</code></p></li><li><p><code>planet::SpeedyWeather.AbstractPlanet</code></p></li><li><p><code>atmosphere::SpeedyWeather.AbstractAtmosphere</code></p></li><li><p><code>coriolis::SpeedyWeather.AbstractCoriolis</code></p></li><li><p><code>orography::SpeedyWeather.AbstractOrography</code></p></li><li><p><code>forcing::SpeedyWeather.AbstractForcing</code></p></li><li><p><code>drag::SpeedyWeather.AbstractDrag</code></p></li><li><p><code>particle_advection::SpeedyWeather.AbstractParticleAdvection</code></p></li><li><p><code>initial_conditions::SpeedyWeather.AbstractInitialConditions</code></p></li><li><p><code>time_stepping::SpeedyWeather.AbstractTimeStepper</code></p></li><li><p><code>spectral_transform::SpectralTransform</code></p></li><li><p><code>implicit::SpeedyWeather.AbstractImplicit</code></p></li><li><p><code>horizontal_diffusion::SpeedyWeather.AbstractHorizontalDiffusion</code></p></li><li><p><code>geometry::SpeedyWeather.AbstractGeometry</code></p></li><li><p><code>output::SpeedyWeather.AbstractOutputWriter</code></p></li><li><p><code>callbacks::Dict{Symbol, SpeedyWeather.AbstractCallback}</code></p></li><li><p><code>feedback::SpeedyWeather.AbstractFeedback</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/models/shallow_water.jl#L3-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SimplifiedBettsMiller" href="#SpeedyWeather.SimplifiedBettsMiller"><code>SpeedyWeather.SimplifiedBettsMiller</code></a> — <span class="docstring-category">Type</span></header><section><div><p>The simplified Betts-Miller convection scheme from Frierson, 2007, https://doi.org/10.1175/JAS3935.1. This implements the qref-formulation in their paper. Fields and options are</p><ul><li><p><code>nlev::Int64</code>: number of vertical layers/levels</p></li><li><p><code>time_scale::Second</code>: [OPTION] Relaxation time for profile adjustment</p></li><li><p><code>relative_humidity::Any</code>: [OPTION] Relative humidity for reference profile</p></li><li><p><code>temp_ref_profile::Vector</code>: temperature [K] reference profile to adjust to</p></li><li><p><code>humid_ref_profile::Vector</code>: specific humidity [kg/kg] profile to adjust to</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/convection.jl#L10-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Simulation" href="#SpeedyWeather.Simulation"><code>SpeedyWeather.Simulation</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Simulation is a container struct to be used with <code>run!(::Simulation)</code>. It contains</p><ul><li><p><code>prognostic_variables::PrognosticVariables</code>: define the current state of the model</p></li><li><p><code>diagnostic_variables::DiagnosticVariables</code>: contain the tendencies and auxiliary arrays to compute them</p></li><li><p><code>model::ModelSetup</code>: all parameters, constant at runtime</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/models/simulation.jl#L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SinSolarDeclination" href="#SpeedyWeather.SinSolarDeclination"><code>SpeedyWeather.SinSolarDeclination</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Coefficients to calculate the solar declination angle δ [radians] based on a simple sine function, with Earth&#39;s axial tilt as amplitude, equinox as phase shift.</p><ul><li><p><code>axial_tilt::Any</code></p></li><li><p><code>equinox::DateTime</code></p></li><li><p><code>length_of_year::Second</code></p></li><li><p><code>length_of_day::Second</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/zenith.jl#L5-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SinSolarDeclination-Tuple{NF} where NF" href="#SpeedyWeather.SinSolarDeclination-Tuple{NF} where NF"><code>SpeedyWeather.SinSolarDeclination</code></a> — <span class="docstring-category">Method</span></header><section><div><p>SinSolarDeclination functor, computing the solar declination angle of angular fraction of year g [radians] using the coefficients of the SinSolarDeclination struct.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/zenith.jl#L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SinSolarDeclination-Tuple{SpectralGrid, SpeedyWeather.AbstractPlanet}" href="#SpeedyWeather.SinSolarDeclination-Tuple{SpectralGrid, SpeedyWeather.AbstractPlanet}"><code>SpeedyWeather.SinSolarDeclination</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Generator function using the planet&#39;s orbital parameters to adapt the solar declination calculation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/zenith.jl#L18-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SinSolarDeclination-Tuple{SpectralGrid}" href="#SpeedyWeather.SinSolarDeclination-Tuple{SpectralGrid}"><code>SpeedyWeather.SinSolarDeclination</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Generator function pulling the number format NF from a SpectralGrid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/zenith.jl#L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SolarDeclination" href="#SpeedyWeather.SolarDeclination"><code>SpeedyWeather.SolarDeclination</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Coefficients to calculate the solar declination angle δ from</p><pre><code class="nohighlight hljs">δ = 0.006918    - 0.399912*cos(g)  + 0.070257*sin(g)
                - 0.006758*cos(2g) + 0.000907*sin(2g)
                - 0.002697*cos(3g) + 0.001480*sin(3g)</code></pre><p>with g the angular fraction of the year in radians. Following Spencer 1971, Fourier series representation of the position of the sun. Search 2(5):172.</p><ul><li><p><code>a::AbstractFloat</code></p></li><li><p><code>s1::AbstractFloat</code></p></li><li><p><code>c1::AbstractFloat</code></p></li><li><p><code>s2::AbstractFloat</code></p></li><li><p><code>c2::AbstractFloat</code></p></li><li><p><code>s3::AbstractFloat</code></p></li><li><p><code>c3::AbstractFloat</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/zenith.jl#L36-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SolarDeclination-Tuple{Any}" href="#SpeedyWeather.SolarDeclination-Tuple{Any}"><code>SpeedyWeather.SolarDeclination</code></a> — <span class="docstring-category">Method</span></header><section><div><p>SolarDeclination functor, computing the solar declination angle of angular fraction of year g [radians] using the coefficients of the SolarDeclination struct.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/zenith.jl#L58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SolarDeclination-Tuple{SpectralGrid}" href="#SpeedyWeather.SolarDeclination-Tuple{SpectralGrid}"><code>SpeedyWeather.SolarDeclination</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Generator function pulling the number format NF from a SpectralGrid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/zenith.jl#L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SolarTimeCorrection" href="#SpeedyWeather.SolarTimeCorrection"><code>SpeedyWeather.SolarTimeCorrection</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Coefficients for the solar time correction (also called Equation of time) which adjusts the solar hour to an oscillation of sunrise/set by about +-16min throughout the year.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/zenith.jl#L77-L80">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SolarTimeCorrection-Tuple{Any}" href="#SpeedyWeather.SolarTimeCorrection-Tuple{Any}"><code>SpeedyWeather.SolarTimeCorrection</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Functor that returns the time correction for a angular fraction of the year g [radians], so that g=0 for Jan-01 and g=2π for Dec-31.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/zenith.jl#L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SolarZenith" href="#SpeedyWeather.SolarZenith"><code>SpeedyWeather.SolarZenith</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Solar zenith angle varying with daily and seasonal cycle.</p><ul><li><p><code>nlat_half::Int64</code></p></li><li><p><code>length_of_day::Second</code></p></li><li><p><code>length_of_year::Second</code></p></li><li><p><code>equation_of_time::Bool</code></p></li><li><p><code>seasonal_cycle::Bool</code></p></li><li><p><code>solar_declination::SpeedyWeather.SinSolarDeclination{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>time_correction::SpeedyWeather.SolarTimeCorrection</code></p></li><li><p><code>initial_time::Base.RefValue{DateTime}</code></p></li><li><p><code>cos_zenith::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/zenith.jl#L140-L142">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SolarZenithSeason" href="#SpeedyWeather.SolarZenithSeason"><code>SpeedyWeather.SolarZenithSeason</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Solar zenith angle varying with seasonal cycle only.</p><ul><li><p><code>nlat_half::Int64</code></p></li><li><p><code>length_of_day::Second</code></p></li><li><p><code>length_of_year::Second</code></p></li><li><p><code>seasonal_cycle::Bool</code></p></li><li><p><code>solar_declination::SpeedyWeather.SinSolarDeclination{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>initial_time::Base.RefValue{DateTime}</code></p></li><li><p><code>cos_zenith::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/zenith.jl#L243-L245">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpectralGrid" href="#SpeedyWeather.SpectralGrid"><code>SpeedyWeather.SpectralGrid</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Defines the horizontal spectral resolution and corresponding grid and the vertical coordinate for SpeedyWeather.jl. Options are</p><ul><li><p><code>NF::Type{&lt;:AbstractFloat}</code>: [OPTION] number format used throughout the model</p></li><li><p><code>trunc::Int64</code>: [OPTION] horizontal resolution as the maximum degree of spherical harmonics</p></li><li><p><code>Grid::Type{&lt;:SpeedyWeather.RingGrids.AbstractGrid}</code>: [OPTION] horizontal grid used for calculations in grid-point space</p></li><li><p><code>dealiasing::Float64</code>: [OPTION] how to match spectral with grid resolution: dealiasing factor, 1=linear, 2=quadratic, 3=cubic grid</p></li><li><p><code>radius::Float64</code>: [OPTION] radius of the sphere [m]</p></li><li><p><code>n_particles::Int64</code>: [OPTION] number of particles for particle advection [1]</p></li><li><p><code>nlat_half::Int64</code>: number of latitude rings on one hemisphere (Equator incl)</p></li><li><p><code>nlat::Int64</code>: number of latitude rings on both hemispheres</p></li><li><p><code>npoints::Int64</code>: total number of grid points in the horizontal</p></li><li><p><code>nlev::Int64</code>: [OPTION] number of vertical levels</p></li><li><p><code>vertical_coordinates::SpeedyWeather.VerticalCoordinates</code>: [OPTION] coordinates used to discretize the vertical</p></li></ul><p><code>nlat_half</code> and <code>npoints</code> should not be chosen but are derived from <code>trunc</code>, <code>Grid</code> and <code>dealiasing</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/spectral_grid.jl#L13-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpectralVariable3D" href="#SpeedyWeather.SpectralVariable3D"><code>SpeedyWeather.SpectralVariable3D</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A horizontal LowerTriangularMatrix for spherical harmonic coefficients with a third dimension (time or vertical). Uses either (1) two indices ij, k with ij being the unravelled single index for the LowerTriangularMatrix (skipping the zeros in the upper triangle, diagonal excl) and k the vertical layer or the timestep. Or (2) three indices i, j, k with i, j for the (1-indexed) spherical harmonic of degree i and order j. To be generated and indexed like</p><pre><code class="nohighlight hljs">m, n = 4, 4         # size of LowerTriangularMatrix
nlayer = 8          # number of vertical layers (or timesteps)
S = zeros(SpectralVariable3D{Float32}, m, n, nlayer)
S[1, 1, 3]          # i=j=1 (1-indexed) harmonic on layer 3
S[2, 3]             # single-indexed harmonic i=2, j=1 (1-indexed) harmonic on layer 3</code></pre><p>Fields are</p><ul><li><p><code>data::Array{LowerTriangularMatrix{NF}, 1} where NF</code></p></li><li><p><code>m::Int64</code></p></li><li><p><code>n::Int64</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/variables_3D_4D.jl#L84-L99">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpectralVariable4D" href="#SpeedyWeather.SpectralVariable4D"><code>SpeedyWeather.SpectralVariable4D</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A horizontal LowerTriangularMatrix for spherical harmonic coefficients with a third and forth dimension (vertical and time). Uses either (1) three indices ij, k, t with ij being the unravelled single index for the LowerTriangularMatrix (skipping the zeros in the upper triangle) and k the vertical layer and t the timestep. Or (2) four indices l, m, k, t with l, m for the (1-indexed) spherical harmonic of degree l and order m. To be generated and indexed like</p><pre><code class="nohighlight hljs">m, n = 4, 4         # size of LowerTriangularMatrix
nlayer = 8          # number of vertical layers (or timesteps)
ntimesteps = 2      # number of timesteps
S = zeros(SpectralVariable3D{Float32}, m, n, nlayer, ntimesteps)
S[1, 1, 3, 1]       # i=j=1 (1-indexed) harmonic on layer 3 at timestep 1
S[2, 3, 1]          # single-indexed harmonic ij=2 =&gt; i=2, j=1 (1-indexed) harmonic on layer 3, timestep 1</code></pre><p>Fields are</p><ul><li><p><code>data::Array{LowerTriangularMatrix{NF}, 2} where NF</code></p></li><li><p><code>m::Int64</code></p></li><li><p><code>n::Int64</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/variables_3D_4D.jl#L137-L153">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.SpectralTransform-Tuple{SpectralGrid}" href="#SpeedyWeather.SpeedyTransforms.SpectralTransform-Tuple{SpectralGrid}"><code>SpeedyWeather.SpeedyTransforms.SpectralTransform</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">SpectralTransform(
    spectral_grid::SpectralGrid;
    recompute_legendre,
    one_more_degree,
    kwargs...
) -&gt; SpectralTransform
</code></pre><p>Generator function for a SpectralTransform struct pulling in parameters from a SpectralGrid struct.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/spectral_grid.jl#L92">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.StartFromFile" href="#SpeedyWeather.StartFromFile"><code>SpeedyWeather.StartFromFile</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Restart from a previous SpeedyWeather.jl simulation via the restart file restart.jld2 Applies interpolation in the horizontal but not in the vertical. restart.jld2 is identified by</p><ul><li><p><code>path::String</code>: path for restart file</p></li><li><p><code>id::Union{Int64, String}</code>: <code>run_id</code> of restart file in <code>run_????/restart.jld2</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/initial_conditions.jl#L369-L373">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.StartWithRandomVorticity" href="#SpeedyWeather.StartWithRandomVorticity"><code>SpeedyWeather.StartWithRandomVorticity</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Start with random vorticity as initial conditions</p><ul><li><p><code>power::Float64</code>: Power of the spectral distribution k^power</p></li><li><p><code>amplitude::Float64</code>: (approximate) amplitude in [1/s], used as standard deviation of spherical harmonic coefficients</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/initial_conditions.jl#L50-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.StaticEnergyDiffusion" href="#SpeedyWeather.StaticEnergyDiffusion"><code>SpeedyWeather.StaticEnergyDiffusion</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Diffusion of dry static energy: A relaxation towards a reference gradient of static energy wrt to geopotential, see Fortran SPEEDY documentation.</p><ul><li><p><code>time_scale::Second</code>: time scale for strength</p></li><li><p><code>static_energy_lapse_rate::AbstractFloat</code>: [1] ∂SE/∂Φ, vertical gradient of static energy SE with geopotential Φ</p></li><li><p><code>Fstar::Base.RefValue{NF} where NF&lt;:AbstractFloat</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/vertical_diffusion.jl#L25-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SurfaceEvaporation" href="#SpeedyWeather.SurfaceEvaporation"><code>SpeedyWeather.SurfaceEvaporation</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Surface evaporation following a bulk formula with wind from model.surface_wind </p><ul><li><p><code>use_boundary_layer_drag::Bool</code>: Use column.boundary<em>layer</em>drag coefficient</p></li><li><p><code>moisture_exchange_land::AbstractFloat</code>: Otherwise, use the following drag coefficient for evaporation over land</p></li><li><p><code>moisture_exchange_sea::AbstractFloat</code>: Or drag coefficient for evaporation over sea</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/surface_fluxes.jl#L178-L180">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SurfaceVariables" href="#SpeedyWeather.SurfaceVariables"><code>SpeedyWeather.SurfaceVariables</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Diagnostic variables for the surface layer.</p><ul><li><p><code>nlat_half::Int64</code></p></li><li><p><code>trunc::Int64</code></p></li><li><p><code>npoints::Int64</code></p></li><li><p><code>pres_grid::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>pres_tend::LowerTriangularMatrix{Complex{NF}} where NF&lt;:AbstractFloat</code></p></li><li><p><code>pres_tend_grid::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>∇lnp_x::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>∇lnp_y::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>u_mean_grid::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>v_mean_grid::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>div_mean_grid::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>div_mean::LowerTriangularMatrix{Complex{NF}} where NF&lt;:AbstractFloat</code></p></li><li><p><code>precip_large_scale::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>precip_convection::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>cloud_top::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>soil_moisture_availability::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/diagnostic_variables.jl#L118-L120">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Tendencies" href="#SpeedyWeather.Tendencies"><code>SpeedyWeather.Tendencies</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Tendencies of the prognostic spectral variables for a given layer.</p><ul><li><p><code>nlat_half::Int64</code></p></li><li><p><code>trunc::Int64</code></p></li><li><p><code>vor_tend::LowerTriangularMatrix{Complex{NF}} where NF&lt;:AbstractFloat</code></p></li><li><p><code>div_tend::LowerTriangularMatrix{Complex{NF}} where NF&lt;:AbstractFloat</code></p></li><li><p><code>temp_tend::LowerTriangularMatrix{Complex{NF}} where NF&lt;:AbstractFloat</code></p></li><li><p><code>humid_tend::LowerTriangularMatrix{Complex{NF}} where NF&lt;:AbstractFloat</code></p></li><li><p><code>u_tend::LowerTriangularMatrix{Complex{NF}} where NF&lt;:AbstractFloat</code></p></li><li><p><code>v_tend::LowerTriangularMatrix{Complex{NF}} where NF&lt;:AbstractFloat</code></p></li><li><p><code>u_tend_grid::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>v_tend_grid::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>temp_tend_grid::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>humid_tend_grid::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/diagnostic_variables.jl#L3-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.TetensEquation" href="#SpeedyWeather.TetensEquation"><code>SpeedyWeather.TetensEquation</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Parameters for computing saturation vapour pressure of water using the Tetens&#39; equation,</p><pre><code class="nohighlight hljs">eᵢ(T) = e₀ * exp(Cᵢ * (T - T₀) / (T + Tᵢ)),</code></pre><p>where T is in Kelvin and i = 1, 2 for saturation above and below freezing, respectively. From Tetens (1930), and Murray (1967) for below freezing.</p><ul><li><p><code>e₀::AbstractFloat</code>: Saturation water vapour pressure at 0°C [Pa]</p></li><li><p><code>T₀::AbstractFloat</code>: 0°C in Kelvin</p></li><li><p><code>T₁::AbstractFloat</code>: Tetens denominator (water) [˚C]</p></li><li><p><code>T₂::AbstractFloat</code>: Tetens denominator following Murray (1967, below freezing) [˚C]</p></li><li><p><code>C₁::AbstractFloat</code>: Tetens numerator scaling [1], above freezing</p></li><li><p><code>C₂::AbstractFloat</code>: Tetens numerator scaling [1], below freezing</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/thermodynamics.jl#L203-L210">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.TetensEquation-Tuple{NF} where NF" href="#SpeedyWeather.TetensEquation-Tuple{NF} where NF"><code>SpeedyWeather.TetensEquation</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Functor: Saturation water vapour pressure as a function of temperature using the Tetens equation,</p><pre><code class="nohighlight hljs">eᵢ(T) = e₀ * exp(Cᵢ * (T - T₀) / (T - Tᵢ)),</code></pre><p>where T is in Kelvin and i = 1, 2 for saturation above and below freezing, respectively.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/thermodynamics.jl#L231">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ZonalJet" href="#SpeedyWeather.ZonalJet"><code>SpeedyWeather.ZonalJet</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A struct that contains all parameters for the Galewsky et al, 2004 zonal jet intitial conditions for the shallow water model. Default values as in Galewsky.</p><ul><li><p><code>latitude::Float64</code>: jet latitude [˚N]</p></li><li><p><code>width::Float64</code>: jet width [˚], default ≈ 19.29˚</p></li><li><p><code>umax::Float64</code>: jet maximum velocity [m/s]</p></li><li><p><code>perturb_lat::Float64</code>: perturbation latitude [˚N], position in jet by default</p></li><li><p><code>perturb_lon::Float64</code>: perturbation longitude [˚E]</p></li><li><p><code>perturb_xwidth::Float64</code>: perturbation zonal extent [˚], default ≈ 19.1˚</p></li><li><p><code>perturb_ywidth::Float64</code>: perturbation meridinoal extent [˚], default ≈ 3.8˚</p></li><li><p><code>perturb_height::Float64</code>: perturbation amplitude [m]</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/initial_conditions.jl#L84-L87">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ZonalRidge" href="#SpeedyWeather.ZonalRidge"><code>SpeedyWeather.ZonalRidge</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Zonal ridge orography after Jablonowski and Williamson, 2006.</p><ul><li><p><code>η₀::Float64</code>: conversion from σ to Jablonowski&#39;s ηᵥ-coordinates</p></li><li><p><code>u₀::Float64</code>: max amplitude of zonal wind [m/s] that scales orography height</p></li><li><p><code>orography::SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat</code></p></li><li><p><code>geopot_surf::LowerTriangularMatrix{Complex{NF}} where NF&lt;:AbstractFloat</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/orography.jl#L29-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ZonalRidge-Tuple{SpectralGrid}" href="#SpeedyWeather.ZonalRidge-Tuple{SpectralGrid}"><code>SpeedyWeather.ZonalRidge</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ZonalRidge(
    spectral_grid::SpectralGrid;
    kwargs...
) -&gt; ZonalRidge
</code></pre><p>Generator function pulling the resolution information from <code>spectral_grid</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/orography.jl#L47">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ZonalWind" href="#SpeedyWeather.ZonalWind"><code>SpeedyWeather.ZonalWind</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Create a struct that contains all parameters for the Jablonowski and Williamson, 2006 intitial conditions for the primitive equation model. Default values as in Jablonowski.</p><ul><li><p><code>η₀::Float64</code>: conversion from σ to Jablonowski&#39;s ηᵥ-coordinates</p></li><li><p><code>u₀::Float64</code>: max amplitude of zonal wind [m/s]</p></li><li><p><code>perturb_lat::Float64</code>: perturbation centred at [˚N]</p></li><li><p><code>perturb_lon::Float64</code>: perturbation centred at [˚E]</p></li><li><p><code>perturb_uₚ::Float64</code>: perturbation strength [m/s]</p></li><li><p><code>perturb_radius::Float64</code>: radius of Gaussian perturbation in units of Earth&#39;s radius [1]</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/initial_conditions.jl#L197">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.copy!-Tuple{PrognosticVariables, PrognosticVariables}" href="#Base.copy!-Tuple{PrognosticVariables, PrognosticVariables}"><code>Base.copy!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">copy!(progn_new::PrognosticVariables, progn_old::PrognosticVariables)</code></pre><p>Copies entries of <code>progn_old</code> into <code>progn_new</code>. Only copies those variables that are present  in the model of both <code>progn_new</code> and <code>progn_old</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/prognostic_variables.jl#L173-L178">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.mod-Tuple{P} where P&lt;:Particle" href="#Base.mod-Tuple{P} where P&lt;:Particle"><code>Base.mod</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">mod(p::Particle) -&gt; Any
</code></pre><p>Modulo operator for particle locations to map them back into [0,360˚E) and [-90˚,90˚N], in the horizontal and to clamp vertical σ coordinates into [0,1].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/particles.jl#L129">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.CallbackDict-Tuple{Vararg{Pair{Symbol, &lt;:SpeedyWeather.AbstractCallback}}}" href="#SpeedyWeather.CallbackDict-Tuple{Vararg{Pair{Symbol, &lt;:SpeedyWeather.AbstractCallback}}}"><code>SpeedyWeather.CallbackDict</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">CallbackDict(
    pairs::Pair{Symbol, &lt;:SpeedyWeather.AbstractCallback}...
) -&gt; Dict{Symbol, SpeedyWeather.AbstractCallback}
</code></pre><p>Create Callback dictionary like normal dictionaries.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/callbacks.jl#L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.CallbackDict-Tuple{}" href="#SpeedyWeather.CallbackDict-Tuple{}"><code>SpeedyWeather.CallbackDict</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">CallbackDict(

) -&gt; Dict{Symbol, SpeedyWeather.AbstractCallback}
</code></pre><p>Empty Callback dictionary generator.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/callbacks.jl#L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Device-Tuple{}" href="#SpeedyWeather.Device-Tuple{}"><code>SpeedyWeather.Device</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Device()</code></pre><p>Return default used device for internal purposes, either <code>CPUDevice</code> or <code>GPUDevice</code> if a GPU is available.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/gpu.jl#L22-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.DeviceArray-Tuple{SpeedyWeather.GPUDevice, Any}" href="#SpeedyWeather.DeviceArray-Tuple{SpeedyWeather.GPUDevice, Any}"><code>SpeedyWeather.DeviceArray</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">DeviceArray(device::AbstractDevice, x)</code></pre><p>Adapts <code>x</code> to a <code>CuArray</code> when <code>device&lt;:GPUDevice</code> is used, otherwise a regular <code>Array</code>. Uses <code>adapt</code>, thus also can return SubArrays etc.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/gpu.jl#L73-L77">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.DeviceArrayNotAdapt-Tuple{SpeedyWeather.GPUDevice, Any}" href="#SpeedyWeather.DeviceArrayNotAdapt-Tuple{SpeedyWeather.GPUDevice, Any}"><code>SpeedyWeather.DeviceArrayNotAdapt</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">DeviceArrayNotAdapt(device::AbstractDevice, x)</code></pre><p>Returns a <code>CuArray</code> when <code>device&lt;:GPUDevice</code> is used, otherwise a regular <code>Array</code>. Doesn&#39;t uses <code>adapt</code>, therefore always returns CuArray/Array</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/gpu.jl#L82-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Device_KernelAbstractions-Tuple{SpeedyWeather.CPUDevice}" href="#SpeedyWeather.Device_KernelAbstractions-Tuple{SpeedyWeather.CPUDevice}"><code>SpeedyWeather.Device_KernelAbstractions</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Device_KernelAbstractions(::AbstractDevice)</code></pre><p>Return used device for use with KernelAbstractions</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/gpu.jl#L36-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.Device_KernelAbstractions-Tuple{}" href="#SpeedyWeather.Device_KernelAbstractions-Tuple{}"><code>SpeedyWeather.Device_KernelAbstractions</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Device_KernelAbstractions()</code></pre><p>Return default used device for KernelAbstractions, either <code>CPU</code> or <code>CUDADevice</code> if a GPU is available</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/gpu.jl#L29-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.gridded!-Tuple{DiagnosticVariables, PrognosticVariables, Int64, ModelSetup}" href="#SpeedyWeather.SpeedyTransforms.gridded!-Tuple{DiagnosticVariables, PrognosticVariables, Int64, ModelSetup}"><code>SpeedyWeather.SpeedyTransforms.gridded!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">gridded!(
    diagn::DiagnosticVariables,
    progn::PrognosticVariables,
    lf::Int64,
    model::ModelSetup
)
</code></pre><p>Propagate the spectral state of <code>progn</code> to <code>diagn</code> using time step/leapfrog index <code>lf</code>. Function barrier that calls gridded! for the respective <code>model</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/tendencies.jl#L761">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.gridded!-Tuple{DiagnosticVariablesLayer, PrognosticVariablesLayer, Barotropic}" href="#SpeedyWeather.SpeedyTransforms.gridded!-Tuple{DiagnosticVariablesLayer, PrognosticVariablesLayer, Barotropic}"><code>SpeedyWeather.SpeedyTransforms.gridded!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">gridded!(
    diagn::DiagnosticVariablesLayer,
    progn::PrognosticVariablesLayer,
    model::Barotropic
)
</code></pre><p>Propagate the spectral state of the prognostic variables <code>progn</code> to the diagnostic variables in <code>diagn</code> for the barotropic vorticity model. Updates grid vorticity, spectral stream function and spectral and grid velocities u, v.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/tendencies.jl#L786">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.gridded!-Tuple{DiagnosticVariablesLayer, PrognosticVariablesLayer, PrimitiveEquation}" href="#SpeedyWeather.SpeedyTransforms.gridded!-Tuple{DiagnosticVariablesLayer, PrognosticVariablesLayer, PrimitiveEquation}"><code>SpeedyWeather.SpeedyTransforms.gridded!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">gridded!(
    diagn::DiagnosticVariablesLayer,
    progn::PrognosticVariablesLayer,
    model::PrimitiveEquation
)
</code></pre><p>Propagate the spectral state of the prognostic variables <code>progn</code> to the diagnostic variables in <code>diagn</code> for primitive equation models. Updates grid vorticity, grid divergence, grid temperature, pressure (<code>pres_grid</code>) and the velocities u, v.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/tendencies.jl#L847">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.gridded!-Tuple{DiagnosticVariablesLayer, PrognosticVariablesLayer, ShallowWater}" href="#SpeedyWeather.SpeedyTransforms.gridded!-Tuple{DiagnosticVariablesLayer, PrognosticVariablesLayer, ShallowWater}"><code>SpeedyWeather.SpeedyTransforms.gridded!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">gridded!(
    diagn::DiagnosticVariablesLayer,
    progn::PrognosticVariablesLayer,
    model::ShallowWater
)
</code></pre><p>Propagate the spectral state of the prognostic variables <code>progn</code> to the diagnostic variables in <code>diagn</code> for the shallow water model. Updates grid vorticity, grid divergence, grid interface displacement (<code>pres_grid</code>) and the velocities u, v.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/tendencies.jl#L815">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.WhichZenith-Tuple{SpectralGrid, SpeedyWeather.AbstractPlanet}" href="#SpeedyWeather.WhichZenith-Tuple{SpectralGrid, SpeedyWeather.AbstractPlanet}"><code>SpeedyWeather.WhichZenith</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">WhichZenith(
    SG::SpectralGrid,
    P::SpeedyWeather.AbstractPlanet;
    kwargs...
) -&gt; Any
</code></pre><p>Chooses from SolarZenith (daily and seasonal cycle) or SolarZenithSeason given the parameters in model.planet. In both cases the seasonal cycle can be disabled, calculating the solar declination from the initial time instead of current time.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/zenith.jl#L105">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.activate-Union{Tuple{Particle{NF}}, Tuple{NF}} where NF" href="#SpeedyWeather.activate-Union{Tuple{Particle{NF}}, Tuple{NF}} where NF"><code>SpeedyWeather.activate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">activate(
    p::Particle{NF}
) -&gt; Particle{NF, true} where NF&lt;:AbstractFloat
</code></pre><p>Activate particle. Active particles can move.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/particles.jl#L117">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.active-Union{Tuple{Particle{NF, isactive}}, Tuple{isactive}, Tuple{NF}} where {NF, isactive}" href="#SpeedyWeather.active-Union{Tuple{Particle{NF, isactive}}, Tuple{isactive}, Tuple{NF}} where {NF, isactive}"><code>SpeedyWeather.active</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">active(_::Particle{NF, isactive}) -&gt; Any
</code></pre><p>Check whether particle is active.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/particles.jl#L125">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.add!-Tuple{Dict{Symbol, SpeedyWeather.AbstractCallback}, Vararg{Pair{Symbol, &lt;:SpeedyWeather.AbstractCallback}}}" href="#SpeedyWeather.add!-Tuple{Dict{Symbol, SpeedyWeather.AbstractCallback}, Vararg{Pair{Symbol, &lt;:SpeedyWeather.AbstractCallback}}}"><code>SpeedyWeather.add!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add!(
    D::Dict{Symbol, SpeedyWeather.AbstractCallback},
    key_callbacks::Pair{Symbol, &lt;:SpeedyWeather.AbstractCallback}...
)
</code></pre><p>Add a or several callbacks to a Dict{String, AbstractCallback} dictionary. To be used like</p><pre><code class="nohighlight hljs">add!(model.callbacks, :my_callback =&gt; callback)
add!(model.callbacks, :my_callback1 =&gt; callback, :my_callback2 =&gt; other_callback)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/callbacks.jl#L47">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.add!-Tuple{Dict{Symbol, SpeedyWeather.AbstractCallback}, Vararg{SpeedyWeather.AbstractCallback}}" href="#SpeedyWeather.add!-Tuple{Dict{Symbol, SpeedyWeather.AbstractCallback}, Vararg{SpeedyWeather.AbstractCallback}}"><code>SpeedyWeather.add!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add!(
    D::Dict{Symbol, SpeedyWeather.AbstractCallback},
    callbacks::SpeedyWeather.AbstractCallback...
)
</code></pre><p>Add a or several callbacks to a Dict{Symbol, AbstractCallback} dictionary without specifying the key which is randomly created like callback_????. To be used like</p><pre><code class="nohighlight hljs">add!(model.callbacks, callback)
add!(model.callbacks, callback1, callback2).</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/callbacks.jl#L71">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.bernoulli_potential!-Union{Tuple{NF}, Tuple{DiagnosticVariablesLayer{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, SpectralTransform}} where NF" href="#SpeedyWeather.bernoulli_potential!-Union{Tuple{NF}, Tuple{DiagnosticVariablesLayer{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, SpectralTransform}} where NF"><code>SpeedyWeather.bernoulli_potential!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">bernoulli_potential!(
    diagn::DiagnosticVariablesLayer{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF},
    S::SpectralTransform
) -&gt; LowerTriangularMatrix{Complex{NF}} where NF&lt;:AbstractFloat
</code></pre><p>Computes the Laplace operator ∇² of the Bernoulli potential <code>B</code> in spectral space.</p><ol><li>computes the kinetic energy KE = ½(u²+v²) on the grid</li><li>transforms KE to spectral space</li><li>adds geopotential for the Bernoulli potential in spectral space</li><li>takes the Laplace operator.</li></ol><p>This version is used for both ShallowWater and PrimitiveEquation, only the geopotential calculation in geopotential! differs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/tendencies.jl#L680">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.boundary_layer_drag!-Tuple{ColumnVariables, LinearDrag}" href="#SpeedyWeather.boundary_layer_drag!-Tuple{ColumnVariables, LinearDrag}"><code>SpeedyWeather.boundary_layer_drag!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">boundary_layer_drag!(
    column::ColumnVariables,
    scheme::LinearDrag
)
</code></pre><p>Compute tendency for boundary layer drag of a <code>column</code> and add to its tendencies fields</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/boundary_layer.jl#L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.callback!-Tuple{GlobalSurfaceTemperatureCallback, PrognosticVariables, DiagnosticVariables, ModelSetup}" href="#SpeedyWeather.callback!-Tuple{GlobalSurfaceTemperatureCallback, PrognosticVariables, DiagnosticVariables, ModelSetup}"><code>SpeedyWeather.callback!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">callback!(
    callback::GlobalSurfaceTemperatureCallback,
    progn::PrognosticVariables,
    diagn::DiagnosticVariables,
    model::ModelSetup
) -&gt; AbstractFloat
</code></pre><p>Pulls the average temperature from the lowermost layer and stores it in the next element of the callback.temp vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/callbacks.jl#L116">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.clip_negatives!-Union{Tuple{AbstractArray{T}}, Tuple{T}} where T" href="#SpeedyWeather.clip_negatives!-Union{Tuple{AbstractArray{T}}, Tuple{T}} where T"><code>SpeedyWeather.clip_negatives!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">clip_negatives!(A::AbstractArray)</code></pre><p>Set all negative entries <code>a</code> in <code>A</code> to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/utility_functions.jl#L24-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.convection!-Union{Tuple{NF}, Tuple{ColumnVariables{NF}, DryBettsMiller, Geometry, SpeedyWeather.AbstractAtmosphere}} where NF" href="#SpeedyWeather.convection!-Union{Tuple{NF}, Tuple{ColumnVariables{NF}, DryBettsMiller, Geometry, SpeedyWeather.AbstractAtmosphere}} where NF"><code>SpeedyWeather.convection!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">convection!(
    column::ColumnVariables{NF},
    DBM::DryBettsMiller,
    geometry::Geometry,
    atmosphere::SpeedyWeather.AbstractAtmosphere
)
</code></pre><p>calculates temperature tendency for the dry convection scheme following the simplified Betts-Miller convection from Frierson 2007 but with zero humidity. Starts with a first-guess relaxation to determine the convective criterion, then adjusts the reference profiles for thermodynamic consistency (e.g. in dry convection the humidity profile is non-precipitating), and relaxes current vertical profiles to the adjusted references.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/convection.jl#L276">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.convection!-Union{Tuple{NF}, Tuple{ColumnVariables{NF}, SimplifiedBettsMiller, SpeedyWeather.AbstractClausiusClapeyron, Geometry, SpeedyWeather.AbstractPlanet, SpeedyWeather.AbstractAtmosphere, SpeedyWeather.AbstractTimeStepper}} where NF" href="#SpeedyWeather.convection!-Union{Tuple{NF}, Tuple{ColumnVariables{NF}, SimplifiedBettsMiller, SpeedyWeather.AbstractClausiusClapeyron, Geometry, SpeedyWeather.AbstractPlanet, SpeedyWeather.AbstractAtmosphere, SpeedyWeather.AbstractTimeStepper}} where NF"><code>SpeedyWeather.convection!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">convection!(
    column::ColumnVariables{NF},
    SBM::SimplifiedBettsMiller,
    clausius_clapeyron::SpeedyWeather.AbstractClausiusClapeyron,
    geometry::Geometry,
    planet::SpeedyWeather.AbstractPlanet,
    atmosphere::SpeedyWeather.AbstractAtmosphere,
    time_stepping::SpeedyWeather.AbstractTimeStepper
) -&gt; Union{Nothing, Int64}
</code></pre><p>calculates temperature and humidity tendencies for the convection scheme following the simplified Betts-Miller convection. Starts with a first-guess relaxation to determine the convective criteria (none, dry/shallow or deep), then adjusts reference profiles for thermodynamic consistency (e.g. in dry convection the humidity profile is non-precipitating), and relaxes current vertical profiles to the adjusted references.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/convection.jl#L53">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.coriolis-Tuple{Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid" href="#SpeedyWeather.coriolis-Tuple{Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid"><code>SpeedyWeather.coriolis</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">coriolis(
    grid::SpeedyWeather.RingGrids.AbstractGrid;
    rotation
) -&gt; Any
</code></pre><p>Return the Coriolis parameter <code>f</code> on a grid like <code>grid</code> on a planet of <code>ratation</code> [1/s]. Default rotation of Earth.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/coriolis.jl#L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.coriolis-Union{Tuple{Grid}, Tuple{Type{Grid}, Integer}} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid" href="#SpeedyWeather.coriolis-Union{Tuple{Grid}, Tuple{Type{Grid}, Integer}} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid"><code>SpeedyWeather.coriolis</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">coriolis(
    grid::SpeedyWeather.RingGrids.AbstractGrid;
    rotation
) -&gt; Any
</code></pre><p>Return the Coriolis parameter <code>f</code> on the grid <code>Grid</code> of resolution <code>nlat_half</code> on a planet of <code>ratation</code> [1/s]. Default rotation of Earth.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/coriolis.jl#L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.cos_zenith!-Union{Tuple{NF}, Tuple{SolarZenithSeason{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, DateTime, SpeedyWeather.AbstractGeometry}} where NF" href="#SpeedyWeather.cos_zenith!-Union{Tuple{NF}, Tuple{SolarZenithSeason{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, DateTime, SpeedyWeather.AbstractGeometry}} where NF"><code>SpeedyWeather.cos_zenith!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">cos_zenith!(
    S::SolarZenithSeason{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF},
    time::DateTime,
    geometry::SpeedyWeather.AbstractGeometry
)
</code></pre><p>Calculate cos of solar zenith angle as daily average at time <code>time</code>. Seasonal cycle or time correction may be disabled, depending on parameters in SolarZenithSeason.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/zenith.jl#L262">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.cos_zenith!-Union{Tuple{NF}, Tuple{SolarZenith{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, DateTime, SpeedyWeather.AbstractGeometry}} where NF" href="#SpeedyWeather.cos_zenith!-Union{Tuple{NF}, Tuple{SolarZenith{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, DateTime, SpeedyWeather.AbstractGeometry}} where NF"><code>SpeedyWeather.cos_zenith!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">cos_zenith!(
    S::SolarZenith{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF},
    time::DateTime,
    geometry::SpeedyWeather.AbstractGeometry
)
</code></pre><p>Calculate cos of solar zenith angle with a daily cycle at time <code>time</code>. Seasonal cycle or time correction may be disabled, depending on parameters in SolarZenith.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/zenith.jl#L198">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.create_output_folder-Tuple{String, Union{Int64, String}}" href="#SpeedyWeather.create_output_folder-Tuple{String, Union{Int64, String}}"><code>SpeedyWeather.create_output_folder</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">create_output_folder(
    path::String,
    id::Union{Int64, String}
) -&gt; String
</code></pre><p>Creates a new folder <code>run_*</code> with the identification <code>id</code>. Also returns the full path <code>run_path</code> of that folder.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/output.jl#L343">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.deactivate-Union{Tuple{Particle{NF}}, Tuple{NF}} where NF" href="#SpeedyWeather.deactivate-Union{Tuple{Particle{NF}}, Tuple{NF}} where NF"><code>SpeedyWeather.deactivate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">deactivate(
    p::Particle{NF}
) -&gt; Particle{_A, false} where _A&lt;:AbstractFloat
</code></pre><p>Deactivate particle. Inactive particles cannot move.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/particles.jl#L121">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.default_sigma_coordinates-Tuple{Integer}" href="#SpeedyWeather.default_sigma_coordinates-Tuple{Integer}"><code>SpeedyWeather.default_sigma_coordinates</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">default_sigma_coordinates(nlev::Integer) -&gt; Vector{Float64}
</code></pre><p>Vertical sigma coordinates defined by their nlev+1 half levels <code>σ_levels_half</code>. Sigma coordinates are fraction of surface pressure (p/p0) and are sorted from top (stratosphere) to bottom (surface). The first half level is at 0 the last at 1. Default levels are equally spaced from 0 to 1 (including).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/vertical_coordinates.jl#L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.drag!-Union{Tuple{NF}, Tuple{DiagnosticVariablesLayer, QuadraticDrag{NF}}} where NF" href="#SpeedyWeather.drag!-Union{Tuple{NF}, Tuple{DiagnosticVariablesLayer, QuadraticDrag{NF}}} where NF"><code>SpeedyWeather.drag!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">drag!(
    diagn::DiagnosticVariablesLayer,
    drag::QuadraticDrag{NF}
)
</code></pre><p>Quadratic drag for the momentum equations.</p><pre><code class="nohighlight hljs">F = -c_D/H*|(u, v)|*(u, v)</code></pre><p>with c<em>D the non-dimensional drag coefficient as defined in <code>drag::QuadraticDrag</code>. c</em>D and layer thickness <code>H</code> are precomputed in intialize!(::QuadraticDrag, ::ModelSetup) and scaled by the radius as are the momentum equations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/drag.jl#L44">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.dry_adiabat!-Tuple{AbstractVector, AbstractVector, AbstractVector, SpeedyWeather.AbstractAtmosphere}" href="#SpeedyWeather.dry_adiabat!-Tuple{AbstractVector, AbstractVector, AbstractVector, SpeedyWeather.AbstractAtmosphere}"><code>SpeedyWeather.dry_adiabat!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">dry_adiabat!(
    temp_ref_profile::AbstractVector,
    temp_environment::AbstractVector,
    σ::AbstractVector,
    atmosphere::SpeedyWeather.AbstractAtmosphere
) -&gt; Int64
</code></pre><p>Calculates the moist pseudo adiabat given temperature and humidity of surface parcel. Follows the dry adiabat till condensation and then continues on the pseudo moist-adiabat with immediate condensation to the level of zero buoyancy. Levels above are skipped, set to NaN instead and should be skipped in the relaxation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/convection.jl#L328">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.dry_static_energy!-Tuple{ColumnVariables, SpeedyWeather.AbstractAtmosphere}" href="#SpeedyWeather.dry_static_energy!-Tuple{ColumnVariables, SpeedyWeather.AbstractAtmosphere}"><code>SpeedyWeather.dry_static_energy!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">dry_static_energy!(
    column::ColumnVariables,
    atmosphere::SpeedyWeather.AbstractAtmosphere
)
</code></pre><p>Compute the dry static energy SE = cₚT + Φ (latent heat times temperature plus geopotential) for the column.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/thermodynamics.jl#L126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.dynamics_tendencies!" href="#SpeedyWeather.dynamics_tendencies!"><code>SpeedyWeather.dynamics_tendencies!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">dynamics_tendencies!(
    diagn::DiagnosticVariables,
    progn::PrognosticVariables,
    model::PrimitiveEquation
) -&gt; Any
dynamics_tendencies!(
    diagn::DiagnosticVariables,
    progn::PrognosticVariables,
    model::PrimitiveEquation,
    lf::Int64
) -&gt; Any
</code></pre><p>Calculate all tendencies for the PrimitiveEquation model (wet or dry).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/tendencies.jl#L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.dynamics_tendencies!-Tuple{DiagnosticVariablesLayer, PrognosticVariablesLayer, DateTime, Barotropic}" href="#SpeedyWeather.dynamics_tendencies!-Tuple{DiagnosticVariablesLayer, PrognosticVariablesLayer, DateTime, Barotropic}"><code>SpeedyWeather.dynamics_tendencies!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">dynamics_tendencies!(
    diagn::DiagnosticVariablesLayer,
    progn::PrognosticVariablesLayer,
    time::DateTime,
    model::Barotropic
)
</code></pre><p>Calculate all tendencies for the BarotropicModel.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/tendencies.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.dynamics_tendencies!-Tuple{DiagnosticVariablesLayer, PrognosticVariablesLayer, SpeedyWeather.SurfaceVariables, LowerTriangularMatrix, DateTime, ShallowWater}" href="#SpeedyWeather.dynamics_tendencies!-Tuple{DiagnosticVariablesLayer, PrognosticVariablesLayer, SpeedyWeather.SurfaceVariables, LowerTriangularMatrix, DateTime, ShallowWater}"><code>SpeedyWeather.dynamics_tendencies!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">dynamics_tendencies!(
    diagn::DiagnosticVariablesLayer,
    progn::PrognosticVariablesLayer,
    surface::SpeedyWeather.SurfaceVariables,
    pres::LowerTriangularMatrix,
    time::DateTime,
    model::ShallowWater
)
</code></pre><p>Calculate all tendencies for the ShallowWaterModel.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/tendencies.jl#L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.finish!-Tuple{Feedback}" href="#SpeedyWeather.finish!-Tuple{Feedback}"><code>SpeedyWeather.finish!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">finish!(F::Feedback)
</code></pre><p>Finalises the progress meter and the progress txt file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/feedback.jl#L140">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.first_timesteps!-Tuple{PrognosticVariables, DiagnosticVariables, ModelSetup, SpeedyWeather.AbstractOutputWriter}" href="#SpeedyWeather.first_timesteps!-Tuple{PrognosticVariables, DiagnosticVariables, ModelSetup, SpeedyWeather.AbstractOutputWriter}"><code>SpeedyWeather.first_timesteps!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">first_timesteps!(
    progn::PrognosticVariables,
    diagn::DiagnosticVariables,
    model::ModelSetup,
    output::SpeedyWeather.AbstractOutputWriter
)
</code></pre><p>Performs the first two initial time steps (Euler forward, unfiltered leapfrog) to populate the prognostic variables with two time steps (t=0, Δt) that can then be used in the normal leap frogging.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/time_integration.jl#L190">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.flipsign!-Tuple{AbstractArray}" href="#SpeedyWeather.flipsign!-Tuple{AbstractArray}"><code>SpeedyWeather.flipsign!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">flipgsign!(A::AbstractArray)</code></pre><p>Like <code>-A</code> but in-place.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/utility_functions.jl#L45-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.flux_divergence!-Union{Tuple{NF}, Tuple{LowerTriangularMatrix{Complex{NF}}, SpeedyWeather.RingGrids.AbstractGrid{NF}, DiagnosticVariablesLayer{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Geometry{NF}, SpectralTransform{NF}}} where NF" href="#SpeedyWeather.flux_divergence!-Union{Tuple{NF}, Tuple{LowerTriangularMatrix{Complex{NF}}, SpeedyWeather.RingGrids.AbstractGrid{NF}, DiagnosticVariablesLayer{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Geometry{NF}, SpectralTransform{NF}}} where NF"><code>SpeedyWeather.flux_divergence!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">flux_divergence!(
    A_tend::LowerTriangularMatrix{Complex{NF}},
    A_grid::SpeedyWeather.RingGrids.AbstractGrid{NF},
    diagn::DiagnosticVariablesLayer{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF},
    G::Geometry{NF},
    S::SpectralTransform{NF};
    add,
    flipsign
)
</code></pre><p>Computes ∇⋅((u, v)*A) with the option to add/overwrite <code>A_tend</code> and to <code>flip_sign</code> of the flux divergence by doing so.</p><ul><li><code>A_tend =  ∇⋅((u, v)*A)</code> for <code>add=false</code>, <code>flip_sign=false</code></li><li><code>A_tend = -∇⋅((u, v)*A)</code> for <code>add=false</code>, <code>flip_sign=true</code></li><li><code>A_tend += ∇⋅((u, v)*A)</code> for <code>add=true</code>, <code>flip_sign=false</code></li><li><code>A_tend -= ∇⋅((u, v)*A)</code> for <code>add=true</code>, <code>flip_sign=true</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/tendencies.jl#L538">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.fluxes_to_tendencies!-Tuple{ColumnVariables, Geometry, SpeedyWeather.AbstractPlanet, SpeedyWeather.AbstractAtmosphere}" href="#SpeedyWeather.fluxes_to_tendencies!-Tuple{ColumnVariables, Geometry, SpeedyWeather.AbstractPlanet, SpeedyWeather.AbstractAtmosphere}"><code>SpeedyWeather.fluxes_to_tendencies!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fluxes_to_tendencies!(
    column::ColumnVariables,
    geometry::Geometry,
    planet::SpeedyWeather.AbstractPlanet,
    atmosphere::SpeedyWeather.AbstractAtmosphere
)
</code></pre><p>Convert the fluxes on half levels to tendencies on full levels.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/tendencies.jl#L68">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.forcing!-Tuple{DiagnosticVariablesLayer, JetStreamForcing}" href="#SpeedyWeather.forcing!-Tuple{DiagnosticVariablesLayer, JetStreamForcing}"><code>SpeedyWeather.forcing!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">forcing!(
    diagn::DiagnosticVariablesLayer,
    forcing::JetStreamForcing
)
</code></pre><p>Set for every latitude ring the tendency to the precomputed forcing in the momentum equations following the JetStreamForcing. The forcing is precomputed in <code>initialize!(::JetStreamForcing, ::ModelSetup)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/forcing.jl#L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.geopotential!" href="#SpeedyWeather.geopotential!"><code>SpeedyWeather.geopotential!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">geopotential!(
    geopot::AbstractVector,
    temp::AbstractVector,
    G::Geopotential
)
geopotential!(
    geopot::AbstractVector,
    temp::AbstractVector,
    G::Geopotential,
    geopot_surf::Real
)
</code></pre><p>Calculate the geopotential based on <code>temp</code> in a single column. This exclues the surface geopotential that would need to be added to the returned vector. Function not used in the dynamical core but for post-processing and analysis.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/geopotential.jl#L82">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.geopotential!-Tuple{DiagnosticVariables, Geopotential, SpeedyWeather.AbstractOrography}" href="#SpeedyWeather.geopotential!-Tuple{DiagnosticVariables, Geopotential, SpeedyWeather.AbstractOrography}"><code>SpeedyWeather.geopotential!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">geopotential!(
    diagn::DiagnosticVariables,
    geopotential::Geopotential,
    orography::SpeedyWeather.AbstractOrography
)
</code></pre><p>Compute spectral geopotential <code>geopot</code> from spectral temperature <code>temp</code> and spectral surface geopotential <code>geopot_surf</code> (orography*gravity).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/geopotential.jl#L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.geopotential!-Tuple{DiagnosticVariablesLayer, LowerTriangularMatrix, SpeedyWeather.AbstractPlanet}" href="#SpeedyWeather.geopotential!-Tuple{DiagnosticVariablesLayer, LowerTriangularMatrix, SpeedyWeather.AbstractPlanet}"><code>SpeedyWeather.geopotential!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">geopotential!(
    diagn::DiagnosticVariablesLayer,
    pres::LowerTriangularMatrix,
    planet::SpeedyWeather.AbstractPlanet
) -&gt; Any
</code></pre><p>calculates the geopotential in the ShallowWaterModel as g*η, i.e. gravity times the interface displacement (field <code>pres</code>)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/geopotential.jl#L117">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.get_column!-Tuple{ColumnVariables, DiagnosticVariables, PrognosticVariables, Int64, PrimitiveEquation}" href="#SpeedyWeather.get_column!-Tuple{ColumnVariables, DiagnosticVariables, PrognosticVariables, Int64, PrimitiveEquation}"><code>SpeedyWeather.get_column!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Recalculate ring index if not provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/column_variables.jl#L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.get_column!-Tuple{ColumnVariables, DiagnosticVariables, PrognosticVariables, Integer, Integer, Geometry, SpeedyWeather.AbstractPlanet, SpeedyWeather.AbstractOrography, SpeedyWeather.AbstractLandSeaMask}" href="#SpeedyWeather.get_column!-Tuple{ColumnVariables, DiagnosticVariables, PrognosticVariables, Integer, Integer, Geometry, SpeedyWeather.AbstractPlanet, SpeedyWeather.AbstractOrography, SpeedyWeather.AbstractLandSeaMask}"><code>SpeedyWeather.get_column!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_column!(
    C::ColumnVariables,
    D::DiagnosticVariables,
    P::PrognosticVariables,
    ij::Integer,
    jring::Integer,
    geometry::Geometry,
    planet::SpeedyWeather.AbstractPlanet,
    orography::SpeedyWeather.AbstractOrography,
    land_sea_mask::SpeedyWeather.AbstractLandSeaMask
) -&gt; Any
</code></pre><p>Update <code>C::ColumnVariables</code> by copying the prognostic variables from <code>D::DiagnosticVariables</code> at gridpoint index <code>ij</code>. Provide <code>G::Geometry</code> for coordinate information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/column_variables.jl#L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.get_full_output_file_path-Tuple{OutputWriter}" href="#SpeedyWeather.get_full_output_file_path-Tuple{OutputWriter}"><code>SpeedyWeather.get_full_output_file_path</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_full_output_file_path(output::OutputWriter) -&gt; String
</code></pre><p>Returns the full path of the output file after it was created.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/output.jl#L555">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.get_run_id-Tuple{String, String}" href="#SpeedyWeather.get_run_id-Tuple{String, String}"><code>SpeedyWeather.get_run_id</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_run_id(path::String, id::String) -&gt; String
</code></pre><p>Checks existing <code>run_????</code> folders in <code>path</code> to determine a 4-digit <code>id</code> number by counting up. E.g. if folder run_0001 exists it will return the string &quot;0002&quot;. Does not create a folder for the returned run id.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/output.jl#L316">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.get_thermodynamics!-Tuple{ColumnVariables, PrimitiveEquation}" href="#SpeedyWeather.get_thermodynamics!-Tuple{ColumnVariables, PrimitiveEquation}"><code>SpeedyWeather.get_thermodynamics!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_thermodynamics!(
    column::ColumnVariables,
    model::PrimitiveEquation
)
</code></pre><p>Calculate geopotentiala and dry static energy for the primitive equation model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/thermodynamics.jl#L118">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.get_var-Tuple{PrognosticVariables, Symbol}" href="#SpeedyWeather.get_var-Tuple{PrognosticVariables, Symbol}"><code>SpeedyWeather.get_var</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_var(progn::PrognosticVariables, var_name::Symbol; lf::Integer=1)</code></pre><p>Returns the prognostic variable <code>var_name</code> at leapfrog index <code>lf</code> as a <code>Vector{LowerTriangularMatrices}</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/prognostic_variables.jl#L391-L395">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.get_Δt_millisec" href="#SpeedyWeather.get_Δt_millisec"><code>SpeedyWeather.get_Δt_millisec</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_Δt_millisec(
    Δt_at_T31::Dates.TimePeriod,
    trunc,
    radius,
    adjust_with_output::Bool
) -&gt; Any
get_Δt_millisec(
    Δt_at_T31::Dates.TimePeriod,
    trunc,
    radius,
    adjust_with_output::Bool,
    output_dt::Dates.TimePeriod
) -&gt; Any
</code></pre><p>Computes the time step in [ms]. <code>Δt_at_T31</code> is always scaled with the resolution <code>trunc</code>  of the model. In case <code>adjust_Δt_with_output</code> is true, the <code>Δt_at_T31</code> is additionally  adjusted to the closest divisor of <code>output_dt</code> so that the output time axis is keeping <code>output_dt</code> exactly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/time_integration.jl#L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.grad-Union{Tuple{NF}, Tuple{ClausiusClapeyron{NF}, NF}} where NF" href="#SpeedyWeather.grad-Union{Tuple{NF}, Tuple{ClausiusClapeyron{NF}, NF}} where NF"><code>SpeedyWeather.grad</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">grad(CC::ClausiusClapeyron{NF}, temp_kelvin) -&gt; Any
</code></pre><p>Gradient of Clausius-Clapeyron wrt to temperature, evaluated at <code>temp_kelvin</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/thermodynamics.jl#L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.grad-Union{Tuple{NF}, Tuple{TetensEquation{NF}, NF}} where NF" href="#SpeedyWeather.grad-Union{Tuple{NF}, Tuple{TetensEquation{NF}, NF}} where NF"><code>SpeedyWeather.grad</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">grad(
    TetensCoefficients::TetensEquation{NF},
    temp_kelvin
) -&gt; Any
</code></pre><p>Gradient of the Tetens equation wrt to temperature, evaluated at <code>temp_kelvin</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/thermodynamics.jl#L247">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.grad_saturation_humidity-Union{Tuple{NF}, Tuple{ClausiusClapeyron{NF}, NF, NF}} where NF" href="#SpeedyWeather.grad_saturation_humidity-Union{Tuple{NF}, Tuple{ClausiusClapeyron{NF}, NF, NF}} where NF"><code>SpeedyWeather.grad_saturation_humidity</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">grad_saturation_humidity(
    CC::ClausiusClapeyron{NF},
    temp_kelvin,
    pres
) -&gt; Any
</code></pre><p>Gradient of Clausius-Clapeyron wrt to temperature, evaluated at <code>temp_kelvin</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/thermodynamics.jl#L110">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.has-Tuple{Type{&lt;:ModelSetup}, Symbol}" href="#SpeedyWeather.has-Tuple{Type{&lt;:ModelSetup}, Symbol}"><code>SpeedyWeather.has</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">has(M::Type{&lt;:ModelSetup}, var_name::Symbol) -&gt; Bool
</code></pre><p>Returns true if the model <code>M</code> has a prognostic variable <code>var_name</code>, false otherwise. The default fallback is that all variables are included. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/models/abstract_models.jl#L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.horizontal_diffusion!" href="#SpeedyWeather.horizontal_diffusion!"><code>SpeedyWeather.horizontal_diffusion!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">horizontal_diffusion!(
    progn::SpeedyWeather.PrognosticLayerTimesteps,
    diagn::DiagnosticVariablesLayer,
    model::PrimitiveEquation
) -&gt; Union{Nothing, Bool}
horizontal_diffusion!(
    progn::SpeedyWeather.PrognosticLayerTimesteps,
    diagn::DiagnosticVariablesLayer,
    model::PrimitiveEquation,
    lf::Int64
) -&gt; Union{Nothing, Bool}
</code></pre><p>Apply horizontal diffusion applied to vorticity, diffusion and temperature in the PrimitiveEquation models. Uses the constant diffusion for temperature but possibly adaptive diffusion for vorticity and divergence.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/horizontal_diffusion.jl#L239">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.horizontal_diffusion!" href="#SpeedyWeather.horizontal_diffusion!"><code>SpeedyWeather.horizontal_diffusion!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">horizontal_diffusion!(
    diagn::DiagnosticVariablesLayer,
    progn::SpeedyWeather.PrognosticLayerTimesteps,
    model::Barotropic
)
horizontal_diffusion!(
    diagn::DiagnosticVariablesLayer,
    progn::SpeedyWeather.PrognosticLayerTimesteps,
    model::Barotropic,
    lf::Int64
)
</code></pre><p>Apply horizontal diffusion to vorticity in the Barotropic models.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/horizontal_diffusion.jl#L204">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.horizontal_diffusion!" href="#SpeedyWeather.horizontal_diffusion!"><code>SpeedyWeather.horizontal_diffusion!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">horizontal_diffusion!(
    progn::SpeedyWeather.PrognosticLayerTimesteps,
    diagn::DiagnosticVariablesLayer,
    model::ShallowWater
)
horizontal_diffusion!(
    progn::SpeedyWeather.PrognosticLayerTimesteps,
    diagn::DiagnosticVariablesLayer,
    model::ShallowWater,
    lf::Int64
)
</code></pre><p>Apply horizontal diffusion to vorticity and diffusion in the ShallowWater models.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/horizontal_diffusion.jl#L221">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.horizontal_diffusion!-Union{Tuple{NF}, Tuple{LowerTriangularMatrix{Complex{NF}}, LowerTriangularMatrix{Complex{NF}}, AbstractVector{NF}, AbstractVector{NF}}} where NF&lt;:AbstractFloat" href="#SpeedyWeather.horizontal_diffusion!-Union{Tuple{NF}, Tuple{LowerTriangularMatrix{Complex{NF}}, LowerTriangularMatrix{Complex{NF}}, AbstractVector{NF}, AbstractVector{NF}}} where NF&lt;:AbstractFloat"><code>SpeedyWeather.horizontal_diffusion!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">horizontal_diffusion!(
    tendency::LowerTriangularMatrix{Complex{NF&lt;:AbstractFloat}},
    A::LowerTriangularMatrix{Complex{NF&lt;:AbstractFloat}},
    ∇²ⁿ_expl::AbstractArray{NF&lt;:AbstractFloat, 1},
    ∇²ⁿ_impl::AbstractArray{NF&lt;:AbstractFloat, 1}
)
</code></pre><p>Apply horizontal diffusion to a 2D field <code>A</code> in spectral space by updating its tendency <code>tendency</code> with an implicitly calculated diffusion term. The implicit diffusion of the next time step is split into an explicit part <code>∇²ⁿ_expl</code> and an implicit part <code>∇²ⁿ_impl</code>, such that both can be calculated in a single forward step by using <code>A</code> as well as its tendency <code>tendency</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/horizontal_diffusion.jl#L180">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.humidity_diffusion!-Tuple{ColumnVariables, HumidityDiffusion, Geometry}" href="#SpeedyWeather.humidity_diffusion!-Tuple{ColumnVariables, HumidityDiffusion, Geometry}"><code>SpeedyWeather.humidity_diffusion!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">humidity_diffusion!(
    column::ColumnVariables,
    scheme::HumidityDiffusion,
    geometry::Geometry
)
</code></pre><p>Apply humidity diffusion.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/vertical_diffusion.jl#L144">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.implicit_correction!-Tuple{DiagnosticVariables, ImplicitPrimitiveEquation, PrognosticVariables}" href="#SpeedyWeather.implicit_correction!-Tuple{DiagnosticVariables, ImplicitPrimitiveEquation, PrognosticVariables}"><code>SpeedyWeather.implicit_correction!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">implicit_correction!(
    diagn::DiagnosticVariables,
    implicit::ImplicitPrimitiveEquation,
    progn::PrognosticVariables
) -&gt; Any
</code></pre><p>Apply the implicit corrections to dampen gravity waves in the primitive equation models.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/implicit.jl#L304">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.implicit_correction!-Union{Tuple{NF}, Tuple{DiagnosticVariablesLayer{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, SpeedyWeather.PrognosticLayerTimesteps{NF}, SpeedyWeather.SurfaceVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, SpeedyWeather.PrognosticSurfaceTimesteps{NF}, ImplicitShallowWater}} where NF" href="#SpeedyWeather.implicit_correction!-Union{Tuple{NF}, Tuple{DiagnosticVariablesLayer{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, SpeedyWeather.PrognosticLayerTimesteps{NF}, SpeedyWeather.SurfaceVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, SpeedyWeather.PrognosticSurfaceTimesteps{NF}, ImplicitShallowWater}} where NF"><code>SpeedyWeather.implicit_correction!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">implicit_correction!(
    diagn::DiagnosticVariablesLayer{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF},
    progn::SpeedyWeather.PrognosticLayerTimesteps{NF},
    diagn_surface::SpeedyWeather.SurfaceVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF},
    progn_surface::SpeedyWeather.PrognosticSurfaceTimesteps{NF},
    implicit::ImplicitShallowWater
)
</code></pre><p>Apply correction to the tendencies in <code>diagn</code> to prevent the gravity waves from amplifying. The correction is implicitly evaluated using the parameter <code>implicit.α</code> to switch between forward, centered implicit or backward evaluation of the gravity wave terms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/implicit.jl#L81">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!" href="#SpeedyWeather.initialize!"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">initialize!(
    scheme::HyperDiffusion,
    k::Int64,
    G::SpeedyWeather.AbstractGeometry,
    L::SpeedyWeather.AbstractTimeStepper
)
initialize!(
    scheme::HyperDiffusion,
    k::Int64,
    G::SpeedyWeather.AbstractGeometry,
    L::SpeedyWeather.AbstractTimeStepper,
    vor_max::Real
)
</code></pre><p>Precomputes the hyper diffusion terms in <code>scheme</code> for layer <code>k</code> based on the model time step in <code>L</code>, the vertical level sigma level in <code>G</code>, and the current (absolute) vorticity maximum level <code>vor_max</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/horizontal_diffusion.jl#L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{AquaPlanetMask, PrimitiveEquation}" href="#SpeedyWeather.initialize!-Tuple{AquaPlanetMask, PrimitiveEquation}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(
    land_sea_mask::AquaPlanetMask,
    model::PrimitiveEquation
)
</code></pre><p>Sets all grid points to 0 = sea.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/land_sea_mask.jl#L99">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{Barotropic}" href="#SpeedyWeather.initialize!-Tuple{Barotropic}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(
    model::Barotropic;
    time
) -&gt; Simulation{Model} where Model&lt;:Barotropic
</code></pre><p>Calls all <code>initialize!</code> functions for most fields, representing components, of <code>model</code>, except for <code>model.output</code> and <code>model.feedback</code> which are always called at in <code>time_stepping!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/models/barotropic.jl#L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{Clock, SpeedyWeather.AbstractTimeStepper}" href="#SpeedyWeather.initialize!-Tuple{Clock, SpeedyWeather.AbstractTimeStepper}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(
    clock::Clock,
    time_stepping::SpeedyWeather.AbstractTimeStepper
) -&gt; Clock
</code></pre><p>Initialize the clock with the time step <code>Δt</code> in the <code>time_stepping</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/clock.jl#L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{EarthOrography, SpeedyWeather.AbstractPlanet, SpectralTransform}" href="#SpeedyWeather.initialize!-Tuple{EarthOrography, SpeedyWeather.AbstractPlanet, SpectralTransform}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(
    orog::EarthOrography,
    P::SpeedyWeather.AbstractPlanet,
    S::SpectralTransform
) -&gt; LowerTriangularMatrix{Complex{NF}} where NF&lt;:AbstractFloat
</code></pre><p>Initialize the arrays <code>orography</code>, <code>geopot_surf</code> in <code>orog</code> by reading the orography field from file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/orography.jl#L152">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{Feedback, Clock, ModelSetup}" href="#SpeedyWeather.initialize!-Tuple{Feedback, Clock, ModelSetup}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(
    feedback::Feedback,
    clock::Clock,
    model::ModelSetup
) -&gt; ProgressMeter.Progress
</code></pre><p>Initializes the a <code>Feedback</code> struct.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/feedback.jl#L70">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{Geopotential, PrimitiveEquation}" href="#SpeedyWeather.initialize!-Tuple{Geopotential, PrimitiveEquation}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(
    geopotential::Geopotential,
    model::PrimitiveEquation
)
</code></pre><p>Precomputes constants for the vertical integration of the geopotential, defined as</p><p><code>Φ_{k+1/2} = Φ_{k+1} + R*T_{k+1}*(ln(p_{k+1}) - ln(p_{k+1/2}))</code> (half levels) <code>Φ_k = Φ_{k+1/2} + R*T_k*(ln(p_{k+1/2}) - ln(p_k))</code> (full levels)</p><p>Same formula but <code>k → k-1/2</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/geopotential.jl#L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{HeldSuarez, PrimitiveEquation}" href="#SpeedyWeather.initialize!-Tuple{HeldSuarez, PrimitiveEquation}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(scheme::HeldSuarez, model::PrimitiveEquation)
</code></pre><p>initialize the HeldSuarez temperature relaxation by precomputing terms for the equilibrium temperature Teq.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/temperature_relaxation.jl#L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{HumidityDiffusion, PrimitiveEquation}" href="#SpeedyWeather.initialize!-Tuple{HumidityDiffusion, PrimitiveEquation}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(
    scheme::HumidityDiffusion,
    model::PrimitiveEquation
) -&gt; Any
</code></pre><p>Initialize dry static energy diffusion.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/vertical_diffusion.jl#L102">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{HyperDiffusion, DiagnosticVariablesLayer, SpeedyWeather.AbstractGeometry, SpeedyWeather.AbstractTimeStepper}" href="#SpeedyWeather.initialize!-Tuple{HyperDiffusion, DiagnosticVariablesLayer, SpeedyWeather.AbstractGeometry, SpeedyWeather.AbstractTimeStepper}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(
    scheme::HyperDiffusion,
    diagn::DiagnosticVariablesLayer,
    G::SpeedyWeather.AbstractGeometry,
    L::SpeedyWeather.AbstractTimeStepper
)
</code></pre><p>Pre-function to other <code>initialize!(::HyperDiffusion)</code> initialisors that calculates the (absolute) vorticity maximum for the layer of <code>diagn</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/horizontal_diffusion.jl#L165">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{HyperDiffusion, ModelSetup}" href="#SpeedyWeather.initialize!-Tuple{HyperDiffusion, ModelSetup}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(scheme::HyperDiffusion, model::ModelSetup)
</code></pre><p>Precomputes the hyper diffusion terms in <code>scheme</code> based on the model time step, and possibly with a changing strength/power in the vertical.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/horizontal_diffusion.jl#L68">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{HyperDiffusion, SpeedyWeather.AbstractTimeStepper}" href="#SpeedyWeather.initialize!-Tuple{HyperDiffusion, SpeedyWeather.AbstractTimeStepper}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(
    scheme::HyperDiffusion,
    L::SpeedyWeather.AbstractTimeStepper
)
</code></pre><p>Precomputes the 2D hyper diffusion terms in <code>scheme</code> based on the model time step.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/horizontal_diffusion.jl#L84">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{ImplicitPrimitiveEquation, Real, DiagnosticVariables, SpeedyWeather.AbstractGeometry, SpeedyWeather.AbstractGeopotential, SpeedyWeather.AbstractAtmosphere, SpeedyWeather.AbstractAdiabaticConversion}" href="#SpeedyWeather.initialize!-Tuple{ImplicitPrimitiveEquation, Real, DiagnosticVariables, SpeedyWeather.AbstractGeometry, SpeedyWeather.AbstractGeopotential, SpeedyWeather.AbstractAtmosphere, SpeedyWeather.AbstractAdiabaticConversion}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(
    implicit::ImplicitPrimitiveEquation,
    dt::Real,
    diagn::DiagnosticVariables,
    geometry::SpeedyWeather.AbstractGeometry,
    geopotential::SpeedyWeather.AbstractGeopotential,
    atmosphere::SpeedyWeather.AbstractAtmosphere,
    adiabatic_conversion::SpeedyWeather.AbstractAdiabaticConversion
)
</code></pre><p>Initialize the implicit terms for the PrimitiveEquation models.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/implicit.jl#L206">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{ImplicitShallowWater, Real, SpeedyWeather.AbstractPlanet, SpeedyWeather.AbstractAtmosphere}" href="#SpeedyWeather.initialize!-Tuple{ImplicitShallowWater, Real, SpeedyWeather.AbstractPlanet, SpeedyWeather.AbstractAtmosphere}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(
    implicit::ImplicitShallowWater,
    dt::Real,
    planet::SpeedyWeather.AbstractPlanet,
    atmosphere::SpeedyWeather.AbstractAtmosphere
)
</code></pre><p>Update the implicit terms in <code>implicit</code> for the shallow water model as they depend on the time step <code>dt</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/implicit.jl#L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{JablonowskiRelaxation, PrimitiveEquation}" href="#SpeedyWeather.initialize!-Tuple{JablonowskiRelaxation, PrimitiveEquation}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(
    scheme::JablonowskiRelaxation,
    model::PrimitiveEquation
)
</code></pre><p>initialize the JablonowskiRelaxation temperature relaxation by precomputing terms for the equilibrium temperature Teq and the frequency (strength of relaxation).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/temperature_relaxation.jl#L179">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{LandSeaMask, PrimitiveEquation}" href="#SpeedyWeather.initialize!-Tuple{LandSeaMask, PrimitiveEquation}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(
    land_sea_mask::LandSeaMask,
    model::PrimitiveEquation
) -&gt; SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat
</code></pre><p>Reads a high-resolution land-sea mask from file and interpolates (grid-call average) onto the model grid for a fractional sea mask.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/land_sea_mask.jl#L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{Leapfrog, ModelSetup}" href="#SpeedyWeather.initialize!-Tuple{Leapfrog, ModelSetup}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(L::Leapfrog, model::ModelSetup)
</code></pre><p>Initialize leapfrogging <code>L</code> by recalculating the timestep given the output time step <code>output_dt</code> from <code>model.output</code>. Recalculating will slightly adjust the time step to be a divisor such that an integer number of time steps matches exactly with the output time step.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/time_integration.jl#L97">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{LinearDrag, PrimitiveEquation}" href="#SpeedyWeather.initialize!-Tuple{LinearDrag, PrimitiveEquation}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(scheme::LinearDrag, model::PrimitiveEquation)
</code></pre><p>Precomputes the drag coefficients for this <code>BoundaryLayerDrag</code> scheme.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/boundary_layer.jl#L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{PrimitiveDry}" href="#SpeedyWeather.initialize!-Tuple{PrimitiveDry}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(
    model::PrimitiveDry;
    time
) -&gt; Simulation{Model} where Model&lt;:PrimitiveDry
</code></pre><p>Calls all <code>initialize!</code> functions for components of <code>model</code>, except for <code>model.output</code> and <code>model.feedback</code> which are always called at in <code>time_stepping!</code> and <code>model.implicit</code> which is done in <code>first_timesteps!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/models/primitive_dry.jl#L91">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{PrimitiveWet}" href="#SpeedyWeather.initialize!-Tuple{PrimitiveWet}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(
    model::PrimitiveWet;
    time
) -&gt; Simulation{Model} where Model&lt;:PrimitiveWet
</code></pre><p>Calls all <code>initialize!</code> functions for components of <code>model</code>, except for <code>model.output</code> and <code>model.feedback</code> which are always called at in <code>time_stepping!</code> and <code>model.implicit</code> which is done in <code>first_timesteps!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/models/primitive_wet.jl#L105">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{PrognosticVariables, PressureOnOrography, PrimitiveEquation}" href="#SpeedyWeather.initialize!-Tuple{PrognosticVariables, PressureOnOrography, PrimitiveEquation}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(
    progn::PrognosticVariables,
    _::PressureOnOrography,
    model::PrimitiveEquation
) -&gt; LowerTriangularMatrix{Complex{NF}} where NF&lt;:AbstractFloat
</code></pre><p>Initialize surface pressure on orography by integrating the hydrostatic equation with the reference temperature lapse rate.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/initial_conditions.jl#L442">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{PrognosticVariables, StartFromFile, ModelSetup}" href="#SpeedyWeather.initialize!-Tuple{PrognosticVariables, StartFromFile, ModelSetup}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(
    progn_new::PrognosticVariables,
    initial_conditions::StartFromFile,
    model::ModelSetup
) -&gt; PrognosticVariables
</code></pre><p>Restart from a previous SpeedyWeather.jl simulation via the restart file restart.jld2 Applies interpolation in the horizontal but not in the vertical.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/initial_conditions.jl#L382">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{PrognosticVariables, ZonalJet, ModelSetup}" href="#SpeedyWeather.initialize!-Tuple{PrognosticVariables, ZonalJet, ModelSetup}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(
    progn::PrognosticVariables,
    initial_conditions::ZonalJet,
    model::ModelSetup
) -&gt; LowerTriangularMatrix{Complex{NF}} where NF&lt;:AbstractFloat
</code></pre><p>Initial conditions from Galewsky, 2004, Tellus</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/initial_conditions.jl#L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{Schedule, Clock}" href="#SpeedyWeather.initialize!-Tuple{Schedule, Clock}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(scheduler::Schedule, clock::Clock) -&gt; Schedule
</code></pre><p>Initialize a Schedule with a Clock (which is assumed to have been initialized). Takes both scheduler.every and scheduler.times into account, such that both periodic and events can be scheduled simulataneously. But execution will happen only once if they coincide on a given time step.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/schedule.jl#L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{ShallowWater}" href="#SpeedyWeather.initialize!-Tuple{ShallowWater}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(
    model::ShallowWater;
    time
) -&gt; Simulation{Model} where Model&lt;:ShallowWater
</code></pre><p>Calls all <code>initialize!</code> functions for most components (=fields) of <code>model</code>, except for <code>model.output</code> and <code>model.feedback</code> which are always initialized in <code>time_stepping!</code> and <code>model.implicit</code> which is done in <code>first_timesteps!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/models/shallow_water.jl#L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{StaticEnergyDiffusion, PrimitiveEquation}" href="#SpeedyWeather.initialize!-Tuple{StaticEnergyDiffusion, PrimitiveEquation}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(
    scheme::StaticEnergyDiffusion,
    model::PrimitiveEquation
) -&gt; Any
</code></pre><p>Initialize dry static energy diffusion.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/vertical_diffusion.jl#L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Tuple{ZonalRidge, SpeedyWeather.AbstractPlanet, SpectralTransform, Geometry}" href="#SpeedyWeather.initialize!-Tuple{ZonalRidge, SpeedyWeather.AbstractPlanet, SpectralTransform, Geometry}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(
    orog::ZonalRidge,
    P::SpeedyWeather.AbstractPlanet,
    S::SpectralTransform,
    G::Geometry
) -&gt; LowerTriangularMatrix{Complex{NF}} where NF&lt;:AbstractFloat
</code></pre><p>Initialize the arrays <code>orography</code>, <code>geopot_surf</code> in <code>orog</code> following  Jablonowski and Williamson, 2006.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/orography.jl#L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Union{Tuple{Model}, Tuple{output_NF}, Tuple{OutputWriter{output_NF, Model}, SpeedyWeather.AbstractFeedback, SpeedyWeather.AbstractTimeStepper, Clock, DiagnosticVariables, ModelSetup}} where {output_NF, Model}" href="#SpeedyWeather.initialize!-Union{Tuple{Model}, Tuple{output_NF}, Tuple{OutputWriter{output_NF, Model}, SpeedyWeather.AbstractFeedback, SpeedyWeather.AbstractTimeStepper, Clock, DiagnosticVariables, ModelSetup}} where {output_NF, Model}"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(
    output::OutputWriter{output_NF, Model},
    feedback::SpeedyWeather.AbstractFeedback,
    time_stepping::SpeedyWeather.AbstractTimeStepper,
    clock::Clock,
    diagn::DiagnosticVariables,
    model::ModelSetup
)
</code></pre><p>Creates a netcdf file on disk and the corresponding <code>netcdf_file</code> object preallocated with output variables and dimensions. <code>write_output!</code> then writes consecuitive time steps into this file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/output.jl#L152">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Union{Tuple{NF}, Tuple{GlobalSurfaceTemperatureCallback{NF}, PrognosticVariables, DiagnosticVariables, ModelSetup}} where NF" href="#SpeedyWeather.initialize!-Union{Tuple{NF}, Tuple{GlobalSurfaceTemperatureCallback{NF}, PrognosticVariables, DiagnosticVariables, ModelSetup}} where NF"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(
    callback::GlobalSurfaceTemperatureCallback{NF},
    progn::PrognosticVariables,
    diagn::DiagnosticVariables,
    model::ModelSetup
) -&gt; Int64
</code></pre><p>Initializes callback.temp vector that records the global mean surface temperature on every time step. Allocates vector of correct length (number of elements = total time steps plus one) and stores the global surface temperature of the initial conditions</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/callbacks.jl#L100">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, JablonowskiTemperature, ModelSetup}} where NF" href="#SpeedyWeather.initialize!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, JablonowskiTemperature, ModelSetup}} where NF"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(
    progn::PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF},
    initial_conditions::JablonowskiTemperature,
    model::ModelSetup
)
</code></pre><p>Initial conditions from Jablonowski and Williamson, 2006, QJR Meteorol. Soc</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/initial_conditions.jl#L310">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, RandomWaves, ShallowWater}} where NF" href="#SpeedyWeather.initialize!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, RandomWaves, ShallowWater}} where NF"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(
    progn::PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF},
    initial_conditions::RandomWaves,
    model::ShallowWater
)
</code></pre><p>Random initial conditions for the interface displacement η in the shallow water equations. The flow (u, v) is zero initially. This kicks off gravity waves that will interact with orography.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/initial_conditions.jl#L540">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, StartWithRandomVorticity, ModelSetup}} where NF" href="#SpeedyWeather.initialize!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, StartWithRandomVorticity, ModelSetup}} where NF"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(
    progn::PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF},
    initial_conditions::StartWithRandomVorticity,
    model::ModelSetup
)
</code></pre><p>Start with random vorticity as initial conditions</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/initial_conditions.jl#L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, ZonalWind, PrimitiveEquation}} where NF" href="#SpeedyWeather.initialize!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, ZonalWind, PrimitiveEquation}} where NF"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(
    progn::PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF},
    initial_conditions::ZonalWind,
    model::PrimitiveEquation
)
</code></pre><p>Initial conditions from Jablonowski and Williamson, 2006, QJR Meteorol. Soc</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/initial_conditions.jl#L223">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.initialize!-Union{Tuple{P}, Tuple{Vector{P}, ModelSetup}} where P&lt;:Particle" href="#SpeedyWeather.initialize!-Union{Tuple{P}, Tuple{Vector{P}, ModelSetup}} where P&lt;:Particle"><code>SpeedyWeather.initialize!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initialize!(
    particles::Array{P&lt;:Particle, 1},
    model::ModelSetup
)
</code></pre><p>Initialize particle locations uniformly in latitude, longitude and in the vertical σ coordinates. This uses a cosin-distribution in latitude for an equal-area uniformity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/particle_advection.jl#L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.isdecreasing-Tuple{AbstractVector}" href="#SpeedyWeather.isdecreasing-Tuple{AbstractVector}"><code>SpeedyWeather.isdecreasing</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">isdecreasing(v::AbstractVector) -&gt; Bool
</code></pre><p>Check whether elements of a vector <code>v</code> are strictly decreasing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/utility_functions.jl#L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.isincreasing-Tuple{AbstractVector}" href="#SpeedyWeather.isincreasing-Tuple{AbstractVector}"><code>SpeedyWeather.isincreasing</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">isincreasing(v::AbstractVector) -&gt; Bool
</code></pre><p>Check whether elements of a vector <code>v</code> are strictly increasing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/utility_functions.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.ismod-Tuple{Particle}" href="#SpeedyWeather.ismod-Tuple{Particle}"><code>SpeedyWeather.ismod</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ismod(p::Particle) -&gt; Bool
</code></pre><p>Check that a particle is in longitude [0,360˚E), latitude [-90˚,90˚N], and σ in [0,1].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/particles.jl#L142">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.isscheduled-Tuple{Schedule, Clock}" href="#SpeedyWeather.isscheduled-Tuple{Schedule, Clock}"><code>SpeedyWeather.isscheduled</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">isscheduled(S::Schedule, clock::Clock) -&gt; Bool
</code></pre><p>Evaluate whether (e.g. a callback) should be scheduled at the timestep given in clock. Returns true for scheduled executions, false for no execution on this time step.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/schedule.jl#L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.large_scale_condensation!-Union{Tuple{NF}, Tuple{ColumnVariables{NF}, ImplicitCondensation, SpeedyWeather.AbstractClausiusClapeyron, Geometry, SpeedyWeather.AbstractPlanet, SpeedyWeather.AbstractAtmosphere, SpeedyWeather.AbstractTimeStepper}} where NF" href="#SpeedyWeather.large_scale_condensation!-Union{Tuple{NF}, Tuple{ColumnVariables{NF}, ImplicitCondensation, SpeedyWeather.AbstractClausiusClapeyron, Geometry, SpeedyWeather.AbstractPlanet, SpeedyWeather.AbstractAtmosphere, SpeedyWeather.AbstractTimeStepper}} where NF"><code>SpeedyWeather.large_scale_condensation!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">large_scale_condensation!(
    column::ColumnVariables{NF},
    scheme::ImplicitCondensation,
    clausius_clapeyron::SpeedyWeather.AbstractClausiusClapeyron,
    geometry::Geometry,
    planet::SpeedyWeather.AbstractPlanet,
    atmosphere::SpeedyWeather.AbstractAtmosphere,
    time_stepping::SpeedyWeather.AbstractTimeStepper
)
</code></pre><p>Large-scale condensation for a <code>column</code> by relaxation back to 100% relative humidity. Calculates the tendencies for specific humidity and temperature from latent heat release and integrates the large-scale precipitation vertically for output.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/large_scale_condensation.jl#L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.launch_kernel!-Tuple{SpeedyWeather.DeviceSetup, Any, Any, Vararg{Any}}" href="#SpeedyWeather.launch_kernel!-Tuple{SpeedyWeather.DeviceSetup, Any, Any, Vararg{Any}}"><code>SpeedyWeather.launch_kernel!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">launch_kernel!(device_setup::DeviceSetup, kernel!, ndrange, kernel_args...)</code></pre><p>Launches the <code>kernel!</code> on the <code>device_setup</code> with <code>ndrange</code> computations over the kernel and arguments <code>kernel_args</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/gpu.jl#L91-L95">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.leapfrog!-Union{Tuple{NF}, Tuple{LowerTriangularMatrix{Complex{NF}}, LowerTriangularMatrix{Complex{NF}}, LowerTriangularMatrix{Complex{NF}}, Real, Int64, Leapfrog{NF}}} where NF&lt;:AbstractFloat" href="#SpeedyWeather.leapfrog!-Union{Tuple{NF}, Tuple{LowerTriangularMatrix{Complex{NF}}, LowerTriangularMatrix{Complex{NF}}, LowerTriangularMatrix{Complex{NF}}, Real, Int64, Leapfrog{NF}}} where NF&lt;:AbstractFloat"><code>SpeedyWeather.leapfrog!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">leapfrog!(
    A_old::LowerTriangularMatrix{Complex{NF&lt;:AbstractFloat}},
    A_new::LowerTriangularMatrix{Complex{NF&lt;:AbstractFloat}},
    tendency::LowerTriangularMatrix{Complex{NF&lt;:AbstractFloat}},
    dt::Real,
    lf::Int64,
    L::Leapfrog{NF&lt;:AbstractFloat}
)
</code></pre><p>Performs one leapfrog time step with (<code>lf=2</code>) or without (<code>lf=1</code>) Robert+Williams filter (see Williams (2009), Montly Weather Review, Eq. 7-9).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/time_integration.jl#L121">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.linear_pressure_gradient!-Tuple{DiagnosticVariablesLayer, SpeedyWeather.PrognosticSurfaceTimesteps, Int64, SpeedyWeather.AbstractAtmosphere, ImplicitPrimitiveEquation}" href="#SpeedyWeather.linear_pressure_gradient!-Tuple{DiagnosticVariablesLayer, SpeedyWeather.PrognosticSurfaceTimesteps, Int64, SpeedyWeather.AbstractAtmosphere, ImplicitPrimitiveEquation}"><code>SpeedyWeather.linear_pressure_gradient!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">linear_pressure_gradient!(
    diagn::DiagnosticVariablesLayer,
    surface::SpeedyWeather.PrognosticSurfaceTimesteps,
    lf::Int64,
    atmosphere::SpeedyWeather.AbstractAtmosphere,
    I::ImplicitPrimitiveEquation
) -&gt; Any
</code></pre><p>Add the linear contribution of the pressure gradient to the geopotential. The pressure gradient in the divergence equation takes the form</p><pre><code class="nohighlight hljs">-∇⋅(Rd * Tᵥ * ∇lnpₛ) = -∇⋅(Rd * Tᵥ&#39; * ∇lnpₛ) - ∇²(Rd * Tₖ * lnpₛ)</code></pre><p>So that the second term inside the Laplace operator can be added to the geopotential. Rd is the gas constant, Tᵥ the virtual temperature and Tᵥ&#39; its anomaly wrt to the average or reference temperature Tₖ, lnpₛ is the logarithm of surface pressure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/tendencies.jl#L707">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.linear_virtual_temperature!-Tuple{DiagnosticVariablesLayer, SpeedyWeather.PrognosticLayerTimesteps, PrimitiveDry, Integer}" href="#SpeedyWeather.linear_virtual_temperature!-Tuple{DiagnosticVariablesLayer, SpeedyWeather.PrognosticLayerTimesteps, PrimitiveDry, Integer}"><code>SpeedyWeather.linear_virtual_temperature!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">linear_virtual_temperature!(
    diagn::DiagnosticVariablesLayer,
    progn::SpeedyWeather.PrognosticLayerTimesteps,
    model::PrimitiveDry,
    lf::Integer
) -&gt; LowerTriangularMatrix{Complex{NF}} where NF&lt;:AbstractFloat
</code></pre><p>Linear virtual temperature for <code>model::PrimitiveDry</code>: Just copy over arrays from <code>temp</code> to <code>temp_virt</code> at timestep <code>lf</code> in spectral space as humidity is zero in this <code>model</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/virtual_temperature.jl#L53">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.linear_virtual_temperature!-Tuple{DiagnosticVariablesLayer, SpeedyWeather.PrognosticLayerTimesteps, SpeedyWeather.AbstractAtmosphere, Int64}" href="#SpeedyWeather.linear_virtual_temperature!-Tuple{DiagnosticVariablesLayer, SpeedyWeather.PrognosticLayerTimesteps, SpeedyWeather.AbstractAtmosphere, Int64}"><code>SpeedyWeather.linear_virtual_temperature!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">linear_virtual_temperature!(
    diagn::DiagnosticVariablesLayer,
    progn::SpeedyWeather.PrognosticLayerTimesteps,
    atmosphere::SpeedyWeather.AbstractAtmosphere,
    lf::Int64
) -&gt; Any
</code></pre><p>Calculates a linearised virtual temperature Tᵥ as</p><pre><code class="nohighlight hljs">Tᵥ = T + Tₖμq</code></pre><p>With absolute temperature T, layer-average temperarture Tₖ (computed in temperature_average!), specific humidity q and</p><pre><code class="nohighlight hljs">μ = (1-ξ)/ξ, ξ = R_dry/R_vapour.</code></pre><p>in spectral space.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/virtual_temperature.jl#L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.load_trajectory-Tuple{Union{String, Symbol}, ModelSetup}" href="#SpeedyWeather.load_trajectory-Tuple{Union{String, Symbol}, ModelSetup}"><code>SpeedyWeather.load_trajectory</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">load_trajectory(
    var_name::Union{String, Symbol},
    model::ModelSetup
) -&gt; Any
</code></pre><p>Loads a <code>var_name</code> trajectory of the model <code>M</code> that has been saved in a netCDF file during the time stepping.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/output.jl#L561">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.moist_static_energy!-Tuple{ColumnVariables, SpeedyWeather.AbstractClausiusClapeyron}" href="#SpeedyWeather.moist_static_energy!-Tuple{ColumnVariables, SpeedyWeather.AbstractClausiusClapeyron}"><code>SpeedyWeather.moist_static_energy!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">moist_static_energy!(
    column::ColumnVariables,
    clausius_clapeyron::SpeedyWeather.AbstractClausiusClapeyron
)
</code></pre><p>Compute the moist static energy</p><pre><code class="nohighlight hljs">MSE = SE + Lc*Q = cₚT + Φ + Lc*Q</code></pre><p>with the static energy <code>SE</code>, the latent heat of condensation <code>Lc</code>, the geopotential <code>Φ</code>. As well as the saturation moist static energy which replaces Q with Q_sat</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/thermodynamics.jl#L179">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.move-Union{Tuple{NF}, Tuple{Particle{NF, false}, Vararg{Any}}} where NF" href="#SpeedyWeather.move-Union{Tuple{NF}, Tuple{Particle{NF, false}, Vararg{Any}}} where NF"><code>SpeedyWeather.move</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">move(
    p::Particle{NF, false},
    args...
) -&gt; Particle{NF, false} where NF
</code></pre><p>Inactive particles are not moved.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/particles.jl#L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.move-Union{Tuple{NF}, Tuple{Particle{NF, true}, Any, Any, Any}} where NF" href="#SpeedyWeather.move-Union{Tuple{NF}, Tuple{Particle{NF, true}, Any, Any, Any}} where NF"><code>SpeedyWeather.move</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">move(
    p::Particle{NF, true},
    dlon,
    dlat,
    dσ
) -&gt; Particle{NF, true} where NF&lt;:AbstractFloat
</code></pre><p>Move a particle with increments (dlon, dlat, dσ) in those respective coordinates. Only active particles are moved.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/particles.jl#L95">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.move-Union{Tuple{NF}, Tuple{Particle{NF, true}, Any, Any}} where NF" href="#SpeedyWeather.move-Union{Tuple{NF}, Tuple{Particle{NF, true}, Any, Any}} where NF"><code>SpeedyWeather.move</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">move(
    p::Particle{NF, true},
    dlon,
    dlat
) -&gt; Particle{NF, true} where NF&lt;:AbstractFloat
</code></pre><p>Move a particle with increments (dlon, dlat) in 2D. No movement in vertical σ. Only active particles are moved.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/particles.jl#L103">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.nans-Tuple" href="#SpeedyWeather.nans-Tuple"><code>SpeedyWeather.nans</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">A = nans(dims...)</code></pre><p>Allocate A::Array{Float64} with NaNs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/utility_functions.jl#L69-L72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.nans-Union{Tuple{T}, Tuple{Type{T}, Vararg{Any}}} where T" href="#SpeedyWeather.nans-Union{Tuple{T}, Tuple{Type{T}, Vararg{Any}}} where T"><code>SpeedyWeather.nans</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">A = nans(T, dims...)</code></pre><p>Allocate array A with NaNs of type T. Similar to zeros(T, dims...).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/utility_functions.jl#L61-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.nar_detection!-Tuple{Feedback, PrognosticVariables}" href="#SpeedyWeather.nar_detection!-Tuple{Feedback, PrognosticVariables}"><code>SpeedyWeather.nar_detection!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">nar_detection!(
    feedback::Feedback,
    progn::PrognosticVariables
) -&gt; Union{Nothing, Bool}
</code></pre><p>Detect NaR (Not-a-Real) in the prognostic variables.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/feedback.jl#L154">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.parameterization_tendencies!-Tuple{DiagnosticVariables, PrognosticVariables, DateTime, PrimitiveEquation}" href="#SpeedyWeather.parameterization_tendencies!-Tuple{DiagnosticVariables, PrognosticVariables, DateTime, PrimitiveEquation}"><code>SpeedyWeather.parameterization_tendencies!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">parameterization_tendencies!(
    diagn::DiagnosticVariables,
    progn::PrognosticVariables,
    time::DateTime,
    model::PrimitiveEquation
) -&gt; Any
</code></pre><p>Compute tendencies for u, v, temp, humid from physical parametrizations. Extract for each vertical atmospheric column the prognostic variables (stored in <code>diagn</code> as they are grid-point transformed), loop over all grid-points, compute all parametrizations on a single-column basis, then write the tendencies back into a horizontal field of tendencies.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/tendencies.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.print_fields-Tuple{IO, Any, Any}" href="#SpeedyWeather.print_fields-Tuple{IO, Any, Any}"><code>SpeedyWeather.print_fields</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">print_fields(io::IO, A, keys; arrays)
</code></pre><p>Prints to <code>io</code> all fields of a struct <code>A</code> identified by their <code>keys</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/utility_functions.jl#L75">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.progress!-Tuple{Feedback}" href="#SpeedyWeather.progress!-Tuple{Feedback}"><code>SpeedyWeather.progress!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">progress!(feedback::Feedback)
</code></pre><p>Calls the progress meter and writes every 5% progress increase to txt.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/feedback.jl#L107">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.pseudo_adiabat!-Union{Tuple{NF}, Tuple{AbstractVector, NF, Real, AbstractVector, AbstractVector, Real, AbstractVector, SpeedyWeather.AbstractClausiusClapeyron}} where NF" href="#SpeedyWeather.pseudo_adiabat!-Union{Tuple{NF}, Tuple{AbstractVector, NF, Real, AbstractVector, AbstractVector, Real, AbstractVector, SpeedyWeather.AbstractClausiusClapeyron}} where NF"><code>SpeedyWeather.pseudo_adiabat!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">pseudo_adiabat!(
    temp_ref_profile::AbstractVector,
    temp_parcel,
    humid_parcel::Real,
    temp_virt_environment::AbstractVector,
    geopot::AbstractVector,
    pres::Real,
    σ::AbstractVector,
    clausius_clapeyron::SpeedyWeather.AbstractClausiusClapeyron
) -&gt; Int64
</code></pre><p>Calculates the moist pseudo adiabat given temperature and humidity of surface parcel. Follows the dry adiabat till condensation and then continues on the pseudo moist-adiabat with immediate condensation to the level of zero buoyancy. Levels above are skipped, set to NaN instead and should be skipped in the relaxation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/convection.jl#L165">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.readable_secs-Tuple{Real}" href="#SpeedyWeather.readable_secs-Tuple{Real}"><code>SpeedyWeather.readable_secs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">readable_secs(secs::Real) -&gt; Dates.CompoundPeriod
</code></pre><p>Returns <code>Dates.CompoundPeriod</code> rounding to either (days, hours), (hours, minutes), (minutes, seconds), or seconds with 1 decimal place accuracy for &gt;10s and two for less. E.g.</p><pre><code class="language- hljs">julia&gt; using SpeedyWeather: readable_secs

julia&gt; readable_secs(12345)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/feedback.jl#L224">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.remaining_time-Tuple{ProgressMeter.Progress}" href="#SpeedyWeather.remaining_time-Tuple{ProgressMeter.Progress}"><code>SpeedyWeather.remaining_time</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">remaining_time(p::ProgressMeter.Progress) -&gt; String
</code></pre><p>Estimates the remaining time from a <code>ProgresssMeter.Progress</code>. Adapted from ProgressMeter.jl</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/feedback.jl#L174">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.reset_column!-Union{Tuple{ColumnVariables{NF}}, Tuple{NF}} where NF" href="#SpeedyWeather.reset_column!-Union{Tuple{ColumnVariables{NF}}, Tuple{NF}} where NF"><code>SpeedyWeather.reset_column!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">reset_column!(column::ColumnVariables{NF})
</code></pre><p>Set the accumulators (tendencies but also vertical sums and similar) back to zero for <code>column</code> to be reused at other grid points.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/column_variables.jl#L127">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.run!-Tuple{SpeedyWeather.AbstractSimulation}" href="#SpeedyWeather.run!-Tuple{SpeedyWeather.AbstractSimulation}"><code>SpeedyWeather.run!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">run!(
    simulation::SpeedyWeather.AbstractSimulation;
    period,
    output,
    n_days
) -&gt; PrognosticVariables
</code></pre><p>Run a SpeedyWeather.jl <code>simulation</code>. The <code>simulation.model</code> is assumed to be initialized.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/models/simulation.jl#L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.saturation_humidity!-Tuple{ColumnVariables, SpeedyWeather.AbstractClausiusClapeyron}" href="#SpeedyWeather.saturation_humidity!-Tuple{ColumnVariables, SpeedyWeather.AbstractClausiusClapeyron}"><code>SpeedyWeather.saturation_humidity!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">saturation_humidity!(
    column::ColumnVariables,
    clausius_clapeyron::SpeedyWeather.AbstractClausiusClapeyron
)
</code></pre><p>Compute the saturation water vapour pressure [Pa], the saturation humidity [kg/kg] and the relative humidity following <code>clausius_clapeyron</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/thermodynamics.jl#L165">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.saturation_humidity-Union{Tuple{NF}, Tuple{NF, NF, SpeedyWeather.AbstractClausiusClapeyron}} where NF" href="#SpeedyWeather.saturation_humidity-Union{Tuple{NF}, Tuple{NF, NF, SpeedyWeather.AbstractClausiusClapeyron}} where NF"><code>SpeedyWeather.saturation_humidity</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">saturation_humidity(
    temp_kelvin,
    pres,
    clausius_clapeyron::SpeedyWeather.AbstractClausiusClapeyron
) -&gt; Any
</code></pre><p>Saturation humidity [kg/kg] from temperature [K], pressure [Pa] via</p><pre><code class="nohighlight hljs">sat_vap_pres = clausius_clapeyron(temperature)
saturation humidity = mol_ratio * sat_vap_pres / pressure</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/thermodynamics.jl#L95">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.saturation_humidity-Union{Tuple{NF}, Tuple{NF, NF}} where NF" href="#SpeedyWeather.saturation_humidity-Union{Tuple{NF}, Tuple{NF, NF}} where NF"><code>SpeedyWeather.saturation_humidity</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">saturation_humidity(sat_vap_pres, pres; mol_ratio) -&gt; Any
</code></pre><p>Saturation humidity from saturation vapour pressure and pressure via</p><pre><code class="nohighlight hljs">qsat = mol_ratio*sat_vap_pres/pres</code></pre><p>with both pressures in same units and qsat in kg/kg.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/thermodynamics.jl#L77">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.scale!-Tuple{PrognosticVariables, Real}" href="#SpeedyWeather.scale!-Tuple{PrognosticVariables, Real}"><code>SpeedyWeather.scale!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">scale!(progn::PrognosticVariables, scale::Real) -&gt; Real
</code></pre><p>Scales the prognostic variables vorticity and divergence with the Earth&#39;s radius which is used in the dynamical core.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/scaling.jl#L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.scale!-Tuple{PrognosticVariables, Symbol, Real}" href="#SpeedyWeather.scale!-Tuple{PrognosticVariables, Symbol, Real}"><code>SpeedyWeather.scale!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">scale!(progn::PrognosticVariables, var::Symbol, scale::Real)
</code></pre><p>Scale the variable <code>var</code> inside <code>progn</code> with scalar <code>scale</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/scaling.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.set_divergence!-Tuple{PrognosticVariables, Vararg{Any}}" href="#SpeedyWeather.set_divergence!-Tuple{PrognosticVariables, Vararg{Any}}"><code>SpeedyWeather.set_divergence!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_divergence!(progn::PrognosticVariables, varargs...; kwargs...)</code></pre><p>See <a href="#SpeedyWeather.set_var!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Symbol, Number}} where NF"><code>set_var!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/prognostic_variables.jl#L322-L326">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.set_humidity!-Tuple{PrognosticVariables, Vararg{Any}}" href="#SpeedyWeather.set_humidity!-Tuple{PrognosticVariables, Vararg{Any}}"><code>SpeedyWeather.set_humidity!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_humidity!(progn::PrognosticVariables, varargs...; kwargs...)</code></pre><p>See <a href="#SpeedyWeather.set_var!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Symbol, Number}} where NF"><code>set_var!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/prognostic_variables.jl#L336-L340">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.set_period!-Tuple{Clock, Dates.Period}" href="#SpeedyWeather.set_period!-Tuple{Clock, Dates.Period}"><code>SpeedyWeather.set_period!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_period!(clock::Clock, period::Dates.Period) -&gt; Second
</code></pre><p>Set the <code>period</code> of the clock to a new value. Converts any <code>Dates.Period</code> input to <code>Second</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/clock.jl#L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.set_period!-Tuple{Clock, Real}" href="#SpeedyWeather.set_period!-Tuple{Clock, Real}"><code>SpeedyWeather.set_period!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_period!(clock::Clock, period::Real) -&gt; Any
</code></pre><p>Set the <code>period</code> of the clock to a new value. Converts any <code>::Real</code> input to <code>Day</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/clock.jl#L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.set_pressure!-Tuple{PrognosticVariables, AbstractMatrix}" href="#SpeedyWeather.set_pressure!-Tuple{PrognosticVariables, AbstractMatrix}"><code>SpeedyWeather.set_pressure!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_pressure!(progn::PrognosticVariables{NF},
              pressure::AbstractMatrix,
              Grid::Type{&lt;:AbstractGrid},
              lf::Integer=1) where NF</code></pre><p>Sets the prognostic variable with the surface pressure in grid space at leapfrog index <code>lf</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/prognostic_variables.jl#L380-L387">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.set_pressure!-Tuple{PrognosticVariables, LowerTriangularMatrix}" href="#SpeedyWeather.set_pressure!-Tuple{PrognosticVariables, LowerTriangularMatrix}"><code>SpeedyWeather.set_pressure!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_pressure!(progn::PrognosticVariables{NF},
              pressure::LowerTriangularMatrix;
              lf::Integer=1) where NF</code></pre><p>Sets the prognostic variable with the surface pressure in spectral space at leapfrog index <code>lf</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/prognostic_variables.jl#L343-L349">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.set_pressure!-Tuple{PrognosticVariables, SpeedyWeather.RingGrids.AbstractGrid, ModelSetup}" href="#SpeedyWeather.set_pressure!-Tuple{PrognosticVariables, SpeedyWeather.RingGrids.AbstractGrid, ModelSetup}"><code>SpeedyWeather.set_pressure!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_pressure!(progn::PrognosticVariables{NF},
              pressure::AbstractGrid,
              M::ModelSetup;
              lf::Integer=1) where NF</code></pre><p>Sets the prognostic variable with the surface pressure in grid space at leapfrog index <code>lf</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/prognostic_variables.jl#L359-L366">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.set_pressure!-Tuple{PrognosticVariables, SpeedyWeather.RingGrids.AbstractGrid}" href="#SpeedyWeather.set_pressure!-Tuple{PrognosticVariables, SpeedyWeather.RingGrids.AbstractGrid}"><code>SpeedyWeather.set_pressure!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_pressure!(progn::PrognosticVariables{NF},
              pressure::AbstractGrid,
              lf::Integer=1) where NF</code></pre><p>Sets the prognostic variable with the surface pressure in grid space at leapfrog index <code>lf</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/prognostic_variables.jl#L370-L376">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.set_temperature!-Tuple{PrognosticVariables, Vararg{Any}}" href="#SpeedyWeather.set_temperature!-Tuple{PrognosticVariables, Vararg{Any}}"><code>SpeedyWeather.set_temperature!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_temperature!(progn::PrognosticVariables, varargs...; kwargs...)</code></pre><p>See <a href="#SpeedyWeather.set_var!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Symbol, Number}} where NF"><code>set_var!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/prognostic_variables.jl#L329-L333">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.set_var!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Symbol, Number}} where NF" href="#SpeedyWeather.set_var!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Symbol, Number}} where NF"><code>SpeedyWeather.set_var!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">function set_var!(progn::PrognosticVariables{NF},
                  varname::Symbol,
                  s::Number;
                  lf::Integer=1) where NF</code></pre><p>Sets all values of prognostic variable <code>varname</code> at leapfrog index <code>lf</code> to the scalar <code>s</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/prognostic_variables.jl#L295-L302">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.set_var!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Symbol, Vector{&lt;:AbstractMatrix}}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Symbol, Vector{&lt;:AbstractMatrix}, Type{&lt;:SpeedyWeather.RingGrids.AbstractGrid}}} where NF" href="#SpeedyWeather.set_var!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Symbol, Vector{&lt;:AbstractMatrix}}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Symbol, Vector{&lt;:AbstractMatrix}, Type{&lt;:SpeedyWeather.RingGrids.AbstractGrid}}} where NF"><code>SpeedyWeather.set_var!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_var!(progn::PrognosticVariables{NF},
         varname::Symbol,
         var::Vector{&lt;:AbstractMatrix},
         Grid::Type{&lt;:AbstractGrid}=FullGaussianGrid;
         lf::Integer=1) where NF</code></pre><p>Sets the prognostic variable with the name <code>varname</code> in all layers at leapfrog index <code>lf</code>  with values given in <code>var</code> a vector with all information for all layers in grid space.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/prognostic_variables.jl#L272-L281">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.set_var!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Symbol, Vector{&lt;:LowerTriangularMatrix}}} where NF" href="#SpeedyWeather.set_var!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Symbol, Vector{&lt;:LowerTriangularMatrix}}} where NF"><code>SpeedyWeather.set_var!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_var!(progn::PrognosticVariables{NF},        
         varname::Symbol,
         var::Vector{&lt;:LowerTriangularMatrix};
         lf::Integer=1) where NF</code></pre><p>Sets the prognostic variable with the name <code>varname</code> in all layers at leapfrog index <code>lf</code>  with values given in <code>var</code> a vector with all information for all layers in spectral space.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/prognostic_variables.jl#L200-L208">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.set_var!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Symbol, Vector{&lt;:SpeedyWeather.RingGrids.AbstractGrid}, ModelSetup}} where NF" href="#SpeedyWeather.set_var!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Symbol, Vector{&lt;:SpeedyWeather.RingGrids.AbstractGrid}, ModelSetup}} where NF"><code>SpeedyWeather.set_var!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_var!(progn::PrognosticVariables{NF},
         varname::Symbol,
         var::Vector{&lt;:AbstractGrid},
         M::ModelSetup;
         lf::Integer=1) where NF</code></pre><p>Sets the prognostic variable with the name <code>varname</code> in all layers at leapfrog index <code>lf</code>  with values given in <code>var</code> a vector with all information for all layers in grid space.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/prognostic_variables.jl#L249-L258">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.set_var!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Symbol, Vector{&lt;:SpeedyWeather.RingGrids.AbstractGrid}}} where NF" href="#SpeedyWeather.set_var!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Symbol, Vector{&lt;:SpeedyWeather.RingGrids.AbstractGrid}}} where NF"><code>SpeedyWeather.set_var!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_var!(progn::PrognosticVariables{NF},        
         varname::Symbol,
         var::Vector{&lt;:AbstractGrid};
         lf::Integer=1) where NF</code></pre><p>Sets the prognostic variable with the name <code>varname</code> in all layers at leapfrog index <code>lf</code>  with values given in <code>var</code> a vector with all information for all layers in grid space.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/prognostic_variables.jl#L230-L238">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.set_vorticity!-Tuple{PrognosticVariables, Vararg{Any}}" href="#SpeedyWeather.set_vorticity!-Tuple{PrognosticVariables, Vararg{Any}}"><code>SpeedyWeather.set_vorticity!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">set_vorticity!(progn::PrognosticVariables, varargs...; kwargs...)</code></pre><p>See <a href="#SpeedyWeather.set_var!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Symbol, Number}} where NF"><code>set_var!</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/prognostic_variables.jl#L315-L319">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.sigma_okay-Tuple{Integer, AbstractVector}" href="#SpeedyWeather.sigma_okay-Tuple{Integer, AbstractVector}"><code>SpeedyWeather.sigma_okay</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">sigma_okay(nlev::Integer, σ_half::AbstractVector) -&gt; Bool
</code></pre><p>Check that nlev and σ_half match.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/vertical_coordinates.jl#L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.solar_hour_angle-Union{Tuple{T}, Tuple{Type{T}, DateTime, Any, Second}} where T" href="#SpeedyWeather.solar_hour_angle-Union{Tuple{T}, Tuple{Type{T}, DateTime, Any, Second}} where T"><code>SpeedyWeather.solar_hour_angle</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">solar_hour_angle(
    _::Type{T},
    time::DateTime,
    λ,
    length_of_day::Second
) -&gt; Any
</code></pre><p>Fraction of day as angle in radians [0...2π]. TODO: Takes length of day as argument, but a call to Dates.Time() currently have this hardcoded anyway.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/zenith.jl#L181">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.speedstring-Tuple{Any, Any}" href="#SpeedyWeather.speedstring-Tuple{Any, Any}"><code>SpeedyWeather.speedstring</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">speedstring(sec_per_iter, dt_in_sec) -&gt; String
</code></pre><p>Define a ProgressMeter.speedstring method that also takes a time step <code>dt_in_sec</code> to translate sec/iteration to days/days-like speeds.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/feedback.jl#L190">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.static_energy_diffusion!-Tuple{ColumnVariables, StaticEnergyDiffusion}" href="#SpeedyWeather.static_energy_diffusion!-Tuple{ColumnVariables, StaticEnergyDiffusion}"><code>SpeedyWeather.static_energy_diffusion!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">static_energy_diffusion!(
    column::ColumnVariables,
    scheme::StaticEnergyDiffusion
)
</code></pre><p>Apply dry static energy diffusion.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/vertical_diffusion.jl#L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.surface_pressure_tendency!-Tuple{SpeedyWeather.SurfaceVariables, SpectralTransform}" href="#SpeedyWeather.surface_pressure_tendency!-Tuple{SpeedyWeather.SurfaceVariables, SpectralTransform}"><code>SpeedyWeather.surface_pressure_tendency!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">surface_pressure_tendency!( Prog::PrognosticVariables,
                            Diag::DiagnosticVariables,
                            lf::Int,
                            M::PrimitiveEquation)</code></pre><p>Computes the tendency of the logarithm of surface pressure as</p><pre><code class="nohighlight hljs">-(ū*px + v̄*py) - D̄</code></pre><p>with ū, v̄ being the vertically averaged velocities; px, py the gradients of the logarithm of surface pressure ln(p_s) and D̄ the vertically averaged divergence.</p><ol><li>Calculate ∇ln(p_s) in spectral space, convert to grid.</li><li>Multiply ū, v̄ with ∇ln(p_s) in grid-point space, convert to spectral.</li><li>D̄ is subtracted in spectral space.</li><li>Set tendency of the l=m=0 mode to 0 for better mass conservation.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/tendencies.jl#L247-L262">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.temperature_anomaly!-Tuple{DiagnosticVariablesLayer, ImplicitPrimitiveEquation}" href="#SpeedyWeather.temperature_anomaly!-Tuple{DiagnosticVariablesLayer, ImplicitPrimitiveEquation}"><code>SpeedyWeather.temperature_anomaly!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Convert absolute and virtual temperature to anomalies wrt to the reference profile</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/tendencies.jl#L174">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.temperature_average!-Tuple{DiagnosticVariablesLayer, LowerTriangularMatrix, SpectralTransform}" href="#SpeedyWeather.temperature_average!-Tuple{DiagnosticVariablesLayer, LowerTriangularMatrix, SpectralTransform}"><code>SpeedyWeather.temperature_average!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">temperature_average!(
    diagn::DiagnosticVariablesLayer,
    temp::LowerTriangularMatrix,
    S::SpectralTransform
) -&gt; Any
</code></pre><p>Calculates the average temperature of a layer from the l=m=0 harmonic and stores the result in <code>diagn.temp_average</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/tendencies.jl#L897-L901">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.temperature_relaxation!-Tuple{ColumnVariables, HeldSuarez, SpeedyWeather.AbstractAtmosphere}" href="#SpeedyWeather.temperature_relaxation!-Tuple{ColumnVariables, HeldSuarez, SpeedyWeather.AbstractAtmosphere}"><code>SpeedyWeather.temperature_relaxation!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">temperature_relaxation!(
    column::ColumnVariables,
    scheme::HeldSuarez,
    atmosphere::SpeedyWeather.AbstractAtmosphere
)
</code></pre><p>Apply temperature relaxation following Held and Suarez 1996, BAMS.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/temperature_relaxation.jl#L106">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.temperature_relaxation!-Tuple{ColumnVariables, JablonowskiRelaxation}" href="#SpeedyWeather.temperature_relaxation!-Tuple{ColumnVariables, JablonowskiRelaxation}"><code>SpeedyWeather.temperature_relaxation!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">temperature_relaxation!(
    column::ColumnVariables,
    scheme::JablonowskiRelaxation
)
</code></pre><p>Apply HeldSuarez-like temperature relaxation to the Jablonowski and Williamson vertical profile.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/temperature_relaxation.jl#L232">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.temperature_tendency!-Tuple{DiagnosticVariablesLayer, SpeedyWeather.AbstractAdiabaticConversion, SpeedyWeather.AbstractAtmosphere, Geometry, SpectralTransform, ImplicitPrimitiveEquation}" href="#SpeedyWeather.temperature_tendency!-Tuple{DiagnosticVariablesLayer, SpeedyWeather.AbstractAdiabaticConversion, SpeedyWeather.AbstractAtmosphere, Geometry, SpectralTransform, ImplicitPrimitiveEquation}"><code>SpeedyWeather.temperature_tendency!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">temperature_tendency!(
    diagn::DiagnosticVariablesLayer,
    adiabatic_conversion::SpeedyWeather.AbstractAdiabaticConversion,
    atmosphere::SpeedyWeather.AbstractAtmosphere,
    G::Geometry,
    S::SpectralTransform,
    I::ImplicitPrimitiveEquation
)
</code></pre><p>Compute the temperature tendency</p><pre><code class="nohighlight hljs">∂T/∂t += -∇⋅((u, v)*T&#39;) + T&#39;D + κTᵥ*Dlnp/Dt</code></pre><p><code>+=</code> because the tendencies already contain parameterizations and vertical advection. <code>T&#39;</code> is the anomaly with respect to the reference/average temperature. Tᵥ is the virtual temperature used in the adiabatic term κTᵥ*Dlnp/Dt.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/tendencies.jl#L448">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.tendencies_physics_only!" href="#SpeedyWeather.tendencies_physics_only!"><code>SpeedyWeather.tendencies_physics_only!</code></a> — <span class="docstring-category">Function</span></header><section><div><p>For dynamics=false, after calling parameterization_tendencies! call this function to transform the physics tendencies from grid-point to spectral space including the necessary coslat⁻¹ scaling.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/tendencies.jl#L398-L401">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.time_stepping!-Tuple{PrognosticVariables, DiagnosticVariables, ModelSetup}" href="#SpeedyWeather.time_stepping!-Tuple{PrognosticVariables, DiagnosticVariables, ModelSetup}"><code>SpeedyWeather.time_stepping!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">time_stepping!(
    progn::PrognosticVariables,
    diagn::DiagnosticVariables,
    model::ModelSetup
) -&gt; PrognosticVariables
</code></pre><p>Main time loop that that initializes output and feedback, loops over all time steps and calls the output and feedback functions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/time_integration.jl#L371">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.timestep!" href="#SpeedyWeather.timestep!"><code>SpeedyWeather.timestep!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">timestep!(
    progn::PrognosticVariables,
    diagn::DiagnosticVariables,
    dt::Real,
    model::Barotropic
)
timestep!(
    progn::PrognosticVariables,
    diagn::DiagnosticVariables,
    dt::Real,
    model::Barotropic,
    lf1::Int64
)
timestep!(
    progn::PrognosticVariables,
    diagn::DiagnosticVariables,
    dt::Real,
    model::Barotropic,
    lf1::Int64,
    lf2::Int64
)
</code></pre><p>Calculate a single time step for the <code>model &lt;: Barotropic</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/time_integration.jl#L239">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.timestep!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, DiagnosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Real, PrimitiveEquation}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, DiagnosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Real, PrimitiveEquation, Int64}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, DiagnosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Real, PrimitiveEquation, Int64, Int64}} where NF&lt;:AbstractFloat" href="#SpeedyWeather.timestep!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, DiagnosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Real, PrimitiveEquation}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, DiagnosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Real, PrimitiveEquation, Int64}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, DiagnosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Real, PrimitiveEquation, Int64, Int64}} where NF&lt;:AbstractFloat"><code>SpeedyWeather.timestep!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">timestep!(
    progn::PrognosticVariables{NF&lt;:AbstractFloat, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF&lt;:AbstractFloat},
    diagn::DiagnosticVariables{NF&lt;:AbstractFloat, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF&lt;:AbstractFloat},
    dt::Real,
    model::PrimitiveEquation
) -&gt; Any
timestep!(
    progn::PrognosticVariables{NF&lt;:AbstractFloat, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF&lt;:AbstractFloat},
    diagn::DiagnosticVariables{NF&lt;:AbstractFloat, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF&lt;:AbstractFloat},
    dt::Real,
    model::PrimitiveEquation,
    lf1::Int64
) -&gt; Any
timestep!(
    progn::PrognosticVariables{NF&lt;:AbstractFloat, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF&lt;:AbstractFloat},
    diagn::DiagnosticVariables{NF&lt;:AbstractFloat, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF&lt;:AbstractFloat},
    dt::Real,
    model::PrimitiveEquation,
    lf1::Int64,
    lf2::Int64
) -&gt; Any
</code></pre><p>Calculate a single time step for the <code>model&lt;:PrimitiveEquation</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/time_integration.jl#L311">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.timestep!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, DiagnosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Real, ShallowWater}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, DiagnosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Real, ShallowWater, Int64}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, DiagnosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Real, ShallowWater, Int64, Int64}} where NF&lt;:AbstractFloat" href="#SpeedyWeather.timestep!-Union{Tuple{NF}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, DiagnosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Real, ShallowWater}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, DiagnosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Real, ShallowWater, Int64}, Tuple{PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, DiagnosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Real, ShallowWater, Int64, Int64}} where NF&lt;:AbstractFloat"><code>SpeedyWeather.timestep!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">timestep!(
    progn::PrognosticVariables{NF&lt;:AbstractFloat, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF&lt;:AbstractFloat},
    diagn::DiagnosticVariables{NF&lt;:AbstractFloat, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF&lt;:AbstractFloat},
    dt::Real,
    model::ShallowWater
)
timestep!(
    progn::PrognosticVariables{NF&lt;:AbstractFloat, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF&lt;:AbstractFloat},
    diagn::DiagnosticVariables{NF&lt;:AbstractFloat, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF&lt;:AbstractFloat},
    dt::Real,
    model::ShallowWater,
    lf1::Int64
)
timestep!(
    progn::PrognosticVariables{NF&lt;:AbstractFloat, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF&lt;:AbstractFloat},
    diagn::DiagnosticVariables{NF&lt;:AbstractFloat, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF&lt;:AbstractFloat},
    dt::Real,
    model::ShallowWater,
    lf1::Int64,
    lf2::Int64
)
</code></pre><p>Calculate a single time step for the <code>model &lt;: ShallowWater</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/time_integration.jl#L269">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.tree-Tuple{Any}" href="#SpeedyWeather.tree-Tuple{Any}"><code>SpeedyWeather.tree</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">tree(S; modules, kwargs...)
</code></pre><p>Create a tree of fields inside S and fields within these fields as long as they are defined within the modules argument (default SpeedyWeather). Other keyword arguments are <code>max_level::Integer=10</code>, <code>with_types::Bool=false</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/models/tree.jl#L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.tree-Tuple{ModelSetup}" href="#SpeedyWeather.tree-Tuple{ModelSetup}"><code>SpeedyWeather.tree</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">tree(M::ModelSetup; modules, kwargs...)
</code></pre><p>Create a tree of fields inside a model and fields within these fields as long as they are defined within the modules argument (default SpeedyWeather). Other keyword arguments are <code>max_level::Integer=10</code>, <code>with_types::Bool=false</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/models/tree.jl#L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.tree-Union{Tuple{Simulation{M}}, Tuple{M}} where M" href="#SpeedyWeather.tree-Union{Tuple{Simulation{M}}, Tuple{M}} where M"><code>SpeedyWeather.tree</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">tree(S::Simulation{M}; modules, kwargs...)
</code></pre><p>Create a tree of fields inside a Simulation instance and fields within these fields as long as they are defined within the modules argument (default SpeedyWeather). Other keyword arguments are <code>max_level::Integer=10</code>, <code>with_types::Bool=false</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/models/tree.jl#L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.underflow!-Union{Tuple{T}, Tuple{AbstractArray{T}, Real}} where T" href="#SpeedyWeather.underflow!-Union{Tuple{T}, Tuple{AbstractArray{T}, Real}} where T"><code>SpeedyWeather.underflow!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">underflow!(A::AbstractArray, ϵ::Real)</code></pre><p>Underflows element <code>a</code> in <code>A</code> to zero if <code>abs(a) &lt; ϵ</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/utility_functions.jl#L34-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.unscale!-Tuple{AbstractArray, Real}" href="#SpeedyWeather.unscale!-Tuple{AbstractArray, Real}"><code>SpeedyWeather.unscale!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">unscale!(variable::AbstractArray, scale::Real) -&gt; Any
</code></pre><p>Undo the radius-scaling for any variable. Method used for netcdf output.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/scaling.jl#L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.unscale!-Tuple{PrognosticVariables}" href="#SpeedyWeather.unscale!-Tuple{PrognosticVariables}"><code>SpeedyWeather.unscale!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">unscale!(progn::PrognosticVariables) -&gt; Int64
</code></pre><p>Undo the radius-scaling of vorticity and divergence from scale!(progn, scale::Real).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/scaling.jl#L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.vertical_integration!-Union{Tuple{NF}, Tuple{DiagnosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Int64, Geometry{NF}}} where NF" href="#SpeedyWeather.vertical_integration!-Union{Tuple{NF}, Tuple{DiagnosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, PrognosticVariables{NF, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{NF}, Int64, Geometry{NF}}} where NF"><code>SpeedyWeather.vertical_integration!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">vertical_integration!(Diag::DiagnosticVariables, G::Geometry)</code></pre><p>Calculates the vertically averaged (weighted by the thickness of the σ level) velocities (*coslat) and divergence. E.g.</p><pre><code class="nohighlight hljs">u_mean = ∑_k=1^nlev Δσ_k * u_k</code></pre><p>u, v are averaged in grid-point space, divergence in spectral space.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/tendencies.jl#L187-L196">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.vertical_interpolate!-Tuple{Vector, Vector, Geometry}" href="#SpeedyWeather.vertical_interpolate!-Tuple{Vector, Vector, Geometry}"><code>SpeedyWeather.vertical_interpolate!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">vertical_interpolate!(
    A_half::Vector,
    A_full::Vector,
    G::Geometry
)
</code></pre><p>Given a vector in column defined at full levels, do a linear interpolation in log(σ) to calculate its values at half-levels, skipping top (k=1/2), extrapolating to bottom (k=NLEV+1/2).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/geometry.jl#L134">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.virtual_temperature!-Tuple{DiagnosticVariablesLayer, LowerTriangularMatrix, PrimitiveDry}" href="#SpeedyWeather.virtual_temperature!-Tuple{DiagnosticVariablesLayer, LowerTriangularMatrix, PrimitiveDry}"><code>SpeedyWeather.virtual_temperature!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">virtual_temperature!(
    diagn::DiagnosticVariablesLayer,
    temp::LowerTriangularMatrix,
    model::PrimitiveDry
) -&gt; SpeedyWeather.RingGrids.AbstractGrid{NF} where NF&lt;:AbstractFloat
</code></pre><p>Virtual temperature in grid-point space: For the PrimitiveDry temperature and virtual temperature are the same (humidity=0). Just copy over the arrays.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/virtual_temperature.jl#L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.virtual_temperature!-Tuple{DiagnosticVariablesLayer, LowerTriangularMatrix, SpeedyWeather.AbstractAtmosphere}" href="#SpeedyWeather.virtual_temperature!-Tuple{DiagnosticVariablesLayer, LowerTriangularMatrix, SpeedyWeather.AbstractAtmosphere}"><code>SpeedyWeather.virtual_temperature!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">virtual_temperature!(
    diagn::DiagnosticVariablesLayer,
    temp::LowerTriangularMatrix,
    atmosphere::SpeedyWeather.AbstractAtmosphere
)
</code></pre><p>Calculates the virtual temperature Tᵥ as</p><pre><code class="nohighlight hljs">Tᵥ = T(1+μq)</code></pre><p>With absolute temperature T, specific humidity q and</p><pre><code class="nohighlight hljs">μ = (1-ξ)/ξ, ξ = R_dry/R_vapour.</code></pre><p>in grid-point space.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/virtual_temperature.jl#L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.volume_flux_divergence!-Tuple{DiagnosticVariablesLayer, SpeedyWeather.SurfaceVariables, SpeedyWeather.AbstractOrography, SpeedyWeather.AbstractAtmosphere, SpeedyWeather.AbstractGeometry, SpectralTransform}" href="#SpeedyWeather.volume_flux_divergence!-Tuple{DiagnosticVariablesLayer, SpeedyWeather.SurfaceVariables, SpeedyWeather.AbstractOrography, SpeedyWeather.AbstractAtmosphere, SpeedyWeather.AbstractGeometry, SpectralTransform}"><code>SpeedyWeather.volume_flux_divergence!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">volume_flux_divergence!(
    diagn::DiagnosticVariablesLayer,
    surface::SpeedyWeather.SurfaceVariables,
    orog::SpeedyWeather.AbstractOrography,
    atmosphere::SpeedyWeather.AbstractAtmosphere,
    G::SpeedyWeather.AbstractGeometry,
    S::SpectralTransform
)
</code></pre><p>Computes the (negative) divergence of the volume fluxes <code>uh, vh</code> for the continuity equation, -∇⋅(uh, vh).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/tendencies.jl#L736">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.vordiv_tendencies!-Tuple{DiagnosticVariablesLayer, SpeedyWeather.SurfaceVariables, PrimitiveEquation}" href="#SpeedyWeather.vordiv_tendencies!-Tuple{DiagnosticVariablesLayer, SpeedyWeather.SurfaceVariables, PrimitiveEquation}"><code>SpeedyWeather.vordiv_tendencies!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">vordiv_tendencies!(
    diagn::DiagnosticVariablesLayer,
    surf::SpeedyWeather.SurfaceVariables,
    model::PrimitiveEquation
)
</code></pre><p>Function barrier to unpack <code>model</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/tendencies.jl#L312">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.vordiv_tendencies!-Tuple{DiagnosticVariablesLayer, SpeedyWeather.SurfaceVariables, SpeedyWeather.AbstractCoriolis, SpeedyWeather.AbstractAtmosphere, SpeedyWeather.AbstractGeometry, SpectralTransform}" href="#SpeedyWeather.vordiv_tendencies!-Tuple{DiagnosticVariablesLayer, SpeedyWeather.SurfaceVariables, SpeedyWeather.AbstractCoriolis, SpeedyWeather.AbstractAtmosphere, SpeedyWeather.AbstractGeometry, SpectralTransform}"><code>SpeedyWeather.vordiv_tendencies!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">vordiv_tendencies!(
    diagn::DiagnosticVariablesLayer,
    surf::SpeedyWeather.SurfaceVariables,
    coriolis::SpeedyWeather.AbstractCoriolis,
    atmosphere::SpeedyWeather.AbstractAtmosphere,
    geometry::SpeedyWeather.AbstractGeometry,
    S::SpectralTransform
)
</code></pre><p>Tendencies for vorticity and divergence. Excluding Bernoulli potential with geopotential and linear pressure gradient inside the Laplace operator, which are added later in spectral space.</p><pre><code class="nohighlight hljs">u_tend +=  v*(f+ζ) - RTᵥ&#39;*∇lnp_x
v_tend += -u*(f+ζ) - RTᵥ&#39;*∇lnp_y</code></pre><p><code>+=</code> because the tendencies already contain the parameterizations and vertical advection. <code>f</code> is coriolis, <code>ζ</code> relative vorticity, <code>R</code> the gas constant <code>Tᵥ&#39;</code> the virtual temperature anomaly, <code>∇lnp</code> the gradient of surface pressure and <code>_x</code> and <code>_y</code> its zonal/meridional components. The tendencies are then curled/dived to get the tendencies for vorticity/divergence in spectral space</p><pre><code class="nohighlight hljs">∂ζ/∂t = ∇×(u_tend, v_tend)
∂D/∂t = ∇⋅(u_tend, v_tend) + ...</code></pre><p><code>+ ...</code> because there&#39;s more terms added later for divergence.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/tendencies.jl#L324">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.vorticity_flux!-Tuple{DiagnosticVariablesLayer, Barotropic}" href="#SpeedyWeather.vorticity_flux!-Tuple{DiagnosticVariablesLayer, Barotropic}"><code>SpeedyWeather.vorticity_flux!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">vorticity_flux!(
    diagn::DiagnosticVariablesLayer,
    model::Barotropic
)
</code></pre><p>Vorticity flux tendency in the barotropic vorticity equation</p><p><code>∂ζ/∂t = ∇×(u_tend, v_tend)</code></p><p>with</p><p><code>u_tend = Fᵤ + v*(ζ+f)</code> <code>v_tend = Fᵥ - u*(ζ+f)</code></p><p>with Fᵤ, Fᵥ the forcing from <code>forcing!</code> already in <code>u_tend_grid</code>/<code>v_tend_grid</code> and vorticity ζ, coriolis f.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/tendencies.jl#L660">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.vorticity_flux!-Tuple{DiagnosticVariablesLayer, ShallowWater}" href="#SpeedyWeather.vorticity_flux!-Tuple{DiagnosticVariablesLayer, ShallowWater}"><code>SpeedyWeather.vorticity_flux!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">vorticity_flux!(
    diagn::DiagnosticVariablesLayer,
    model::ShallowWater
)
</code></pre><p>Vorticity flux tendency in the shallow water equations</p><p><code>∂ζ/∂t = ∇×(u_tend, v_tend)</code> <code>∂D/∂t = ∇⋅(u_tend, v_tend)</code></p><p>with</p><p><code>u_tend = Fᵤ + v*(ζ+f)</code> <code>v_tend = Fᵥ - u*(ζ+f)</code></p><p>with Fᵤ, Fᵥ the forcing from <code>forcing!</code> already in <code>u_tend_grid</code>/<code>v_tend_grid</code> and vorticity ζ, coriolis f.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/tendencies.jl#L639">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.vorticity_flux_curldiv!-Tuple{DiagnosticVariablesLayer, SpeedyWeather.AbstractCoriolis, Geometry, SpectralTransform}" href="#SpeedyWeather.vorticity_flux_curldiv!-Tuple{DiagnosticVariablesLayer, SpeedyWeather.AbstractCoriolis, Geometry, SpectralTransform}"><code>SpeedyWeather.vorticity_flux_curldiv!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">vorticity_flux_curldiv!(
    diagn::DiagnosticVariablesLayer,
    coriolis::SpeedyWeather.AbstractCoriolis,
    geometry::Geometry,
    S::SpectralTransform;
    div,
    add
)
</code></pre><p>Compute the vorticity advection as the curl/div of the vorticity fluxes</p><p><code>∂ζ/∂t = ∇×(u_tend, v_tend)</code> <code>∂D/∂t = ∇⋅(u_tend, v_tend)</code></p><p>with</p><p><code>u_tend = Fᵤ + v*(ζ+f)</code> <code>v_tend = Fᵥ - u*(ζ+f)</code></p><p>with <code>Fᵤ, Fᵥ</code> from <code>u_tend_grid</code>/<code>v_tend_grid</code> that are assumed to be alread set in <code>forcing!</code>. Set <code>div=false</code> for the BarotropicModel which doesn&#39;t require the divergence tendency.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/tendencies.jl#L583">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.workgroup_size-Tuple{SpeedyWeather.AbstractDevice}" href="#SpeedyWeather.workgroup_size-Tuple{SpeedyWeather.AbstractDevice}"><code>SpeedyWeather.workgroup_size</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">workgroup_size(dev::AbstractDevice)</code></pre><p>Returns a workgroup size depending on <code>dev</code>.  WIP: Will be expanded in the future to also include grid information. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/gpu.jl#L63-L68">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.write_column_tendencies!-Tuple{DiagnosticVariables, ColumnVariables, SpeedyWeather.AbstractPlanet, Int64}" href="#SpeedyWeather.write_column_tendencies!-Tuple{DiagnosticVariables, ColumnVariables, SpeedyWeather.AbstractPlanet, Int64}"><code>SpeedyWeather.write_column_tendencies!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_column_tendencies!(
    D::DiagnosticVariables,
    column::ColumnVariables,
    planet::SpeedyWeather.AbstractPlanet,
    ij::Int64
)
</code></pre><p>Write the parametrization tendencies from <code>C::ColumnVariables</code> into the horizontal fields of tendencies stored in <code>D::DiagnosticVariables</code> at gridpoint index <code>ij</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/column_variables.jl#L94">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.write_netcdf_time!-Tuple{OutputWriter, DateTime}" href="#SpeedyWeather.write_netcdf_time!-Tuple{OutputWriter, DateTime}"><code>SpeedyWeather.write_netcdf_time!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_netcdf_time!(output::OutputWriter, time::DateTime)
</code></pre><p>Write the current time <code>time::DateTime</code> to the netCDF file in <code>output::OutputWriter</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/output.jl#L380">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.write_netcdf_variables!-Union{Tuple{Model}, Tuple{Grid}, Tuple{NF}, Tuple{OutputWriter, DiagnosticVariables{NF, Grid, Model}}} where {NF, Grid, Model}" href="#SpeedyWeather.write_netcdf_variables!-Union{Tuple{Model}, Tuple{Grid}, Tuple{NF}, Tuple{OutputWriter, DiagnosticVariables{NF, Grid, Model}}} where {NF, Grid, Model}"><code>SpeedyWeather.write_netcdf_variables!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_netcdf_variables!(
    output::OutputWriter,
    diagn::DiagnosticVariables{NF, Grid, Model}
)
</code></pre><p>Write diagnostic variables from <code>diagn</code> to the netCDF file in <code>output::OutputWriter</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/output.jl#L397">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.write_output!-Tuple{OutputWriter, DateTime, DiagnosticVariables}" href="#SpeedyWeather.write_output!-Tuple{OutputWriter, DateTime, DiagnosticVariables}"><code>SpeedyWeather.write_output!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_output!(
    outputter::OutputWriter,
    time::DateTime,
    diagn::DiagnosticVariables
)
</code></pre><p>Writes the variables from <code>diagn</code> of time step <code>i</code> at time <code>time</code> into <code>outputter.netcdf_file</code>. Simply escapes for no netcdf output of if output shouldn&#39;t be written on this time step. Interpolates onto output grid and resolution as specified in <code>outputter</code>, converts to output number format, truncates the mantissa for higher compression and applies lossless compression.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/output.jl#L360">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.write_restart_file-Union{Tuple{T}, Tuple{PrognosticVariables{T, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{T}, OutputWriter}} where T" href="#SpeedyWeather.write_restart_file-Union{Tuple{T}, Tuple{PrognosticVariables{T, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{T}, OutputWriter}} where T"><code>SpeedyWeather.write_restart_file</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_restart_file(
    progn::PrognosticVariables{T, Grid} where Grid&lt;:SpeedyWeather.RingGrids.AbstractGrid{T},
    output::OutputWriter
) -&gt; Union{Nothing, String}
</code></pre><p>A restart file <code>restart.jld2</code> with the prognostic variables is written to the output folder (or current path) that can be used to restart the model. <code>restart.jld2</code> will then be used as initial conditions. The prognostic variables are bitrounded for compression and the 2nd leapfrog time step is discarded. Variables in restart file are unscaled.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/output/output.jl#L505">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.year_angle-Union{Tuple{T}, Tuple{Type{T}, DateTime, Second, Second}} where T" href="#SpeedyWeather.year_angle-Union{Tuple{T}, Tuple{Type{T}, DateTime, Second, Second}} where T"><code>SpeedyWeather.year_angle</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">year_angle(
    _::Type{T},
    time::DateTime,
    length_of_day::Second,
    length_of_year::Second
) -&gt; Any
</code></pre><p>Fraction of year as angle in radians [0...2π]. TODO: Takes length of day/year as argument, but calls to Dates.Time(), Dates.dayofyear() currently have these hardcoded.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/physics/zenith.jl#L170">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.zero_tendencies!-Union{Tuple{DiagnosticVariables{NF, Grid, Model}}, Tuple{Model}, Tuple{Grid}, Tuple{NF}} where {NF, Grid, Model&lt;:Barotropic}" href="#SpeedyWeather.zero_tendencies!-Union{Tuple{DiagnosticVariables{NF, Grid, Model}}, Tuple{Model}, Tuple{Grid}, Tuple{NF}} where {NF, Grid, Model&lt;:Barotropic}"><code>SpeedyWeather.zero_tendencies!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">zero_tendencies!(
    diagn::DiagnosticVariables{NF, Grid, Model&lt;:Barotropic}
)
</code></pre><p>Set the tendencies in <code>diagn</code> to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/tendencies.jl#L93">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.zero_tendencies!-Union{Tuple{DiagnosticVariables{NF, Grid, Model}}, Tuple{Model}, Tuple{Grid}, Tuple{NF}} where {NF, Grid, Model&lt;:PrimitiveDry}" href="#SpeedyWeather.zero_tendencies!-Union{Tuple{DiagnosticVariables{NF, Grid, Model}}, Tuple{Model}, Tuple{Grid}, Tuple{NF}} where {NF, Grid, Model&lt;:PrimitiveDry}"><code>SpeedyWeather.zero_tendencies!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">zero_tendencies!(
    diagn::DiagnosticVariables{NF, Grid, Model&lt;:PrimitiveDry}
)
</code></pre><p>Set the tendencies in <code>diagn</code> to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/tendencies.jl#L118">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.zero_tendencies!-Union{Tuple{DiagnosticVariables{NF, Grid, Model}}, Tuple{Model}, Tuple{Grid}, Tuple{NF}} where {NF, Grid, Model&lt;:PrimitiveWet}" href="#SpeedyWeather.zero_tendencies!-Union{Tuple{DiagnosticVariables{NF, Grid, Model}}, Tuple{Model}, Tuple{Grid}, Tuple{NF}} where {NF, Grid, Model&lt;:PrimitiveWet}"><code>SpeedyWeather.zero_tendencies!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">zero_tendencies!(
    diagn::DiagnosticVariables{NF, Grid, Model&lt;:PrimitiveWet}
)
</code></pre><p>Set the tendencies in <code>diagn</code> to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/tendencies.jl#L133">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.zero_tendencies!-Union{Tuple{DiagnosticVariables{NF, Grid, Model}}, Tuple{Model}, Tuple{Grid}, Tuple{NF}} where {NF, Grid, Model&lt;:ShallowWater}" href="#SpeedyWeather.zero_tendencies!-Union{Tuple{DiagnosticVariables{NF, Grid, Model}}, Tuple{Model}, Tuple{Grid}, Tuple{NF}} where {NF, Grid, Model&lt;:ShallowWater}"><code>SpeedyWeather.zero_tendencies!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">zero_tendencies!(
    diagn::DiagnosticVariables{NF, Grid, Model&lt;:ShallowWater}
)
</code></pre><p>Set the tendencies in <code>diagn</code> to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/tendencies.jl#L104">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.σ_interpolation_weights-Tuple{AbstractVector, AbstractVector}" href="#SpeedyWeather.σ_interpolation_weights-Tuple{AbstractVector, AbstractVector}"><code>SpeedyWeather.σ_interpolation_weights</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">σ_interpolation_weights(
    σ_levels_full::AbstractVector,
    σ_levels_half::AbstractVector
) -&gt; Any
</code></pre><p>Interpolation weights for full to half level interpolation on sigma coordinates. Following Fortran SPEEDY documentation eq. (1).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8aec1229935563a5207e7e86853ca3252ee9a2b2/src/dynamics/geometry.jl#L110">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../speedytransforms/">« SpeedyTransforms</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Friday 15 March 2024 17:48">Friday 15 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
