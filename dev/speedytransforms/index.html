<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Spectral transforms · SpeedyWeather.jl</title><meta name="title" content="Spectral transforms · SpeedyWeather.jl"/><meta property="og:title" content="Spectral transforms · SpeedyWeather.jl"/><meta property="twitter:title" content="Spectral transforms · SpeedyWeather.jl"/><meta name="description" content="Documentation for SpeedyWeather.jl."/><meta property="og:description" content="Documentation for SpeedyWeather.jl."/><meta property="twitter:description" content="Documentation for SpeedyWeather.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SpeedyWeather.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Dynamics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../barotropic/">Barotropic model</a></li><li><a class="tocitem" href="../shallowwater/">Shallow water model</a></li><li><a class="tocitem" href="../primitiveequation/">Primitive equation model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Physics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../large_scale_condensation/">Large-scale condensation</a></li><li><a class="tocitem" href="../convection/">Convection</a></li><li><a class="tocitem" href="../radiation/">Radiation</a></li><li><a class="tocitem" href="../vertical_diffusion/">Vertical diffusion</a></li><li><a class="tocitem" href="../surface_fluxes/">Surface fluxes</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Discretization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../spectral_transform/">Spherical Harmonic Transform</a></li><li><a class="tocitem" href="../grids/">Grids</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Running SpeedyWeather</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../how_to_run_speedy/">How to run SpeedyWeather</a></li><li><a class="tocitem" href="../examples_2D/">Examples 2D</a></li><li><a class="tocitem" href="../examples_3D/">Examples 3D</a></li><li><a class="tocitem" href="../analysis/">Analysis</a></li><li><a class="tocitem" href="../structure/">Tree structure</a></li><li><a class="tocitem" href="../particles/">Particle advection</a></li><li><a class="tocitem" href="../output/">NetCDF output</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Extending SpeedyWeather</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../forcing_drag/">Forcing and drag</a></li><li><a class="tocitem" href="../parameterizations/">Parameterizations</a></li><li><a class="tocitem" href="../orography/">Orography</a></li><li><a class="tocitem" href="../land_sea_mask/">Land-Sea Mask</a></li><li><a class="tocitem" href="../ocean/">Ocean</a></li><li><a class="tocitem" href="../callbacks/">Callbacks</a></li></ul></li><li><a class="tocitem" href="../ringgrids/">RingGrids</a></li><li><a class="tocitem" href="../lowertriangularmatrices/">LowerTriangularMatrices</a></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox" checked/><label class="tocitem" for="menuitem-10"><span class="docs-label">SpeedyTransforms</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Spectral transforms</a><ul class="internal"><li><a class="tocitem" href="#Example-transform"><span>Example transform</span></a></li><li><a class="tocitem" href="#Transform-onto-another-grid"><span>Transform onto another grid</span></a></li><li><a class="tocitem" href="#SpectralTransform"><span>The <code>SpectralTransform</code> struct</span></a></li><li><a class="tocitem" href="#Power-spectrum"><span>Power spectrum</span></a></li><li><a class="tocitem" href="#Example:-Creating-kn-distributed-noise"><span>Example: Creating k^n-distributed noise</span></a></li><li><a class="tocitem" href="#(P)recompute-Legendre-polynomials"><span>(P)recompute Legendre polynomials</span></a></li><li><a class="tocitem" href="#Functions-and-type-index"><span>Functions and type index</span></a></li></ul></li><li><a class="tocitem" href="../gradients/">Gradient operators</a></li></ul></li><li><a class="tocitem" href="../functions/">Function and type index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">SpeedyTransforms</a></li><li class="is-active"><a href>Spectral transforms</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Spectral transforms</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SpeedyWeather/SpeedyWeather.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/main/docs/src/speedytransforms.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="SpeedyTransforms"><a class="docs-heading-anchor" href="#SpeedyTransforms">SpeedyTransforms</a><a id="SpeedyTransforms-1"></a><a class="docs-heading-anchor-permalink" href="#SpeedyTransforms" title="Permalink"></a></h1><p>SpeedyTransforms is a submodule that has been developed for SpeedyWeather.jl which is technically independent (SpeedyWeather.jl however imports it) and can also be used without running simulations. It is just not put into its own respective repository for now.</p><p>The SpeedyTransforms are based on <a href="../ringgrids/#RingGrids">RingGrids</a> and <a href="../lowertriangularmatrices/#lowertriangularmatrices">LowerTriangularMatrices</a> to hold data in either grid-point space or in spectral space. So you want to read these sections first for clarifications how to work with these. We will also not discuss mathematical details of the <a href="../spectral_transform/#Spherical-Harmonic-Transform">Spherical Harmonic Transform</a> here, but will focus on the usage of the SpeedyTransforms module.</p><p>The SpeedyTransforms module also implements the gradient operators <span>$\nabla, \nabla \cdot, \nabla \times, \nabla^2, \nabla^{-2}$</span> in spectral space. Combined with the spectral transform, you could for example start with a velocity field in grid-point space, transform to spectral, compute its divergence and transform back to obtain the divergence in grid-point space. Examples are outlined in <a href="../gradients/#Gradient-operators">Gradient operators</a>.</p><h2 id="Example-transform"><a class="docs-heading-anchor" href="#Example-transform">Example transform</a><a id="Example-transform-1"></a><a class="docs-heading-anchor-permalink" href="#Example-transform" title="Permalink"></a></h2><p>Lets start with a simple transform. We could be <code>using SpeedyWeather</code> but to be more verbose these are the modules required to load</p><pre><code class="language-julia hljs">using SpeedyWeather.RingGrids
using SpeedyWeather.LowerTriangularMatrices
using SpeedyWeather.SpeedyTransforms</code></pre><p>As an example, we want to transform the <span>$l=m=1$</span> spherical harmonic from spectral space in <code>alms</code> to grid-point space.</p><pre><code class="language-julia hljs">alms = zeros(LowerTriangularMatrix{ComplexF64}, 6, 6)     # spectral coefficients
alms[2, 2] = 1                                           # only l=1, m=1 harmonic
alms</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6×6 LowerTriangularMatrix{ComplexF64}:
 0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im
 0.0+0.0im  1.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im
 0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im
 0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im
 0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im
 0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im  0.0+0.0im</code></pre><p>Now <code>gridded</code> is the function that takes spectral coefficients <code>alms</code> and converts them a grid-point space <code>map</code></p><pre><code class="language-julia hljs">map = gridded(alms)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">128-element, 8-ring FullGaussianGrid{Float64}:
 -0.19278869685896918
 -0.17811353112752462
 -0.13632219488509478
 -0.07377704023518313
  0.0
  0.07377704023518313
  0.13632219488509478
  0.17811353112752462
  0.19278869685896918
  0.17811353112752462
  ⋮
  0.17811353112752462
  0.19278869685896918
  0.17811353112752462
  0.13632219488509478
  0.07377704023518313
  0.0
 -0.07377704023518313
 -0.13632219488509478
 -0.17811353112752462</code></pre><p>By default, the <code>gridded</code> transforms onto a <a href="../grids/#FullGaussianGrid"><code>FullGaussianGrid</code></a> unravelled here into a vector west to east, starting at the prime meridian, then north to south, see <a href="../ringgrids/#RingGrids">RingGrids</a>. We can visualize <code>map</code> quickly with a UnicodePlot via <code>plot</code> (see <a href="../ringgrids/#Visualising-RingGrid-data">Visualising RingGrid data</a>)</p><pre><code class="language-julia hljs">import SpeedyWeather.RingGrids: plot    # not necessary when `using SpeedyWeather`
plot(map)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">       <span class="sgr97"><span class="sgr1">8-ring FullGaussianGrid{Float64}</span></span>     
       <span class="sgr90">┌────────────────┐</span>  <span class="sgr90">0.7</span>
    <span class="sgr90">90</span> <span class="sgr90">│</span><span class="sgr48_5" style="background:#005f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr38_5" style="color:#5f5f87"><span class="sgr48_5" style="background:#008787">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span><span class="sgr38_5" style="color:#5faf5f">▄</span><span class="sgr38_5" style="color:#5fd75f">▄</span><span class="sgr38_5" style="color:#87d75f">▄</span><span class="sgr38_5" style="color:#5fd75f">▄</span><span class="sgr38_5" style="color:#5faf5f">▄</span><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄▄</span><span class="sgr38_5" style="color:#5f5f87">▄</span></span><span class="sgr38_5" style="color:#5f5f87"><span class="sgr48_5" style="background:#005f87">▄</span></span><span class="sgr90">│</span> <span class="sgr90">┌──┐</span>
    ˚N <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f005f"><span class="sgr38_5" style="color:#5f005f">▄</span></span><span class="sgr38_5" style="color:#5f005f"><span class="sgr48_5" style="background:#5f0087">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr48_5" style="background:#5faf87"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#87d75f"><span class="sgr38_5" style="color:#afd75f">▄</span></span><span class="sgr48_5" style="background:#afd700"><span class="sgr38_5" style="color:#d7d700">▄</span></span><span class="sgr48_5" style="background:#d7d700"><span class="sgr38_5" style="color:#ffd700">▄</span></span><span class="sgr48_5" style="background:#afd700"><span class="sgr38_5" style="color:#d7d700">▄</span></span><span class="sgr48_5" style="background:#87d75f"><span class="sgr38_5" style="color:#afd75f">▄</span></span><span class="sgr48_5" style="background:#5faf87"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr48_5" style="background:#5f0087"><span class="sgr38_5" style="color:#5f005f">▄</span></span><span class="sgr90">│</span> <span class="sgr90">│</span><span class="sgr48_5" style="background:#ffd700"><span class="sgr38_5" style="color:#5faf87">▄▄</span></span><span class="sgr90">│</span>
       <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f005f"><span class="sgr38_5" style="color:#5f005f">▄</span><span class="sgr38_5" style="color:#5f0087">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr48_5" style="background:#5faf87"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#afd75f"><span class="sgr38_5" style="color:#87d75f">▄</span></span><span class="sgr48_5" style="background:#d7d700"><span class="sgr38_5" style="color:#afd700">▄</span></span><span class="sgr48_5" style="background:#ffd700"><span class="sgr38_5" style="color:#d7d700">▄</span></span><span class="sgr48_5" style="background:#d7d700"><span class="sgr38_5" style="color:#afd700">▄</span></span><span class="sgr48_5" style="background:#afd75f"><span class="sgr38_5" style="color:#87d75f">▄</span></span><span class="sgr48_5" style="background:#5faf87"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr48_5" style="background:#5f005f"><span class="sgr38_5" style="color:#5f0087">▄</span></span><span class="sgr90">│</span> <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f005f">▄▄</span></span><span class="sgr90">│</span>
   <span class="sgr90">-90</span> <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#005f87">▄▄</span><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr38_5" style="color:#008787"><span class="sgr48_5" style="background:#008787">▄▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr38_5" style="color:#00af87"><span class="sgr48_5" style="background:#5faf5f">▄</span><span class="sgr48_5" style="background:#5fd75f">▄</span><span class="sgr48_5" style="background:#87d75f">▄</span><span class="sgr48_5" style="background:#5fd75f">▄</span><span class="sgr48_5" style="background:#5faf5f">▄</span><span class="sgr48_5" style="background:#00af87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄▄</span></span><span class="sgr38_5" style="color:#008787"><span class="sgr48_5" style="background:#5f5f87">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#005f87">▄</span></span><span class="sgr90">│</span> <span class="sgr90">└──┘</span>
       <span class="sgr90">└────────────────┘</span> <span class="sgr90">-0.7</span>
        <span class="sgr90">0</span>     ˚E     <span class="sgr90">360</span>      </code></pre><p>Yay! This is the what the <span>$l=m=1$</span> spherical harmonic is supposed to look like! Now let&#39;s go back to spectral space with <code>spectral</code></p><pre><code class="language-julia hljs">alms2 = spectral(map)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6×6 LowerTriangularMatrix{ComplexF64}:
 0.0+0.0im           0.0+0.0im  0.0+0.0im  …  0.0+0.0im           0.0+0.0im
 0.0+0.0im           1.0+0.0im  0.0+0.0im     0.0+0.0im           0.0+0.0im
 0.0+0.0im           0.0+0.0im  0.0+0.0im     0.0+0.0im           0.0+0.0im
 0.0+0.0im   3.75734e-16+0.0im  0.0+0.0im     0.0+0.0im           0.0+0.0im
 0.0+0.0im           0.0+0.0im  0.0+0.0im     0.0+0.0im           0.0+0.0im
 0.0+0.0im  -1.63058e-17+0.0im  0.0+0.0im  …  0.0+0.0im  -2.47957e-17+0.0im</code></pre><p>Comparing with <code>alms</code> from above you can see that the transform is exact up to a typical rounding error from <code>Float64</code>. </p><pre><code class="language-julia hljs">alms ≈ alms2</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>YAY! The transform is typically idempotent, meaning that either space may hold information that is not exactly representable in the other but the first two-way transform will remove that so that subsequent transforms do not change this any further. However, also note here that the default <a href="../grids/#FullGaussianGrid"><code>FullGaussianGrid</code></a> is an exact grid, inexact grids usually have a transform error that is larger than the rounding error from floating-point arithmetic.</p><h2 id="Transform-onto-another-grid"><a class="docs-heading-anchor" href="#Transform-onto-another-grid">Transform onto another grid</a><a id="Transform-onto-another-grid-1"></a><a class="docs-heading-anchor-permalink" href="#Transform-onto-another-grid" title="Permalink"></a></h2><p>While the default grid for <a href="#SpeedyTransforms">SpeedyTransforms</a> is the <a href="../grids/#FullGaussianGrid"><code>FullGaussianGrid</code></a> we can transform onto other grids by specifying <code>Grid</code> too</p><pre><code class="language-julia hljs">map = gridded(alms, Grid=HEALPixGrid)
plot(map)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">       <span class="sgr97"><span class="sgr1">7-ring HEALPixGrid{Float64}</span></span>     
       <span class="sgr90">┌──────────────┐</span>  <span class="sgr90">0.7</span>
    <span class="sgr90">90</span> <span class="sgr90">│</span><span class="sgr38_5" style="color:#005f87">▄▄</span><span class="sgr38_5" style="color:#008787">▄▄</span><span class="sgr38_5" style="color:#00af87">▄▄▄▄▄▄▄</span><span class="sgr38_5" style="color:#008787">▄▄</span><span class="sgr38_5" style="color:#005f87">▄</span><span class="sgr90">│</span> <span class="sgr90">┌──┐</span>
    ˚N <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f005f">▄</span><span class="sgr38_5" style="color:#5f5f87">▄</span></span><span class="sgr38_5" style="color:#5f5f87"><span class="sgr48_5" style="background:#005f87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#5fd75f"><span class="sgr38_5" style="color:#afd75f">▄</span></span><span class="sgr48_5" style="background:#afd75f"><span class="sgr38_5" style="color:#d7d700">▄</span><span class="sgr38_5" style="color:#ffd700">▄</span><span class="sgr38_5" style="color:#d7d700">▄</span></span><span class="sgr48_5" style="background:#5fd75f"><span class="sgr38_5" style="color:#afd75f">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr48_5" style="background:#005f87"><span class="sgr38_5" style="color:#5f5f87">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f005f">▄</span></span><span class="sgr90">│</span> <span class="sgr90">│</span><span class="sgr48_5" style="background:#ffd700"><span class="sgr38_5" style="color:#5faf87">▄▄</span></span><span class="sgr90">│</span>
       <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f005f"><span class="sgr38_5" style="color:#5f005f">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr48_5" style="background:#5faf5f"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#87d75f"><span class="sgr38_5" style="color:#afd75f">▄</span></span><span class="sgr48_5" style="background:#ffd700"><span class="sgr38_5" style="color:#d7d700">▄</span><span class="sgr38_5" style="color:#ffd700">▄</span><span class="sgr38_5" style="color:#d7d700">▄</span></span><span class="sgr48_5" style="background:#87d75f"><span class="sgr38_5" style="color:#afd75f">▄</span></span><span class="sgr48_5" style="background:#5faf5f"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄</span></span><span class="sgr48_5" style="background:#5f005f"><span class="sgr38_5" style="color:#5f005f">▄</span></span><span class="sgr90">│</span> <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f005f">▄▄</span></span><span class="sgr90">│</span>
   <span class="sgr90">-90</span> <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#005f87">▄▄</span></span><span class="sgr48_5" style="background:#005f87"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr38_5" style="color:#008787"><span class="sgr48_5" style="background:#008787">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr38_5" style="color:#00af87"><span class="sgr48_5" style="background:#5fd75f">▄</span><span class="sgr48_5" style="background:#afd75f">▄▄▄</span><span class="sgr48_5" style="background:#5fd75f">▄</span><span class="sgr48_5" style="background:#00af87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr38_5" style="color:#008787"><span class="sgr48_5" style="background:#005f87">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#005f87">▄</span></span><span class="sgr90">│</span> <span class="sgr90">└──┘</span>
       <span class="sgr90">└──────────────┘</span> <span class="sgr90">-0.7</span>
        <span class="sgr90">0</span>    ˚E    <span class="sgr90">360</span>      </code></pre><p>which, if transformed back, however, can yield a larger transform error as discussed above</p><pre><code class="language-julia hljs">spectral(map)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6×6 LowerTriangularMatrix{ComplexF64}:
 0.0+0.0im           0.0+0.0im          0.0+0.0im  …  0.0+0.0im  0.0+0.0im
 0.0+0.0im       1.01215-1.4295e-17im   0.0+0.0im     0.0+0.0im  0.0+0.0im
 0.0+0.0im   3.42299e-17+0.0im          0.0+0.0im     0.0+0.0im  0.0+0.0im
 0.0+0.0im     0.0185292-1.63433e-17im  0.0+0.0im     0.0+0.0im  0.0+0.0im
 0.0+0.0im  -6.28844e-17+0.0im          0.0+0.0im     0.0+0.0im  0.0+0.0im
 0.0+0.0im    -0.0164851+1.42335e-17im  0.0+0.0im  …  0.0+0.0im  0.0+0.0im</code></pre><p>On such a coarse grid the transform error (absolute and relative) is about <span>$10^{-2}$</span>, this decreases for higher resolution. The <code>gridded</code> and <code>spectral</code> functions will choose a corresponding grid-spectral resolution (see <a href="../grids/#Matching-spectral-and-grid-resolution">Matching spectral and grid resolution</a>) following quadratic truncation, but you can always truncate/interpolate in spectral space with <code>spectral_truncation</code>, <code>spectral_interpolation</code> which takes <code>trunc</code> = <span>$l_{max} = m_{max}$</span> as second argument</p><pre><code class="language-julia hljs">spectral_truncation(alms, 2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3×3 LowerTriangularMatrix{ComplexF64}:
 0.0+0.0im  0.0+0.0im  0.0+0.0im
 0.0+0.0im  1.0+0.0im  0.0+0.0im
 0.0+0.0im  0.0+0.0im  0.0+0.0im</code></pre><p>Yay, we just chopped off <span>$l &gt; 2$</span> from <code>alms</code> which contained the harmonics up to degree and order 5 before. If the second argument in <code>spectral_truncation</code> is larger than <code>alms</code> then it will automatically call <code>spectral_interpolation</code> and vice versa. Also see <a href="../ringgrids/#Interpolation-on-RingGrids">Interpolation on RingGrids</a> to interpolate directly between grids. If you want to control directly the resolution of the grid <code>gridded</code> is supposed to transform onto you have to provide a <code>SpectralTransform</code> instance. More on that now.</p><h2 id="SpectralTransform"><a class="docs-heading-anchor" href="#SpectralTransform">The <code>SpectralTransform</code> struct</a><a id="SpectralTransform-1"></a><a class="docs-heading-anchor-permalink" href="#SpectralTransform" title="Permalink"></a></h2><p>Both <code>spectral</code> and <code>gridded</code> create an instance of <code>SpectralTransform</code> under the hood. This object contains all precomputed information that is required for the transform, either way:  The Legendre polynomials, pre-planned Fourier transforms, precomputed gradient, divergence and curl operators, the spherical harmonic eigenvalues among others. Maybe the most intuitive way to create a <code>SpectralTransform</code> is to start with a <code>SpectralGrid</code>, which already defines which spectral resolution is supposed to be combined with a given grid.</p><pre><code class="language-julia hljs">using SpeedyWeather
spectral_grid = SpectralGrid(Float32, trunc=5, Grid=OctahedralGaussianGrid, dealiasing=3)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SpectralGrid:
├ Spectral:   T5 LowerTriangularMatrix{Complex{Float32}}, radius = 6.371e6 m
├ Grid:       12-ring OctahedralGaussianGrid{Float32}, 360 grid points
├ Resolution: 1190km (average)
└ Vertical:   8-level SigmaCoordinates</code></pre><p>(We <code>using SpeedyWeather</code> here as <code>SpectralGrid</code> is exported therein). We also specify the number format <code>Float32</code> here to be used for the transform although this is the default anyway. From <code>spectral_grid</code> we now construct a <code>SpectralTransform</code> as follows</p><pre><code class="language-julia hljs">S = SpectralTransform(spectral_grid)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SpectralTransform{Float32}:
├ Spectral:   T5, 7x6 LowerTriangularMatrix{Complex{Float32}}
├ Grid:       12-ring OctahedralGaussianArray{Float32}
├ Truncation: dealiasing = 3 (cubic)
└ Legendre:   recompute polynomials false (1.22 KB)</code></pre><p>Note that because we chose <code>dealiasing=3</code> (cubic truncation) we now match a T5 spectral field with a 12-ring octahedral Gaussian grid, instead of the 8 rings as above. So going from <code>dealiasing=2</code> (default) to <code>dealiasing=3</code> increased our resolution on the grid while the spectral resolution remains the same. The <code>SpectralTransform</code> also has options for the recomputation or pre-computation of the Legendre polynomials, fore more information see <a href="#(P)recompute-Legendre-polynomials">(P)recompute Legendre polynomials</a>.</p><p>Passing on <code>S</code> the <code>SpectralTransform</code> now allows us to transform directly on the grid defined therein.</p><pre><code class="language-julia hljs">map = gridded(alms, S)
plot(map)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">       <span class="sgr97"><span class="sgr1">12-ring OctahedralGaussianGrid{Float32}</span></span>     
       <span class="sgr90">┌────────────────────────┐</span>  <span class="sgr90">0.7</span>
    <span class="sgr90">90</span> <span class="sgr90">│</span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#5f5f87">▄▄▄</span><span class="sgr38_5" style="color:#005f87">▄</span><span class="sgr38_5" style="color:#008787">▄▄▄</span><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr38_5" style="color:#00af87"><span class="sgr48_5" style="background:#00af87">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#5faf87">▄▄</span><span class="sgr38_5" style="color:#5faf5f">▄▄▄</span><span class="sgr38_5" style="color:#5faf87">▄▄</span><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr38_5" style="color:#00af87"><span class="sgr48_5" style="background:#008787">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄▄▄</span><span class="sgr38_5" style="color:#005f87">▄</span><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr90">│</span> <span class="sgr90">┌──┐</span>
       <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f0087">▄▄</span><span class="sgr38_5" style="color:#5f5f87">▄▄▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr48_5" style="background:#5faf87"><span class="sgr38_5" style="color:#5faf5f">▄</span></span><span class="sgr48_5" style="background:#5fd75f"><span class="sgr38_5" style="color:#87d75f">▄</span><span class="sgr38_5" style="color:#afd75f">▄</span></span><span class="sgr48_5" style="background:#87d75f"><span class="sgr38_5" style="color:#afd700">▄▄▄</span></span><span class="sgr48_5" style="background:#5fd75f"><span class="sgr38_5" style="color:#afd75f">▄</span><span class="sgr38_5" style="color:#87d75f">▄</span></span><span class="sgr48_5" style="background:#5faf87"><span class="sgr38_5" style="color:#5faf5f">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄▄</span><span class="sgr38_5" style="color:#5f0087">▄</span></span><span class="sgr90">│</span> <span class="sgr90">│</span><span class="sgr48_5" style="background:#ffd700"><span class="sgr38_5" style="color:#afd75f">▄▄</span></span><span class="sgr90">│</span>
    ˚N <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f005f"><span class="sgr38_5" style="color:#5f005f">▄▄</span></span><span class="sgr38_5" style="color:#5f005f"><span class="sgr48_5" style="background:#5f0087">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#005f87">▄</span><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr48_5" style="background:#5fd75f"><span class="sgr38_5" style="color:#5fd75f">▄</span></span><span class="sgr48_5" style="background:#87d75f"><span class="sgr38_5" style="color:#afd75f">▄</span></span><span class="sgr48_5" style="background:#afd700"><span class="sgr38_5" style="color:#d7d700">▄</span></span><span class="sgr48_5" style="background:#d7d700"><span class="sgr38_5" style="color:#ffd700">▄▄▄</span></span><span class="sgr48_5" style="background:#afd700"><span class="sgr38_5" style="color:#d7d700">▄</span></span><span class="sgr48_5" style="background:#87d75f"><span class="sgr38_5" style="color:#afd75f">▄</span></span><span class="sgr48_5" style="background:#5fd75f"><span class="sgr38_5" style="color:#5fd75f">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span><span class="sgr38_5" style="color:#005f87">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr48_5" style="background:#5f0087"><span class="sgr38_5" style="color:#5f005f">▄</span></span><span class="sgr38_5" style="color:#5f005f"><span class="sgr48_5" style="background:#5f005f">▄</span></span><span class="sgr90">│</span> <span class="sgr90">│</span><span class="sgr48_5" style="background:#5faf5f"><span class="sgr38_5" style="color:#00af87">▄▄</span></span><span class="sgr90">│</span>
       <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f005f"><span class="sgr38_5" style="color:#5f005f">▄▄</span><span class="sgr38_5" style="color:#5f0087">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr48_5" style="background:#005f87"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr38_5" style="color:#008787"><span class="sgr48_5" style="background:#008787">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr48_5" style="background:#5fd75f"><span class="sgr38_5" style="color:#5fd75f">▄</span></span><span class="sgr48_5" style="background:#afd75f"><span class="sgr38_5" style="color:#87d75f">▄</span></span><span class="sgr48_5" style="background:#d7d700"><span class="sgr38_5" style="color:#afd700">▄</span></span><span class="sgr48_5" style="background:#ffd700"><span class="sgr38_5" style="color:#d7d700">▄▄▄</span></span><span class="sgr48_5" style="background:#d7d700"><span class="sgr38_5" style="color:#afd700">▄</span></span><span class="sgr48_5" style="background:#afd75f"><span class="sgr38_5" style="color:#87d75f">▄</span></span><span class="sgr48_5" style="background:#5fd75f"><span class="sgr38_5" style="color:#5fd75f">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr38_5" style="color:#008787"><span class="sgr48_5" style="background:#005f87">▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr48_5" style="background:#5f005f"><span class="sgr38_5" style="color:#5f0087">▄</span><span class="sgr38_5" style="color:#5f005f">▄</span></span><span class="sgr90">│</span> <span class="sgr90">│</span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr90">│</span>
       <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f0087"><span class="sgr38_5" style="color:#5f5f87">▄▄</span></span><span class="sgr38_5" style="color:#5f5f87"><span class="sgr48_5" style="background:#5f5f87">▄▄▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr48_5" style="background:#5faf5f"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#87d75f"><span class="sgr38_5" style="color:#5fd75f">▄</span></span><span class="sgr38_5" style="color:#5fd75f"><span class="sgr48_5" style="background:#afd75f">▄</span></span><span class="sgr48_5" style="background:#afd700"><span class="sgr38_5" style="color:#87d75f">▄▄▄</span></span><span class="sgr48_5" style="background:#afd75f"><span class="sgr38_5" style="color:#5fd75f">▄</span></span><span class="sgr38_5" style="color:#5fd75f"><span class="sgr48_5" style="background:#87d75f">▄</span></span><span class="sgr48_5" style="background:#5faf5f"><span class="sgr38_5" style="color:#5faf87">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr48_5" style="background:#008787"><span class="sgr38_5" style="color:#008787">▄▄</span></span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f5f87">▄▄▄</span></span><span class="sgr38_5" style="color:#5f5f87"><span class="sgr48_5" style="background:#5f0087">▄</span></span><span class="sgr90">│</span> <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#5f005f">▄▄</span></span><span class="sgr90">│</span>
   <span class="sgr90">-90</span> <span class="sgr90">│</span><span class="sgr48_5" style="background:#5f5f87"><span class="sgr38_5" style="color:#008787">▄▄▄</span></span><span class="sgr38_5" style="color:#008787"><span class="sgr48_5" style="background:#005f87">▄</span><span class="sgr48_5" style="background:#008787">▄▄▄</span><span class="sgr48_5" style="background:#00af87">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#00af87">▄</span></span><span class="sgr38_5" style="color:#00af87"><span class="sgr48_5" style="background:#5faf87">▄▄</span><span class="sgr48_5" style="background:#5faf5f">▄▄▄</span><span class="sgr48_5" style="background:#5faf87">▄▄</span><span class="sgr48_5" style="background:#00af87">▄</span></span><span class="sgr48_5" style="background:#00af87"><span class="sgr38_5" style="color:#008787">▄</span></span><span class="sgr38_5" style="color:#008787"><span class="sgr48_5" style="background:#008787">▄▄▄</span><span class="sgr48_5" style="background:#005f87">▄</span><span class="sgr48_5" style="background:#5f5f87">▄▄</span></span><span class="sgr90">│</span> <span class="sgr90">└──┘</span>
       <span class="sgr90">└────────────────────────┘</span> <span class="sgr90">-0.7</span>
        <span class="sgr90">0</span>         ˚E         <span class="sgr90">360</span>      </code></pre><p>Yay, this is again the <span>$l=m=1$</span> harmonic, but this time on a slightly higher resolution <code>OctahedralGaussianGrid</code> as specified in the <code>SpectralTransform</code> <code>S</code>. Note that also the number format was converted on the fly to Float32 because that is the number format we specified in <code>S</code>! And from grid to spectral</p><pre><code class="language-julia hljs">alms2 = spectral(map, S)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">7×6 LowerTriangularMatrix{ComplexF32}:
   2.05564f-9+0.0im          0.0+0.0im          …         0.0+0.0im
          0.0+0.0im          1.0-2.14344f-8im             0.0+0.0im
   -1.3654f-9+0.0im          0.0+0.0im                    0.0+0.0im
          0.0+0.0im  -2.66275f-8-6.93167f-11im            0.0+0.0im
 -3.22443f-10+0.0im          0.0+0.0im                    0.0+0.0im
          0.0+0.0im  -4.58858f-8-8.19443f-9im   …  6.58519f-9+4.79414f-9im
   1.85859f-9+0.0im          0.0+0.0im                    0.0+0.0im</code></pre><p>As you can see the rounding error is now more like <span>$10^{-8}$</span> as we are using Float32 (the <a href="../grids/#OctahedralGaussianGrid">OctahedralGaussianGrid</a> is another <em>exact</em> grid). Note, however, that the returned <code>LowerTriangularMatrix</code> is of size 7x6, not 6x6 what we started from. The underlying reason is that internally SpeedyWeather uses <code>LowerTriangularMatrix</code>s of size <span>$l_{max} + 2 \times m_{max} + 1$</span>. One <span>$+1$</span> on both degree and order for 0-based harmonics versus 1-based matrix sizes, but an additional <span>$+1$</span> for the degrees which is required by the meridional derivative. For consistency, all <code>LowerTriangularMatrix</code>s in SpeedyWeather.jl carry this additional degree but only the vector quantities explicitly make use of it.  See <a href="../spectral_transform/#Meridional-derivative">Meridional derivative</a> for details.</p><p>For this interface to SpeedyTransforms this means that on a grid-to-spectral transform you will get one more degree than orders of the spherical harmonics by default. You can, however, always truncate this additional degree, say to T5 (hence matrix size is 6x6)</p><pre><code class="language-julia hljs">spectral_truncation(alms2, 5, 5)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6×6 LowerTriangularMatrix{ComplexF32}:
   2.05564f-9+0.0im          0.0+0.0im          …         0.0+0.0im
          0.0+0.0im          1.0-2.14344f-8im             0.0+0.0im
   -1.3654f-9+0.0im          0.0+0.0im                    0.0+0.0im
          0.0+0.0im  -2.66275f-8-6.93167f-11im            0.0+0.0im
 -3.22443f-10+0.0im          0.0+0.0im                    0.0+0.0im
          0.0+0.0im  -4.58858f-8-8.19443f-9im   …  6.58519f-9+4.79414f-9im</code></pre><p><code>spectral_truncation(alms2, 5)</code> would have returned the same, a single argument is then assumed equal for both degrees and orders. Alternatively, you can also pass on the <code>one_more_degree=false</code> argument to the <code>SpectralTransform</code> constructor</p><pre><code class="language-julia hljs">S = SpectralTransform(spectral_grid, one_more_degree=false)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SpectralTransform{Float32}:
├ Spectral:   T5, 6x6 LowerTriangularMatrix{Complex{Float32}}
├ Grid:       12-ring OctahedralGaussianArray{Float32}
├ Truncation: dealiasing = 3 (cubic)
└ Legendre:   recompute polynomials false (1.07 KB)</code></pre><p>As you can see the <code>7x6 LowerTriangularMatrix</code> in the description above dropped down to <code>6x6 LowerTriangularMatrix</code>, this is the size of the input that is expected (otherwise you will get a <code>BoundsError</code>).</p><h2 id="Power-spectrum"><a class="docs-heading-anchor" href="#Power-spectrum">Power spectrum</a><a id="Power-spectrum-1"></a><a class="docs-heading-anchor-permalink" href="#Power-spectrum" title="Permalink"></a></h2><p>How to take some data and compute a power spectrum with SpeedyTransforms you may ask. Say you have some global data in a matrix <code>m</code> that looks, for example, like</p><pre><code class="language-julia hljs">m</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">96×47 Matrix{Float32}:
 -3.0252   -3.57212  -3.30937  -2.33692  …  -2.18324   -2.28447   -2.23873
 -3.11256  -3.71639  -3.44717  -2.39986     -2.00233   -2.15338   -2.16909
 -3.19475  -3.85518  -3.5857   -2.47684     -1.80135   -2.01403   -2.09704
 -3.2714   -3.98837  -3.72601  -2.57094     -1.58332   -1.86746   -2.02295
 -3.34218  -4.11566  -3.86877  -2.68407     -1.35195   -1.7149    -1.9472
 -3.40672  -4.23667  -4.01409  -2.81694  …  -1.11139   -1.55768   -1.87021
 -3.46467  -4.35082  -4.1616   -2.96902     -0.865967  -1.39725   -1.79242
 -3.51568  -4.45741  -4.31036  -3.1387      -0.61991   -1.23507   -1.7143
 -3.5594   -4.55554  -4.45894  -3.32342     -0.377113  -1.07258   -1.63629
 -3.59549  -4.64419  -4.60538  -3.51982     -0.140927  -0.911141  -1.5589
  ⋮                                      ⋱              ⋮         
 -2.06498  -2.03003  -1.83889  -1.64862     -2.87626   -3.03185   -2.71673
 -2.18259  -2.22217  -2.0395   -1.78596     -2.85942   -2.98526   -2.67867
 -2.29841  -2.40962  -2.22878  -1.90134     -2.83463   -2.93071   -2.63666
 -2.41201  -2.59201  -2.40703  -1.9963   …  -2.79847   -2.86753   -2.59073
 -2.52299  -2.76908  -2.57498  -2.07337     -2.74753   -2.79515   -2.54095
 -2.63095  -2.94068  -2.73377  -2.13608     -2.67866   -2.71307   -2.48739
 -2.73552  -3.10676  -2.88486  -2.18875     -2.5892    -2.62098   -2.43021
 -2.83632  -3.26734  -3.02996  -2.23632     -2.47728   -2.51874   -2.36956
 -2.933    -3.42244  -3.17086  -2.28399  …  -2.34193   -2.40645   -2.30565</code></pre><p>You hopefully know which grid this data comes on, let us assume it is a regular latitude-longitude grid, which we call the <code>FullClenshawGrid</code>. Note that for the spectral transform this should not include the poles, so the 96x47 matrix size here corresponds to </p><p>We now wrap this matrix therefore to associate it with the necessary grid information</p><pre><code class="language-julia hljs">map = FullClenshawGrid(m)

using CairoMakie
heatmap(map)</code></pre><p><img src="../random_pattern.png" alt="Random pattern"/></p><p>Now we transform into spectral space and call <code>power_spectrum(::LowerTriangularMatrix)</code></p><pre><code class="language-julia hljs">alms = spectral(map)
power = SpeedyTransforms.power_spectrum(alms)</code></pre><p>Which returns a vector of power at every wavenumber. By default this is normalized as average power per degree, you can change that with the keyword argument <code>normalize=false</code>. Plotting this yields</p><pre><code class="language-julia hljs">using UnicodePlots
k = 0:length(power)-1
lineplot(k, power, yscale=:log10, ylim=(1e-15, 10), xlim=extrema(k),
    ylabel=&quot;power&quot;, xlabel=&quot;wavenumber&quot;, height=10, width=60)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">               <span class="sgr90">┌────────────────────────────────────────────────────────────┐</span> 
           <span class="sgr90">10¹</span> <span class="sgr90">│</span>⠀<span class="sgr32">⢠⡀</span>⠀⠀<span class="sgr32">⡰⠒⠤⠤⠤⠤⠤⠤⣀⣀⠤⠤⠤⠤⡄</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr90">│</span> 
               <span class="sgr90">│</span><span class="sgr32">⠔⠁⠈⠢⠊</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr32">⢱</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr90">│</span> 
               <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr32">⢸</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr90">│</span> 
               <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr32">⠘⡄</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr90">│</span> 
   power       <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr32">⡇</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr90">│</span> 
               <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr32">⢇</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr90">│</span> 
               <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr32">⢸</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr90">│</span> 
               <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr32">⢸</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr90">│</span> 
               <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr32">⡇</span>⠀<span class="sgr32">⡀</span>⠀⠀⠀<span class="sgr32">⡀</span>⠀⠀<span class="sgr32">⢀</span>⠀⠀⠀<span class="sgr32">⢀</span>⠀⠀⠀<span class="sgr32">⢀⡀</span>⠀⠀<span class="sgr32">⣀⡀</span>⠀⠀<span class="sgr32">⣀</span>⠀⠀<span class="sgr32">⢀⣀</span>⠀⠀<span class="sgr32">⢀⣀</span>⠀⠀<span class="sgr32">⢀⡀</span>⠀<span class="sgr90">│</span> 
         <span class="sgr90">10⁻¹⁵</span> <span class="sgr90">│</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr32">⠉⠉⠈⠑⠊⠉⠈⠑⠒⠉⠉⠒⠊⠁⠉⠒⠊⠁⠈⠑⠉</span>⠀<span class="sgr32">⠈⠑⠉</span>⠀<span class="sgr32">⠑⠊⠁</span>⠀<span class="sgr32">⠉⠊⠁</span>⠀<span class="sgr32">⠉⠉⠁⠈⠉</span><span class="sgr90">│</span> 
               <span class="sgr90">└────────────────────────────────────────────────────────────┘</span> 
               ⠀<span class="sgr90">0</span>⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀<span class="sgr90">31</span>⠀ 
               ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀wavenumber⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀ </code></pre><p>The power spectrum of our data is about 1 up to wavenumber 10 and then close to zero for higher wavenumbers (which is in fact how we constructed this fake data). Let us turn this around and use SpeedyTransforms to create random noise in spectral space to be used in grid-point space!</p><h2 id="Example:-Creating-kn-distributed-noise"><a class="docs-heading-anchor" href="#Example:-Creating-kn-distributed-noise">Example: Creating k^n-distributed noise</a><a id="Example:-Creating-kn-distributed-noise-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Creating-kn-distributed-noise" title="Permalink"></a></h2><p>How would we construct random noise in spectral space that follows a certain power law and transform it back into grid-point space? Define the wavenumber <span>$k$</span> for T31, the spectral resolution we are interested in. (We start from 1 instead of 0 to avoid zero to the power of something negative). Now create some normally distributed spectral coefficients but scale them down for higher wavenumbers with <span>$k^{-2}$</span></p><pre><code class="language-julia hljs">k = 1:32
alms = randn(LowerTriangularMatrix{Complex{Float32}}, 32, 32)
alms .*= k.^-2</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">32×32 LowerTriangularMatrix{ComplexF32}:
    -0.131774+0.317226im     …         0.0+0.0im
    -0.151011+0.0200534im              0.0+0.0im
    -0.161365+0.00928334im             0.0+0.0im
   -0.0594779-0.00830904im             0.0+0.0im
   -0.0361227+0.0174691im              0.0+0.0im
   -0.0070124-0.0290734im    …         0.0+0.0im
 -0.000597823+0.0184872im              0.0+0.0im
  -0.00187821-0.0052653im              0.0+0.0im
  -0.00579414-0.00119612im             0.0+0.0im
   0.00104939+0.000585577im            0.0+0.0im
             ⋮               ⋱  
 -0.000350399-0.00103139im             0.0+0.0im
   0.00065432-0.00144415im             0.0+0.0im
  -2.81277f-5-0.000716462im  …         0.0+0.0im
 -0.000208153+0.000194458im            0.0+0.0im
  0.000191694+0.00103058im             0.0+0.0im
  -5.37092f-5-0.000376433im            0.0+0.0im
 -0.000553174-0.00135523im             0.0+0.0im
  0.000278503+0.000431349im  …         0.0+0.0im
   0.00045926-0.000424608im     -9.0029f-5-0.000632917im</code></pre><p>Awesome. For higher degrees and orders the amplitude clearly decreases! Now to grid-point space and let us visualize the result</p><pre><code class="language-julia hljs">map = gridded(alms)

using CairoMakie
heatmap(map, title=&quot;k⁻²-distributed noise&quot;)</code></pre><p><img src="../random_noise.png" alt="Random noise"/></p><p>You can always access the underlying data in <code>map</code> via <code>map.data</code> in case you need to get rid of the wrapping into a grid again!</p><h2 id="(P)recompute-Legendre-polynomials"><a class="docs-heading-anchor" href="#(P)recompute-Legendre-polynomials">(P)recompute Legendre polynomials</a><a id="(P)recompute-Legendre-polynomials-1"></a><a class="docs-heading-anchor-permalink" href="#(P)recompute-Legendre-polynomials" title="Permalink"></a></h2><p>The spectral transform uses a Legendre transform in meridional direction. For this the Legendre polynomials are required, at each latitude ring this is a <span>$l_{max} \times m_{max}$</span> lower triangular matrix. Storing precomputed Legendre polynomials therefore quickly increase in size with resolution. One can recompute them to save memory, but that  uses more arithmetic operations. There is therefore a memory-compute tradeoff.</p><p>For a single transform, there is no need to precompute the polynomials as the <code>SpectralTransform</code> object will be garbage collected again anyway. For low resolution simulations with many repeated small transforms it makes sense to precompute the polynomials and SpeedyWeather.jl does that automatically anyway. At very high resolution the polynomials may, however, become prohibitively large. An example at T127, about 100km resolution</p><pre><code class="language-julia hljs">spectral_grid = SpectralGrid(trunc=127)
SpectralTransform(spectral_grid, recompute_legendre=false)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SpectralTransform{Float32}:
├ Spectral:   T127, 129x128 LowerTriangularMatrix{Complex{Float32}}
├ Grid:       192-ring OctahedralGaussianArray{Float32}
├ Truncation: dealiasing = 2 (quadratic)
└ Legendre:   recompute polynomials false (3.23 MB)</code></pre><p>the polynomials are about 3MB in size. Easy that is not much. But at T1023 on the O1536 octahedral Gaussian grid, this is already 1.5GB, cubically increasing with the spectral truncation T. <code>recompute_legendre=true</code> (default <code>false</code> when constructing a <code>SpectralTransform</code> object which may be reused) would lower this to kilobytes</p><pre><code class="language-julia hljs">SpectralTransform(spectral_grid, recompute_legendre=true)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SpectralTransform{Float32}:
├ Spectral:   T127, 129x128 LowerTriangularMatrix{Complex{Float32}}
├ Grid:       192-ring OctahedralGaussianArray{Float32}
├ Truncation: dealiasing = 2 (quadratic)
└ Legendre:   recompute polynomials true (33.60 KB)</code></pre><h2 id="Functions-and-type-index"><a class="docs-heading-anchor" href="#Functions-and-type-index">Functions and type index</a><a id="Functions-and-type-index-1"></a><a class="docs-heading-anchor-permalink" href="#Functions-and-type-index" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.SpectralTransform" href="#SpeedyWeather.SpeedyTransforms.SpectralTransform"><code>SpeedyWeather.SpeedyTransforms.SpectralTransform</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">S = SpectralTransform{NF&lt;:AbstractFloat}(...)</code></pre><p>SpectralTransform struct that contains all parameters and preallocated arrays for the spectral transform.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_transform.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.SpectralTransform-Union{Tuple{AbstractArray{Complex{NF}, 2}}, Tuple{NF}} where NF" href="#SpeedyWeather.SpeedyTransforms.SpectralTransform-Union{Tuple{AbstractArray{Complex{NF}, 2}}, Tuple{NF}} where NF"><code>SpeedyWeather.SpeedyTransforms.SpectralTransform</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">S = SpectralTransform(  alms::AbstractMatrix{Complex{NF}};
                        recompute_legendre::Bool=true,
                        Grid::Type{&lt;:AbstractGrid}=DEFAULT_GRID)</code></pre><p>Generator function for a <code>SpectralTransform</code> struct based on the size of the spectral coefficients <code>alms</code> and the grid <code>Grid</code>. Recomputes the Legendre polynomials by default.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_transform.jl#L215-L221">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.SpectralTransform-Union{Tuple{AbstractGrid{NF}}, Tuple{NF}} where NF" href="#SpeedyWeather.SpeedyTransforms.SpectralTransform-Union{Tuple{AbstractGrid{NF}}, Tuple{NF}} where NF"><code>SpeedyWeather.SpeedyTransforms.SpectralTransform</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">S = SpectralTransform(  map::AbstractGrid;
                        recompute_legendre::Bool=true)</code></pre><p>Generator function for a <code>SpectralTransform</code> struct based on the size and grid type of gridded field <code>map</code>. Recomputes the Legendre polynomials by default.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_transform.jl#L231-L236">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.SpectralTransform-Union{Tuple{NF}, Tuple{Type{NF}, Type{&lt;:AbstractGridArray}, Int64, Int64}} where NF" href="#SpeedyWeather.SpeedyTransforms.SpectralTransform-Union{Tuple{NF}, Tuple{Type{NF}, Type{&lt;:AbstractGridArray}, Int64, Int64}} where NF"><code>SpeedyWeather.SpeedyTransforms.SpectralTransform</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">SpectralTransform(
    ::Type{NF},
    Grid::Type{&lt;:AbstractGridArray},
    lmax::Int64,
    mmax::Int64;
    recompute_legendre,
    legendre_shortcut,
    dealiasing
) -&gt; SpectralTransform
</code></pre><p>Generator function for a SpectralTransform struct. With <code>NF</code> the number format, <code>Grid</code> the grid type <code>&lt;:AbstractGrid</code> and spectral truncation <code>lmax, mmax</code> this function sets up necessary constants for the spetral transform. Also plans the Fourier transforms, retrieves the colatitudes, and preallocates the Legendre polynomials (if recompute_legendre == false) and quadrature weights.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_transform.jl#L68">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.RingGrids.get_nlat_half" href="#SpeedyWeather.RingGrids.get_nlat_half"><code>SpeedyWeather.RingGrids.get_nlat_half</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_nlat_half(trunc::Integer) -&gt; Any
get_nlat_half(trunc::Integer, dealiasing::Real) -&gt; Any
</code></pre><p>For the spectral truncation <code>trunc</code> (e.g. 31 for T31) return the grid resolution parameter <code>nlat_half</code> (number of latitude rings on one hemisphere including the Equator) following a dealiasing parameter (default 2) to match spectral and grid resolution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/aliasing.jl#L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.UV_from_vor!-Union{Tuple{NF}, Tuple{LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, SpectralTransform{NF}}} where NF&lt;:AbstractFloat" href="#SpeedyWeather.SpeedyTransforms.UV_from_vor!-Union{Tuple{NF}, Tuple{LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, SpectralTransform{NF}}} where NF&lt;:AbstractFloat"><code>SpeedyWeather.SpeedyTransforms.UV_from_vor!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">UV_from_vor!(
    U::LowerTriangularArray{Complex{NF&lt;:AbstractFloat}, 2, Array{Complex{NF&lt;:AbstractFloat}, 1}},
    V::LowerTriangularArray{Complex{NF&lt;:AbstractFloat}, 2, Array{Complex{NF&lt;:AbstractFloat}, 1}},
    vor::LowerTriangularArray{Complex{NF&lt;:AbstractFloat}, 2, Array{Complex{NF&lt;:AbstractFloat}, 1}},
    S::SpectralTransform{NF&lt;:AbstractFloat}
)
</code></pre><p>Get U, V (=(u, v)*coslat) from vorticity ζ spectral space (divergence D=0) Two operations are combined into a single linear operation. First, invert the spherical Laplace ∇² operator to get stream function from vorticity. Then compute zonal and meridional gradients to get U, V. Acts on the unit sphere, i.e. it omits any radius scaling as all inplace gradient operators.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_gradients.jl#L208">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.UV_from_vordiv!-Union{Tuple{NF}, Tuple{LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, SpectralTransform{NF}}} where NF&lt;:AbstractFloat" href="#SpeedyWeather.SpeedyTransforms.UV_from_vordiv!-Union{Tuple{NF}, Tuple{LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, SpectralTransform{NF}}} where NF&lt;:AbstractFloat"><code>SpeedyWeather.SpeedyTransforms.UV_from_vordiv!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">UV_from_vordiv!(
    U::LowerTriangularArray{Complex{NF&lt;:AbstractFloat}, 2, Array{Complex{NF&lt;:AbstractFloat}, 1}},
    V::LowerTriangularArray{Complex{NF&lt;:AbstractFloat}, 2, Array{Complex{NF&lt;:AbstractFloat}, 1}},
    vor::LowerTriangularArray{Complex{NF&lt;:AbstractFloat}, 2, Array{Complex{NF&lt;:AbstractFloat}, 1}},
    div::LowerTriangularArray{Complex{NF&lt;:AbstractFloat}, 2, Array{Complex{NF&lt;:AbstractFloat}, 1}},
    S::SpectralTransform{NF&lt;:AbstractFloat}
) -&gt; Complex
</code></pre><p>Get U, V (=(u, v)*coslat) from vorticity ζ and divergence D in spectral space. Two operations are combined into a single linear operation. First, invert the spherical Laplace ∇² operator to get stream function from vorticity and velocity potential from divergence. Then compute zonal and meridional gradients to get U, V. Acts on the unit sphere, i.e. it omits any radius scaling as all inplace gradient operators.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_gradients.jl#L277">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms._divergence!-Union{Tuple{NF}, Tuple{Any, LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, SpectralTransform{NF}}} where NF&lt;:AbstractFloat" href="#SpeedyWeather.SpeedyTransforms._divergence!-Union{Tuple{NF}, Tuple{Any, LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, SpectralTransform{NF}}} where NF&lt;:AbstractFloat"><code>SpeedyWeather.SpeedyTransforms._divergence!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">_divergence!(
    kernel,
    div::LowerTriangularArray{Complex{NF&lt;:AbstractFloat}, 2, Array{Complex{NF&lt;:AbstractFloat}, 1}},
    u::LowerTriangularArray{Complex{NF&lt;:AbstractFloat}, 2, Array{Complex{NF&lt;:AbstractFloat}, 1}},
    v::LowerTriangularArray{Complex{NF&lt;:AbstractFloat}, 2, Array{Complex{NF&lt;:AbstractFloat}, 1}},
    S::SpectralTransform{NF&lt;:AbstractFloat}
)
</code></pre><p>Generic divergence function of vector <code>u</code>, <code>v</code> that writes into the output into <code>div</code>. Generic as it uses the kernel <code>kernel</code> such that curl, div, add or flipsign options are provided through <code>kernel</code>, but otherwise a single function is used. Acts on the unit sphere, i.e. it omits 1/radius scaling as all inplace gradient operators.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_gradients.jl#L47">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.curl!-Tuple{LowerTriangularMatrix, LowerTriangularMatrix, LowerTriangularMatrix, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.curl!-Tuple{LowerTriangularMatrix, LowerTriangularMatrix, LowerTriangularMatrix, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.curl!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">curl!(
    curl::LowerTriangularMatrix,
    u::LowerTriangularMatrix,
    v::LowerTriangularMatrix,
    S::SpectralTransform;
    flipsign,
    add
)
</code></pre><p>Curl of a vector <code>u, v</code> written into <code>curl</code>, <code>curl = ∇×(u, v)</code>. <code>u, v</code> are expected to have a 1/coslat-scaling included, otherwise <code>curl</code> is scaled. Acts on the unit sphere, i.e. it omits 1/radius scaling as all inplace gradient operators. <code>flipsign</code> option calculates -∇×(u, v) instead. <code>add</code> option calculates <code>curl += ∇×(u, v)</code> instead. <code>flipsign</code> and <code>add</code> can be combined. This functions only creates the kernel and calls the generic divergence function _divergence! subsequently with flipped u, v -&gt; v, u for the curl.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_gradients.jl#L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.curl-Tuple{LowerTriangularMatrix, LowerTriangularMatrix}" href="#SpeedyWeather.SpeedyTransforms.curl-Tuple{LowerTriangularMatrix, LowerTriangularMatrix}"><code>SpeedyWeather.SpeedyTransforms.curl</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">curl(
    u::LowerTriangularMatrix,
    v::LowerTriangularMatrix;
    radius
) -&gt; Any
</code></pre><p>Curl (∇×) of two vector components <code>u, v</code> of size (n+1)xn, the last row will be set to zero in the returned <code>LowerTriangularMatrix</code>. This function requires both <code>u, v</code> to be transforms of fields that are scaled with <code>1/cos(lat)</code>. Acts on the unit sphere, i.e. it omits 1/radius scaling unless <code>radius</code> keyword argument is provided. An example usage is therefore</p><pre><code class="nohighlight hljs">RingGrids.scale_coslat⁻¹!(u_grid)
RingGrids.scale_coslat⁻¹!(v_grid)
u = spectral(u_grid)
v = spectral(v_grid)
vor = curl(u, v, radius=6.371e6)
vor_grid = gridded(div)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_gradients.jl#L176">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.curl-Union{Tuple{Grid}, Tuple{Grid, Grid}} where Grid&lt;:(AbstractGrid)" href="#SpeedyWeather.SpeedyTransforms.curl-Union{Tuple{Grid}, Tuple{Grid, Grid}} where Grid&lt;:(AbstractGrid)"><code>SpeedyWeather.SpeedyTransforms.curl</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">curl(u::AbstractGrid, v::AbstractGrid; kwargs...) -&gt; Any
</code></pre><p>Curl (∇×) of two vector components <code>u, v</code> on a grid. Applies 1/coslat scaling, transforms to spectral space and returns the spectral curl. Acts on the unit sphere, i.e. it omits 1/radius scaling unless <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_gradients.jl#L168">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.divergence!-Tuple{LowerTriangularMatrix, LowerTriangularMatrix, LowerTriangularMatrix, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.divergence!-Tuple{LowerTriangularMatrix, LowerTriangularMatrix, LowerTriangularMatrix, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.divergence!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">divergence!(
    div::LowerTriangularMatrix,
    u::LowerTriangularMatrix,
    v::LowerTriangularMatrix,
    S::SpectralTransform;
    flipsign,
    add
)
</code></pre><p>Divergence of a vector <code>u, v</code> written into <code>div</code>, <code>div = ∇⋅(u, v)</code>.  <code>u, v</code> are expected to have a 1/coslat-scaling included, otherwise <code>div</code> is scaled. Acts on the unit sphere, i.e. it omits 1/radius scaling as all inplace gradient operators. <code>flipsign</code> option calculates -∇⋅(u, v) instead. <code>add</code> option calculates <code>div += ∇⋅(u, v)</code> instead. <code>flipsign</code> and <code>add</code> can be combined. This functions only creates the kernel and calls the generic divergence function _divergence! subsequently.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_gradients.jl#L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.divergence-Tuple{LowerTriangularMatrix, LowerTriangularMatrix}" href="#SpeedyWeather.SpeedyTransforms.divergence-Tuple{LowerTriangularMatrix, LowerTriangularMatrix}"><code>SpeedyWeather.SpeedyTransforms.divergence</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">divergence(
    u::LowerTriangularMatrix,
    v::LowerTriangularMatrix;
    radius
) -&gt; Any
</code></pre><p>Divergence (∇⋅) of two vector components <code>u, v</code> which need to have size (n+1)xn, the last row will be set to zero in the returned <code>LowerTriangularMatrix</code>. This function requires both <code>u, v</code> to be transforms of fields that are scaled with <code>1/cos(lat)</code>. Acts on the unit sphere, i.e. it omits 1/radius scaling unless <code>radius</code> keyword argument is provided. An example usage is therefore</p><pre><code class="nohighlight hljs">RingGrids.scale_coslat⁻¹!(u_grid)
RingGrids.scale_coslat⁻¹!(v_grid)
u = spectral(u_grid, one_more_degree=true)
v = spectral(v_grid, one_more_degree=true)
div = divergence(u, v, radius = 6.371e6)
div_grid = gridded(div)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_gradients.jl#L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.divergence-Union{Tuple{Grid}, Tuple{Grid, Grid}} where Grid&lt;:(AbstractGrid)" href="#SpeedyWeather.SpeedyTransforms.divergence-Union{Tuple{Grid}, Tuple{Grid, Grid}} where Grid&lt;:(AbstractGrid)"><code>SpeedyWeather.SpeedyTransforms.divergence</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">divergence(
    u::AbstractGrid,
    v::AbstractGrid;
    kwargs...
) -&gt; Any
</code></pre><p>Divergence (∇⋅) of two vector components <code>u, v</code> on a grid. Applies 1/coslat scaling, transforms to spectral space and returns the spectral divergence. Acts on the unit sphere, i.e. it omits 1/radius scaling unless <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_gradients.jl#L159">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.get_recursion_factors-Union{Tuple{NF}, Tuple{Type{NF}, Int64, Int64}} where NF&lt;:AbstractFloat" href="#SpeedyWeather.SpeedyTransforms.get_recursion_factors-Union{Tuple{NF}, Tuple{Type{NF}, Int64, Int64}} where NF&lt;:AbstractFloat"><code>SpeedyWeather.SpeedyTransforms.get_recursion_factors</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_recursion_factors(  ::Type{NF}, # number format NF
                        lmax::Int,  # max degree l of spherical harmonics (0-based here)
                        mmax::Int   # max order m of spherical harmonics
                        ) where {NF&lt;:AbstractFloat}</code></pre><p>Returns a matrix of recursion factors <code>ϵ</code> up to degree <code>lmax</code> and order <code>mmax</code> of number format <code>NF</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_transform.jl#L263-L269">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.get_truncation" href="#SpeedyWeather.SpeedyTransforms.get_truncation"><code>SpeedyWeather.SpeedyTransforms.get_truncation</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_truncation(nlat_half::Integer) -&gt; Any
get_truncation(nlat_half::Integer, dealiasing::Real) -&gt; Any
</code></pre><p>For the grid resolution parameter <code>nlat_half</code> (e.g. 24 for a 48-ring FullGaussianGrid) return the spectral truncation <code>trunc</code> (max degree of spherical harmonics) following a dealiasing parameter (default 2) to match spectral and grid resolution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/aliasing.jl#L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.gridded!-Union{Tuple{NF}, Tuple{AbstractGrid{NF}, LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, SpectralTransform{NF}}} where NF&lt;:AbstractFloat" href="#SpeedyWeather.SpeedyTransforms.gridded!-Union{Tuple{NF}, Tuple{AbstractGrid{NF}, LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, SpectralTransform{NF}}} where NF&lt;:AbstractFloat"><code>SpeedyWeather.SpeedyTransforms.gridded!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">gridded!(   map::AbstractGrid,
            alms::LowerTriangularMatrix,
            S::SpectralTransform)</code></pre><p>Spectral transform (spectral to grid) of the spherical harmonic coefficients <code>alms</code> to a gridded field <code>map</code>. The spectral transform is number format-flexible as long as the parametric types of <code>map</code>, <code>alms</code>, <code>S</code> are identical. The spectral transform is grid-flexible as long as the <code>typeof(map)&lt;:AbstractGrid</code>.  Uses the precalculated arrays, FFT plans and other constants in the SpectralTransform struct <code>S</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_transform.jl#L288-L296">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.gridded-Union{Tuple{AbstractMatrix{T}}, Tuple{T}, Tuple{NF}} where {NF, T&lt;:Complex{NF}}" href="#SpeedyWeather.SpeedyTransforms.gridded-Union{Tuple{AbstractMatrix{T}}, Tuple{T}, Tuple{NF}} where {NF, T&lt;:Complex{NF}}"><code>SpeedyWeather.SpeedyTransforms.gridded</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">gridded(
    alms::AbstractArray{T&lt;:Complex{NF}, 2};
    recompute_legendre,
    Grid,
    kwargs...
) -&gt; Any
</code></pre><p>Spectral transform (spectral to grid space) from spherical coefficients <code>alms</code> to a newly allocated gridded field <code>map</code>. Based on the size of <code>alms</code> the grid type <code>grid</code>, the spatial resolution is retrieved based on the truncation defined for <code>grid</code>. SpectralTransform struct <code>S</code> is allocated to execute <code>gridded(alms, S)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_transform.jl#L500">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.gridded-Union{Tuple{NF}, Tuple{AbstractMatrix, SpectralTransform{NF}}} where NF" href="#SpeedyWeather.SpeedyTransforms.gridded-Union{Tuple{NF}, Tuple{AbstractMatrix, SpectralTransform{NF}}} where NF"><code>SpeedyWeather.SpeedyTransforms.gridded</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">gridded(
    alms::AbstractMatrix,
    S::SpectralTransform{NF};
    kwargs...
) -&gt; Any
</code></pre><p>Spectral transform (spectral to grid space) from spherical coefficients <code>alms</code> to a newly allocated gridded field <code>map</code> with precalculated properties based on the SpectralTransform struct <code>S</code>. <code>alms</code> is converted to a <code>LowerTriangularMatrix</code> to execute the in-place <code>gridded!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_transform.jl#L516">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.is_power_2-Tuple{Integer}" href="#SpeedyWeather.SpeedyTransforms.is_power_2-Tuple{Integer}"><code>SpeedyWeather.SpeedyTransforms.is_power_2</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">true/false = is_power_2(i::Integer)</code></pre><p>Checks whether an integer <code>i</code> is a power of 2, i.e. i = 2^k, with k = 0, 1, 2, 3, ....</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/aliasing.jl#L61-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.roundup_fft-Union{Tuple{Integer}, Tuple{T}} where T&lt;:Integer" href="#SpeedyWeather.SpeedyTransforms.roundup_fft-Union{Tuple{Integer}, Tuple{T}} where T&lt;:Integer"><code>SpeedyWeather.SpeedyTransforms.roundup_fft</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">m = roundup_fft(n::Int;
                small_primes::Vector{Int}=[2, 3, 5])</code></pre><p>Returns an integer <code>m &gt;= n</code> with only small prime factors 2, 3 (default, others can be specified with the keyword argument <code>small_primes</code>) to obtain an efficiently fourier-transformable number of longitudes, m = 2^i * 3^j * 5^k &gt;= n, with i, j, k &gt;=0.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/aliasing.jl#L33-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral!-Union{Tuple{NF}, Tuple{LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, AbstractGrid{NF}, SpectralTransform{NF}}} where NF&lt;:AbstractFloat" href="#SpeedyWeather.SpeedyTransforms.spectral!-Union{Tuple{NF}, Tuple{LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, AbstractGrid{NF}, SpectralTransform{NF}}} where NF&lt;:AbstractFloat"><code>SpeedyWeather.SpeedyTransforms.spectral!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">spectral!(  alms::LowerTriangularMatrix,
            map::AbstractGrid,
            S::SpectralTransform)</code></pre><p>Spectral transform (grid to spectral space) from the gridded field <code>map</code> on a <code>grid&lt;:AbstractGrid</code> to a <code>LowerTriangularMatrix</code> of spherical harmonic coefficients <code>alms</code>. Uses FFT in the zonal direction, and a Legendre Transform in the meridional direction exploiting symmetries. The spectral transform is number format-flexible as long as the parametric types of <code>map</code>, <code>alms</code>, <code>S</code> are identical. The spectral transform is grid-flexible as long as the <code>typeof(map)&lt;:AbstractGrid</code>.  Uses the precalculated arrays, FFT plans and other constants in the SpectralTransform struct <code>S</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_transform.jl#L395-L405">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral-Tuple{AbstractMatrix}" href="#SpeedyWeather.SpeedyTransforms.spectral-Tuple{AbstractMatrix}"><code>SpeedyWeather.SpeedyTransforms.spectral</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">spectral(
    map::AbstractMatrix;
    Grid,
    kwargs...
) -&gt; LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}} where NF&lt;:AbstractFloat
</code></pre><p>Converts <code>map</code> to <code>grid(map)</code> to execute <code>spectral(map::AbstractGrid; kwargs...)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_transform.jl#L533">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral-Union{Tuple{AbstractGrid{NF}}, Tuple{NF}} where NF" href="#SpeedyWeather.SpeedyTransforms.spectral-Union{Tuple{AbstractGrid{NF}}, Tuple{NF}} where NF"><code>SpeedyWeather.SpeedyTransforms.spectral</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">spectral(
    map::AbstractGridArray{NF, 1, Array{NF, 1}};
    recompute_legendre,
    one_more_degree
) -&gt; LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}} where NF&lt;:AbstractFloat
</code></pre><p>Converts <code>map</code> to <code>Grid(map)</code> to execute <code>spectral(map::AbstractGrid; kwargs...)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_transform.jl#L543">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral-Union{Tuple{NF}, Tuple{AbstractGrid, SpectralTransform{NF}}} where NF" href="#SpeedyWeather.SpeedyTransforms.spectral-Union{Tuple{NF}, Tuple{AbstractGrid, SpectralTransform{NF}}} where NF"><code>SpeedyWeather.SpeedyTransforms.spectral</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">spectral(
    map::AbstractGrid,
    S::SpectralTransform{NF}
) -&gt; LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}} where NF&lt;:AbstractFloat
</code></pre><p>Spectral transform (grid to spectral) <code>map</code> to <code>grid(map)</code> to execute <code>spectral(map::AbstractGrid; kwargs...)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_transform.jl#L557">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral_interpolation-Union{Tuple{NF}, Tuple{Type{NF}, LowerTriangularMatrix, Integer, Integer}} where NF" href="#SpeedyWeather.SpeedyTransforms.spectral_interpolation-Union{Tuple{NF}, Tuple{Type{NF}, LowerTriangularMatrix, Integer, Integer}} where NF"><code>SpeedyWeather.SpeedyTransforms.spectral_interpolation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">alms_interp = spectral_interpolation(   ::Type{NF},
                                        alms::LowerTriangularMatrix,
                                        ltrunc::Integer,
                                        mtrunc::Integer
                                        ) where NF</code></pre><p>Returns a spectral coefficient matrix <code>alms_interp</code> that is <code>alms</code> padded with zeros to interpolate in spectral space. If <code>trunc</code> is smaller or equal to the implicit truncation in <code>alms</code> obtained from its size than <code>spectral_truncation</code> is automatically called instead, returning <code>alms_trunc</code>, a coefficient matrix that is smaller than <code>alms</code>, implicitly setting higher degrees and orders to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_truncation.jl#L129-L139">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral_smoothing!-Tuple{LowerTriangularMatrix, Real}" href="#SpeedyWeather.SpeedyTransforms.spectral_smoothing!-Tuple{LowerTriangularMatrix, Real}"><code>SpeedyWeather.SpeedyTransforms.spectral_smoothing!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">spectral_smoothing!(A::LowerTriangularMatrix, c; power=1)</code></pre><p>Smooth the spectral field <code>A</code> following A <em>= (1-(1-c)</em>∇²ⁿ) with power n of a normalised Laplacian so that the highest degree lmax is dampened by multiplication with c. Anti-diffusion for c&gt;1.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_truncation.jl#L174-L178">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral_smoothing-Tuple{LowerTriangularMatrix, Real}" href="#SpeedyWeather.SpeedyTransforms.spectral_smoothing-Tuple{LowerTriangularMatrix, Real}"><code>SpeedyWeather.SpeedyTransforms.spectral_smoothing</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">A_smooth = spectral_smoothing(A::LowerTriangularMatrix, c; power=1)</code></pre><p>Smooth the spectral field <code>A</code> following A_smooth = (1-c*∇²ⁿ)A with power n of a normalised Laplacian so that the highest degree lmax is dampened by multiplication with c. Anti-diffusion for c&lt;0.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_truncation.jl#L163-L167">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral_truncation!-Tuple{AbstractMatrix, Int64}" href="#SpeedyWeather.SpeedyTransforms.spectral_truncation!-Tuple{AbstractMatrix, Int64}"><code>SpeedyWeather.SpeedyTransforms.spectral_truncation!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">spectral_truncation!(alms, trunc)</code></pre><p>Truncate spectral coefficients <code>alms</code> in-place by setting (a) the upper right triangle to zero and (b) all coefficients for which the degree l is larger than the truncation <code>trunc</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_truncation.jl#L56-L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral_truncation!-Tuple{AbstractMatrix}" href="#SpeedyWeather.SpeedyTransforms.spectral_truncation!-Tuple{AbstractMatrix}"><code>SpeedyWeather.SpeedyTransforms.spectral_truncation!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">spectral_truncation!(alms)</code></pre><p>Truncate spectral coefficients <code>alms</code> in-place by setting the upper right triangle to zero. This is to enforce that all coefficients for which the degree l is larger than order m are zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_truncation.jl#L66-L70">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral_truncation!-Union{Tuple{NF}, Tuple{AbstractMatrix{NF}, Integer, Integer}} where NF" href="#SpeedyWeather.SpeedyTransforms.spectral_truncation!-Union{Tuple{NF}, Tuple{AbstractMatrix{NF}, Integer, Integer}} where NF"><code>SpeedyWeather.SpeedyTransforms.spectral_truncation!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">spectral_truncation!(alms::AbstractMatrix, ltrunc::Integer, mtrunc::Integer)</code></pre><p>Truncate spectral coefficients <code>alms</code> in-place by setting (a) the upper right triangle to zero and (b) all coefficients for which the degree <code>l</code> is larger than the truncation <code>ltrunc</code> or order <code>m</code> larger than the truncaction <code>mtrunc</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_truncation.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral_truncation!-Union{Tuple{NF}, Tuple{LowerTriangularMatrix{NF}, Integer, Integer}} where NF" href="#SpeedyWeather.SpeedyTransforms.spectral_truncation!-Union{Tuple{NF}, Tuple{LowerTriangularMatrix{NF}, Integer, Integer}} where NF"><code>SpeedyWeather.SpeedyTransforms.spectral_truncation!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">spectral_truncation!(alms::LowerTriangularMatrix, ltrunc::Integer, mtrunc::Integer)</code></pre><p>Truncate spectral coefficients <code>alms</code> in-place by setting all coefficients for which the degree <code>l</code> is larger than the truncation <code>ltrunc</code> or order <code>m</code> larger than the truncaction <code>mtrunc</code>. Similar to <code>spectral_truncation!(::AbstractMatrix, ...)</code> but skips the upper triangle which is zero by design for <code>LowerTriangularMatrix</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_truncation.jl#L27-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral_truncation-Union{Tuple{NF}, Tuple{Type{NF}, LowerTriangularMatrix, Integer, Integer}} where NF" href="#SpeedyWeather.SpeedyTransforms.spectral_truncation-Union{Tuple{NF}, Tuple{Type{NF}, LowerTriangularMatrix, Integer, Integer}} where NF"><code>SpeedyWeather.SpeedyTransforms.spectral_truncation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">alms_trunc = spectral_truncation(alms, trunc)</code></pre><p>Returns a spectral coefficient matrix <code>alms_trunc</code> that is truncated from <code>alms</code> to the size (<code>trunc</code>+1)². <code>alms_trunc</code> only contains those coefficient of <code>alms</code> for which <code>m, l ≤ trunc</code>, and <code>l ≥ m</code> are zero anyway. If <code>trunc</code> is larger than the implicit truncation in <code>alms</code> obtained from its size than <code>spectral_interpolation</code> is automatically called instead, returning <code>alms_interp</code>, a coefficient matrix that is larger than <code>alms</code> with padded zero coefficients.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_truncation.jl#L79-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.ϵlm-Tuple{Int64, Int64}" href="#SpeedyWeather.SpeedyTransforms.ϵlm-Tuple{Int64, Int64}"><code>SpeedyWeather.SpeedyTransforms.ϵlm</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ϵ = ϵ(l, m)</code></pre><p>Recursion factors <code>ϵ</code> as a function of degree <code>l</code> and order <code>m</code> (0-based) of the spherical harmonics. ϵ(l, m) = sqrt((l^2-m^2)/(4*l^2-1)) with default number format Float64.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_transform.jl#L256-L260">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.ϵlm-Union{Tuple{NF}, Tuple{Type{NF}, Int64, Int64}} where NF" href="#SpeedyWeather.SpeedyTransforms.ϵlm-Union{Tuple{NF}, Tuple{Type{NF}, Int64, Int64}} where NF"><code>SpeedyWeather.SpeedyTransforms.ϵlm</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ϵ = ϵ(NF, l, m)</code></pre><p>Recursion factors <code>ϵ</code> as a function of degree <code>l</code> and order <code>m</code> (0-based) of the spherical harmonics. ϵ(l, m) = sqrt((l^2-m^2)/(4*l^2-1)) and then converted to number format NF.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_transform.jl#L247-L251">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇!-Union{Tuple{NF}, Tuple{LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, SpectralTransform{NF}}} where NF&lt;:AbstractFloat" href="#SpeedyWeather.SpeedyTransforms.∇!-Union{Tuple{NF}, Tuple{LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, SpectralTransform{NF}}} where NF&lt;:AbstractFloat"><code>SpeedyWeather.SpeedyTransforms.∇!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">∇!(
    dpdx::LowerTriangularArray{Complex{NF&lt;:AbstractFloat}, 2, Array{Complex{NF&lt;:AbstractFloat}, 1}},
    dpdy::LowerTriangularArray{Complex{NF&lt;:AbstractFloat}, 2, Array{Complex{NF&lt;:AbstractFloat}, 1}},
    p::LowerTriangularArray{Complex{NF&lt;:AbstractFloat}, 2, Array{Complex{NF&lt;:AbstractFloat}, 1}},
    S::SpectralTransform{NF&lt;:AbstractFloat}
) -&gt; Tuple{LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}} where NF&lt;:AbstractFloat, LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}} where NF&lt;:AbstractFloat}
</code></pre><p>Applies the gradient operator ∇ applied to input <code>p</code> and stores the result in <code>dpdx</code> (zonal derivative) and <code>dpdy</code> (meridional derivative). The gradient operator acts on the unit sphere and therefore omits the 1/radius scaling</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_gradients.jl#L474">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇-Tuple{AbstractGrid, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.∇-Tuple{AbstractGrid, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.∇</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">∇(
    grid::AbstractGrid,
    S::SpectralTransform;
    kwargs...
) -&gt; Tuple{Any, Any}
</code></pre><p>The zonal and meridional gradient of <code>grid</code>. Transform to spectral space, takes the gradient and unscales the 1/coslat scaling in the gradient. Acts on the unit-sphere, i.e. it omits 1/radius scaling unless <code>radius</code> keyword argument is provided. Makes use of an existing spectral transform <code>S</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_gradients.jl#L550">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇-Tuple{AbstractGrid}" href="#SpeedyWeather.SpeedyTransforms.∇-Tuple{AbstractGrid}"><code>SpeedyWeather.SpeedyTransforms.∇</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">∇(grid::AbstractGrid; kwargs...) -&gt; Tuple{Any, Any}
</code></pre><p>The zonal and meridional gradient of <code>grid</code>. Transform to spectral space, takes the gradient and unscales the 1/coslat scaling in the gradient. Acts on the unit-sphere, i.e. it omits 1/radius scaling unless <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_gradients.jl#L562">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇-Tuple{LowerTriangularMatrix, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.∇-Tuple{LowerTriangularMatrix, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.∇</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">∇(
    p::LowerTriangularMatrix,
    S::SpectralTransform;
    radius
) -&gt; Tuple{Any, Any}
</code></pre><p>The zonal and meridional gradient of <code>p</code> using an existing <code>SpectralTransform</code> <code>S</code>. Acts on the unit sphere, i.e. it omits 1/radius scaling unless <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_gradients.jl#L526">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇-Tuple{LowerTriangularMatrix}" href="#SpeedyWeather.SpeedyTransforms.∇-Tuple{LowerTriangularMatrix}"><code>SpeedyWeather.SpeedyTransforms.∇</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">∇(p::LowerTriangularMatrix; kwargs...)
</code></pre><p>The zonal and meridional gradient of <code>p</code>. Precomputes a <code>SpectralTransform</code> <code>S</code>. Acts on the unit-sphere, i.e. it omits 1/radius scaling unless <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_gradients.jl#L542">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇²!-Union{Tuple{NF}, Tuple{LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, SpectralTransform{NF}}} where NF&lt;:AbstractFloat" href="#SpeedyWeather.SpeedyTransforms.∇²!-Union{Tuple{NF}, Tuple{LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, SpectralTransform{NF}}} where NF&lt;:AbstractFloat"><code>SpeedyWeather.SpeedyTransforms.∇²!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">∇²!(
    ∇²alms::LowerTriangularArray{Complex{NF&lt;:AbstractFloat}, 2, Array{Complex{NF&lt;:AbstractFloat}, 1}},
    alms::LowerTriangularArray{Complex{NF&lt;:AbstractFloat}, 2, Array{Complex{NF&lt;:AbstractFloat}, 1}},
    S::SpectralTransform{NF&lt;:AbstractFloat};
    add,
    flipsign,
    inverse
) -&gt; LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}} where NF&lt;:AbstractFloat
</code></pre><p>Laplace operator ∇² applied to the spectral coefficients <code>alms</code> in spherical coordinates. The eigenvalues which are precomputed in <code>S</code>. ∇²! is the in-place version which directly stores the output in the first argument <code>∇²alms</code>. Acts on the unit sphere, i.e. it omits any radius scaling as all inplace gradient operators.</p><p><strong>Keyword arguments</strong></p><ul><li><code>add=true</code> adds the ∇²(alms) to the output</li><li><code>flipsign=true</code> computes -∇²(alms) instead</li><li><code>inverse=true</code> computes ∇⁻²(alms) instead</li></ul><p>Default is <code>add=false</code>, <code>flipsign=false</code>, <code>inverse=false</code>. These options can be combined.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_gradients.jl#L363">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇²-Tuple{LowerTriangularMatrix, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.∇²-Tuple{LowerTriangularMatrix, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.∇²</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">∇²(
    alms::LowerTriangularMatrix,
    S::SpectralTransform;
    radius
) -&gt; Any
</code></pre><p>Laplace operator ∇² applied to input <code>alms</code>, using precomputed eigenvalues from <code>S</code>. Acts on the unit sphere, i.e. it omits 1/radius^2 scaling unless <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_gradients.jl#L407">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇²-Tuple{LowerTriangularMatrix}" href="#SpeedyWeather.SpeedyTransforms.∇²-Tuple{LowerTriangularMatrix}"><code>SpeedyWeather.SpeedyTransforms.∇²</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">∇²(alms::LowerTriangularMatrix; kwargs...) -&gt; Any
</code></pre><p>Returns the Laplace operator ∇² applied to input <code>alms</code>. Acts on the unit sphere, i.e. it omits 1/radius^2 scaling unless <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_gradients.jl#L427">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇⁻²!-Union{Tuple{NF}, Tuple{LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, SpectralTransform{NF}}} where NF&lt;:AbstractFloat" href="#SpeedyWeather.SpeedyTransforms.∇⁻²!-Union{Tuple{NF}, Tuple{LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}}, SpectralTransform{NF}}} where NF&lt;:AbstractFloat"><code>SpeedyWeather.SpeedyTransforms.∇⁻²!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">∇⁻²!(
    ∇⁻²alms::LowerTriangularArray{Complex{NF&lt;:AbstractFloat}, 2, Array{Complex{NF&lt;:AbstractFloat}, 1}},
    alms::LowerTriangularArray{Complex{NF&lt;:AbstractFloat}, 2, Array{Complex{NF&lt;:AbstractFloat}, 1}},
    S::SpectralTransform{NF&lt;:AbstractFloat};
    add,
    flipsign
) -&gt; LowerTriangularArray{Complex{NF}, 2, Array{Complex{NF}, 1}} where NF&lt;:AbstractFloat
</code></pre><p>Calls <code>∇²!(∇⁻²alms, alms, S; add, flipsign, inverse=true)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_gradients.jl#L462">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇⁻²-Tuple{LowerTriangularMatrix, SpectralTransform}" href="#SpeedyWeather.SpeedyTransforms.∇⁻²-Tuple{LowerTriangularMatrix, SpectralTransform}"><code>SpeedyWeather.SpeedyTransforms.∇⁻²</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">∇⁻²(
    ∇²alms::LowerTriangularMatrix,
    S::SpectralTransform;
    radius
) -&gt; Any
</code></pre><p>InverseLaplace operator ∇⁻² applied to input <code>alms</code>, using precomputed eigenvalues from <code>S</code>. Acts on the unit sphere, i.e. it omits radius^2 scaling unless <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_gradients.jl#L434">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇⁻²-Tuple{LowerTriangularMatrix}" href="#SpeedyWeather.SpeedyTransforms.∇⁻²-Tuple{LowerTriangularMatrix}"><code>SpeedyWeather.SpeedyTransforms.∇⁻²</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">∇⁻²(∇²alms::LowerTriangularMatrix; kwargs...) -&gt; Any
</code></pre><p>Returns the inverse Laplace operator ∇⁻² applied to input <code>alms</code>. Acts on the unit sphere, i.e. it omits radius^2 scaling unless <code>radius</code> keyword argument is provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/8d07945afc329ab00ac9b3937a0fed41e8ac1c5d/src/SpeedyTransforms/spectral_gradients.jl#L455">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../lowertriangularmatrices/">« LowerTriangularMatrices</a><a class="docs-footer-nextpage" href="../gradients/">Gradient operators »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Monday 6 May 2024 22:45">Monday 6 May 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
